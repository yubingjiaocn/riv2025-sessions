# AWS re:Invent 2025 会议总结：Priority Pass 使用 AWS Amplify 实现全球化 Web 平台现代化

## 概述

本次会议分享了 Priority Pass（优先通行证）如何利用 AWS Amplify 对其 Web 平台进行现代化改造的完整案例。Priority Pass 是全球领先的机场贵宾室服务提供商，为数百万会员提供全球机场贵宾室访问服务。随着用户规模的快速增长，其传统的 Web 平台面临着扩展性不足、全球性能欠佳、运维成本高昂等挑战。

为了解决这些问题，Priority Pass 的母公司 Collinson Group 决定对整个技术架构进行重构。他们选择了 AWS Amplify 作为前端托管解决方案，将原有基于 Sitecore CMS 和 EC2 的传统架构迁移到基于 Next.js 和 Amplify 的现代化无服务器架构。这次迁移不仅大幅降低了运营成本（从每年 18 万美元降至 2 万美元，降幅达 89%），还显著提升了平台稳定性、部署效率和开发者体验。会议由 AWS 客户经理 Fred 和 Collinson Group 工程负责人 Richard 共同主讲，详细介绍了从技术选型、概念验证、试点迁移到全面部署的完整过程。

## 详细时间线与关键要点

[0:00-1:30] 开场与背景介绍
- 以机场体验作为引入，对比传统机场排队与贵宾室的舒适体验
- 介绍 Priority Pass 服务及其面临的技术挑战
- 说明会议目标：分享 Priority Pass 如何使用 AWS Amplify 实现平台现代化

[1:30-4:00] AWS Amplify 服务概述
- Amplify 的核心价值：简化全栈 Web 应用开发和部署
- 主要功能特性：
  - 基于 Git 的工作流部署，支持多种服务端框架
  - 通过 Amazon CloudFront 实现全球低延迟内容分发
  - 完整的 TypeScript 支持
  - 自动化 CI/CD 管道
  - 支持多种前端框架（Next.js、Nuxt、React、Vue、Angular 等）

[4:00-6:30] Priority Pass 业务背景与技术挑战
- Priority Pass 是全球市场领先的机场贵宾室服务提供商
- 服务数百万会员，每年网站访问量超过 1 亿次，移动应用使用量达数亿次
- 核心功能：数字会员卡生成、贵宾室预订、位置搜索、支付处理、个人资料管理
- 技术挑战：
  - 流量模式极度突发，需要镜像全球航班模式
  - 无法针对单一区域优化，需要 CDN 优先架构
  - 传统架构基于 Sitecore CMS 和 EC2，成本高昂
  - 部署缓慢且脆弱，流量高峰需要手动扩展

[6:30-9:00] 技术选型与业务需求
- 业务需求：快速交付、降低成本、高性能稳定性、减少基础设施管理
- 技术要求：
  - 迁移到 Node.js 技术栈
  - 简化托管架构，提升可扩展性
  - 采用 Headless CMS 替代传统 CMS
- 候选方案：AWS Amplify vs Vercel
- 选择 Amplify 的原因：
  - 成本效益更高（比 Vercel 便宜约 90%）
  - 与现有 AWS 基础设施更好集成
  - 企业级安全性

[9:00-11:30] 概念验证（POC）阶段
- 选择 Token-X 卡片令牌化服务作为 POC 项目
- 背景：Priority Pass 需要存储客户支付卡信息以便在贵宾室额度用尽时直接收费
- 使用令牌化技术保护敏感卡片数据
- 同时在 Amplify 和 Vercel 上构建 POC
- 结果：Amplify 成本降低约 90%

[11:30-13:00] 试点迁移阶段
- 技术验证成功后，迁移两个低流量 Web 应用作为试点
- 使用 Next.js 重建，采用 Contentful 作为 Headless CMS
- 迁移项目：支持状态页面（FAQ）和母公司企业网站
- 试点成功后，决定迁移核心资产 prioritypass.com

[13:00-15:30] 与 AWS 团队的合作
- 直接与 AWS 解决方案架构师合作
- AWS 将团队引荐给 Amplify 产品开发团队
- 解决的关键问题：
  - 服务端渲染页面的缓存失效行为优化
  - 添加 WAF（Web 应用防火墙）集成支持
  - 解决 DNS 重定向的特殊问题
- 强调：这是免费的咨询服务，显著缩短了上市时间

[15:30-18:00] 架构设计原则
- **Monorepo 架构**：
  - 使用 Nx 工具进行管理
  - 应用位于 /apps 目录，共享库位于 /libs 目录
  - 使用 Storybook 设计系统和视觉回归测试
  - 使用 Nx 标签避免意外破坏性变更
- **独立部署**：每个应用作为独立的 Amplify 应用/分支，指向子文件夹，拥有独立构建规范
- **基础设施即代码**：所有 Amplify 资源（分支、环境变量）通过 Terraform 管理
- **CI/CD**：使用 GitHub Actions 进行代码检查、安全检查和测试

[18:00-20:00] 临时环境（Ephemeral Environments）
- Amplify 为每个 Git 分支自动创建独立的隔离 URL 环境
- 环境镜像生产配置，创建时间约 6 分钟
- 无需额外基础设施或代码即可获得临时环境
- 便于在合并前在类生产环境中测试变更

[20:00-22:00] 技术架构详解
- 多个 Next.js 应用 + 共享库 + Lambda 函数
- 通过 GitHub Actions 运行代码分析（使用 SonarQube）
- 使用 Amplify CLI 创建项目
- 每个 Amplify 应用拥有独立域名和防火墙
- 集成外部 API（Contentful、Salesforce 等）
- 使用 Datadog 进行监控
- 强调：配置量极小，架构简洁

[22:00-24:30] 部署流程
- 完全自动化，使用 GitHub Actions
- 合并到主分支时自动触发部署
- 先运行内部质量检查，再推送到 Amplify
- Amplify 内置 CI/CD 处理构建、部署和版本控制
- Amplify 支持后端服务部署（Lambda、API Gateway、DynamoDB），但 Priority Pass 选择仅用于前端
- 底层通过 CloudFront 提供服务，可选 Lambda 进行服务端渲染

[24:30-26:00] 技术权衡与限制
- **降低的可观测性**：无法访问原始 CloudFront 日志或 Lambda 日志，故障排查较困难
- **功能限制**：不支持增量静态再生成（ISR）
- 对于使用 Next.js 等框架并期望静态内容再生成的团队需要注意

[26:00-28:30] 项目成果与经验总结
- **成本节省**：托管成本从每年 18 万美元降至 2 万美元（降幅 89%）
- **构建时间**：显著缩短
- **发布频率**：从每周 1-2 次提升到每月数百次部署
- **平台稳定性**：大幅提升，不再出现流量相关故障，无需手动调优
- **开发者体验**：工程师生活质量显著改善

[28:30-30:00] 经验教训与建议
- 直接与 AWS 合作非常有价值且免费，建议充分利用
- 如果重新开始，会考虑使用 Amplify 的 JavaScript 框架和工具（认证、UI 组件、存储、分析）
- 当时为保持框架无关性和避免过度耦合而未使用，但回顾认为可能会加速初始迁移

[30:00-31:00] 总结与闭幕
- 类比：就像机场贵宾室提供更好的旅行体验，AWS Amplify 减少了 Web 和移动应用开发的繁重工作
- 让开发者专注于真正重要的事情：构建新功能、取悦客户、编写优秀代码
- 呼吁填写会议反馈调查