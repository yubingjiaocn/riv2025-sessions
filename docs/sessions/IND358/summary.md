# AWS re:Invent 2025 T-Mobile 数字商务平台技术分享总结

## 会议概述

本次分享由 AWS 的 Matt Cosbellak 与 T-Mobile 的三位工程师 Glenn、Nick 和 Vipin 共同呈现,深入讲解了 T-Mobile 如何构建和运营一个服务超过 1.3 亿用户的大规模数字商务平台。这是一个关于数字化转型、云原生架构和极致工程实践的真实案例。

T-Mobile 面临的核心挑战是在重大产品发布日(如 iPhone 新品发布)处理流量激增——在几分钟内流量可达到平均水平的 10 倍以上。整个平台需要同时支持 T-Mobile 应用、官网和全国数千家零售店,确保零宕机、无限扩展能力和一致的用户体验。从 2013 年开始的"非运营商运动"(Uncarrier Movement)推动了这场变革,T-Mobile 用 12 年时间将 8 个独立的商务平台整合为一个统一的云原生平台,数字商务占比从最初的 4% 增长到接近 100%。

整个平台完全基于 AWS 构建,采用无头架构(headless)和 100% 云原生技术栈。团队通过持续创新,将曾经充满压力的 iPhone 发布日转变为"又一次普通的市场发布"(YAML - Yet Another Market Launch)。最新的 AI 驱动功能"Easy Switch"更是将用户从其他运营商切换到 T-Mobile 的时间缩短至 7-15 分钟,彻底改变了行业体验标准。

## 详细时间线与关键要点

00:00 - 开场介绍
- Matt Cosbellak 介绍会议主题:T-Mobile 大规模数字商务平台
- 引入 T-Mobile 三位核心工程师:Glenn、Nick 和 Vipin

02:30 - 业务场景设定
- 描述产品发布日场景:数百万用户同时访问平台购买新设备
- 强调挑战:流量在几分钟内激增 10 倍,需要支持应用、网站和全国零售店

05:15 - Glenn:转型之旅的起点
- 2013年3月26日:CEO John Legere 提出"爱你的客户"理念,启动 Uncarrier 运动
- 12 年前起点:8 个独立商务平台,多个断裂的客户体验,数字商务占比仅 4%
- 早期混乱:功能先宣布后开发,IT 团队在"Uncarrier 作战室"猜测 CEO 会承诺什么

08:45 - 2018 年 NPI 危机
- 2018 年 iPhone 发布日成为职业生涯最艰难的一天
- 平台不够成熟,无法处理负载,系统持续崩溃("crapping out")
- CIO 询问是否需要取消当年的 iPhone 发布
- 团队承诺:永远不再经历这种情况

11:20 - YAML 理念诞生
- 创造术语 YAML(Yet Another Market Launch):将高压力事件转变为常规发布
- 数字商务占比从 4% 增长到 40%,目前接近 100%
- T-Mobile 从电信公司(telco)演变为技术公司(techco)

14:00 - Nick:蓝领架构哲学
- 介绍"蓝领架构"(Blue-collar Architecture)理念:不追求外表,专注实用和完成任务
- 平台定位:无头架构,为所有 UI 提供核心 API(产品、定价、促销、购物车、结账)

16:30 - Active-Active 架构演进
- 早期采用 Active-Passive + Oracle Golden Gate 进行跨区域数据库复制
- 痛点:发布复杂、运维脆弱、性能损耗、无水平扩展能力
- 最大问题:在最需要时不敢使用(担心重新同步),总是选择"向前修复"

19:45 - 自研 Active-Active 解决方案
- 关键洞察:实际需要同步的数据比想象中少得多
- 数据分三类:配置数据(各副本相同)、上下文数据(客户信息,从其他系统获取)、购物车数据(唯一真正拥有的数据)
- 使用 Kinesis + Lambda 异步流式传输购物车变更到 DynamoDB 全局表

22:30 - Active-Active 工作原理
- 用户购物时保持在同一个 Stack(但可以跨 Stack)
- 购物车变更异步流式传输,不影响性能
- 区域故障时:通过流量路由器配置切换到另一个 Stack
- "Rehydration"机制:从全局购物车恢复本地购物车数据,过程快速且影响可忽略

25:00 - 零停机蓝绿发布
- 部署或回滚操作不到 1 分钟
- 实际操作仅是流量切换
- 支持金丝雀测试(Canary Testing):小流量验证后逐步放量
- 支持 A/B 测试:不同 Stack 运行不同业务场景,对比 KPI

27:15 - Vipin:四 Stack 发布策略
- 四个 Stack 对应每个发布版本和区域的组合
- 能够处理特定于发布或区域的问题
- 环境规模:核心应用约 50 万行代码,测试自动化套件 5000 个 Gherkin 场景(12.5 万行代码),测试数据 JSON 文件 150 万行代码

30:00 - 环境管理的痛点
- 过去创建环境需要 4-5 周,删除环境不可想象
- 传统方式:固定环境,代码在环境间移动,多次刷新(发布环境、性能测试、蓝色 Stack)
- 问题:环境配置和数据漂移,所谓"相同"的环境实际上并不相同
- 蓝色 Stack 上线前未做完整回归测试,金丝雀测试实际上是用客户做"小白鼠"

33:30 - Cerberus:三头犬守护架构
- 解决方案:完全自动化 Stack 生命周期,每个 Sprint 创建新环境
- 生命周期:开发和发布评估 2 周 → 服务客户流量 2 周 → 暂停 → 销毁
- 基础设施即代码(IaC):可预测、可靠,变更需要代码审查

36:00 - 自动化管道架构
- 当前:大型 GitLab Pipeline(未来目标:Lambda 驱动的 Worker 架构)
- 任务类型:状态验证、资源创建/销毁、数据加载、测试执行、上线活动
- 资源分两类:Stack 内资源(应用 Pod、数据存储)和共享资源(流量代理、全局 DynamoDB 表)

38:45 - 购物车持久化策略
- 购物车信息需要超越 Stack 生命周期
- 场景:用户切换到 T-Mobile,有 1 个月时间选择 iPhone,期间 Stack 会更换
- 解决方案:Stack 连接到全局 DynamoDB 表,确保购物车数据持久化

41:00 - Cerberus 的优势
- 短暂、确定性、轻量级
- 成本低于长期运行的环境
- 灾难恢复演练自动化:每个 Sprint 自动执行,无需专门演练
- 安全性设计:密钥作为 Stack 资源,每个 Sprint 自动轮换(无需每 6 个月专门项目)

43:30 - Glenn:AI 驱动的未来
- T-Mobile 现在是数据驱动、AI 赋能、数字优先的公司
- CIO Jeff Simon 的理念:在一切事物中"撒一点仙尘"(Pixie Dust = AI)

45:00 - Easy Switch 功能发布
- 两周前在拉斯维加斯大奖赛期间宣布最新 Uncarrier 举措:"15 分钟变更好"
- Easy Switch:AI 驱动的运营商切换体验
- 功能:登录 AT&T/Verizon 账户 → AI 提取现有信息 → 推荐最佳套餐并说明理由 → 展示成本节省 → 推荐设备(或建议保留现有设备)→ 自动设置购物车
- 实际表现:最快 7 分钟完成 5 条线路切换(官方宣传 15 分钟)

48:00 - 三大核心要点
1. 韧性是构建出来的,不是购买的(Resilience is built, not bought)
2. 自动化是新的扩展杠杆(Automation is the new scaling lever)
3. 记住仙尘:AI 驱动的体验是新常态(AIdriven experiences is the new normal)

49:30 - 结束与互动
- 团队邀请观众在会后交流,分享更多无法在台上讲述的故事