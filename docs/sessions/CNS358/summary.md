# AWS re:Invent 2025 - 使用模型上下文协议构建开发者体验

## 会议概述

本次会议由 Steve Kendricks 和 George 主讲,重点介绍了如何使用模型上下文协议(MCP)为 AWS 容器服务构建更好的开发者体验。会议深入探讨了 MCP 的诞生背景、工作原理,以及 AWS 如何为 Amazon ECS(Elastic Container Service)和 Amazon EKS(Elastic Kubernetes Service)推出 MCP 服务器。

演讲者首先回顾了 AI 代理和大语言模型(LLM)的演进历程,解释了为什么 MCP 变得如此重要。传统 LLM 面临两大核心限制:输入问题(无法获取实时数据和特定上下文)和输出问题(无法执行具体操作)。虽然 RAG(检索增强生成)和工具调用等技术部分解决了这些问题,但在处理复杂用例时仍存在 N×M 问题——每个模型与工具的连接都需要定制化工程。

MCP 作为 Anthropic 推出的开放标准,为 AI 应用和代理与工具及数据源之间的集成提供了标准化方式。AWS 率先为其容器服务推出了本地和云端托管的 MCP 服务器,使开发者能够通过自然语言与 ECS 和 EKS 资源进行交互,无需记忆复杂的 CLI 命令或 API 调用。这些 MCP 服务器不仅提供实时数据访问,还内置了 AWS 多年管理数百万容器集群积累的故障排查知识库。

## 详细时间线与关键要点

00:00 - 会议开场与议程介绍
- Steve Kendricks 介绍会议主题:使用模型上下文协议构建开发者体验
- 会议将涵盖:GenAI 代理和 LLM 的演进、MCP 简介、容器服务如何受益于 MCP、ECS 和 EKS MCP 服务器详解,以及实际演示

02:30 - LLM 的基本限制说明
- 通过"祖母购买圣诞礼物"的场景说明 LLM 的局限性
- 简单问题(如"什么是 AWS")可以回答,但涉及实时数据(如"今年最流行的儿童礼物")时会失败
- LLM 无法访问个人数据(如购买历史)或执行操作(如代表用户购物)

05:45 - 问题总结:输入与输出限制
- 输入问题:LLM 不知道训练数据截止日期之后的信息
- 输出问题:LLM 无法执行实际操作或访问外部系统
- 早期解决方案包括在提示中手动提供上下文,但这种方法繁琐且容易出错

07:20 - RAG(检索增强生成)的引入
- RAG 通过知识库为代理提供上下文
- AI 助手先访问知识库,将相关信息注入提示,再发送给 LLM
- 局限性:知识库需要维护和更新,上下文窗口会变得很大

09:15 - 工具(Tools)的概念
- 工具提供动态检索和动态上下文的能力
- 网络搜索是最常见的工具示例
- 工作流程:用户输入提示 → 工具描述发送给 LLM → LLM 调用工具 → 工具返回结果 → LLM 整合信息返回用户

11:30 - 复杂用例中的 N×M 问题
- 当代理需要访问多个系统(数据库、源代码仓库、CRM)时,需要为每个系统创建自定义集成
- 缺乏标准化导致集成不可重复、难以共享
- 知识会随时间变得陈旧

13:45 - MCP(模型上下文协议)的诞生
- Anthropic 推出的开放标准,用于 AI 应用和代理与工具及数据源之间的集成
- 类似于 API 标准化 Web 后端的工作方式,MCP 标准化了 AI 与工具的交互方式
- 实现标准化集成,解决 N×M 问题

15:30 - MCP 架构组件
- MCP Host:托管 MCP 客户端
- MCP Client:运行 MCP 的实体(如 AI 代理)
- MCP Server:包含三个核心组件
  - Tools(工具):模型控制的功能,如价格查询、数据检索
  - Resources(资源):应用控制的数据,如文件、数据库记录、购买历史
  - Prompts(提示):MCP 服务器建议的预定义提示模板,用户可以发现和修改

19:00 - 为什么容器服务需要 MCP
- AI 正在改变开发者构建、发布和观察代码的方式
- 代理是新的用户角色,需要专门设计的接口来最大化利用 AWS 服务
- AI 工具缺乏实时感知能力,例如两周前发布的 ECS Express Mode 不太可能在 LLM 的训练数据中

21:30 - MCP 解决的核心问题
- 提供实时、最新的功能信息
- 指导代理使用最新的 API 和部署机制
- 改进故障排查和运维,提供 AWS 积累的丰富知识
- 无需阅读千页手册,LLM 可以快速访问故障排查知识

23:45 - AWS 容器服务 MCP 服务器发布
- 今年早些时候发布了本地 MCP 服务器,支持 ECS、EKS、Finch 和 Lambda
- 每个 MCP 服务器都有独特的工具集
- 可从 AWS Labs GitHub 仓库下载并在本地运行
- 本地运行的局限性促使推出云端托管版本

25:30 - George 接手讲解托管 MCP 服务器
- 推出托管 MCP 服务器的四大原因:
  1. 企业安全性:企业不希望开发者本地安装运行,需要完全可见性和补丁控制能力
  2. 更广泛的集成:第三方 SaaS 提供商构建的 AI 代理需要与 EKS/ECS 集群交互
  3. AWS 提供的卓越可靠性和可扩展性
  4. 零日漏洞响应能力

27:00 - 托管 MCP 服务器发布公告
- 两周前发布了 Amazon EKS 和 Amazon ECS 的完全托管远程托管 MCP 服务器
- 目前处于预览阶段
- 在所有商业 AWS 区域可用(中国和 GovCloud 除外)

28:30 - EKS MCP 服务器功能概述
- 使用自然语言管理资源:如"显示我的生产 EKS 集群状态"
- 管理 Kubernetes 资源:Pod、命名空间等,无需 kubectl 或 kubeconfig
- 故障排查工具:如"为什么我的 nginx ingress controller pod 失败了?"
- 不仅限于只读操作,还可以创建资源

30:45 - 请求流程架构
- MCP 服务器托管在云端,在所有商业区域可用
- MCP Client(AI 系统,如 Kiro、Cursor)通过代理连接到托管 MCP 服务器
- 代理的作用:执行 SigV4 签名(MCP 协议目前不原生支持 SigV4)
- 请求到达托管 MCP 服务器后,根据工具调用相应的下游 AWS 服务

33:00 - 具体示例演示
- 在 Kiro(AWS AI 编码助手)中配置 MCP 服务器后,左侧显示所有可用工具(EKS 有 20 个工具)
- 用户在聊天窗口输入自然语言:"显示特定 EKS 集群的状态"
- LLM 识别需要使用 "describe_EKS_resource" 工具并返回响应

35:15 - EKS MCP 服务器工具分类

第一类:集群管理工具
- 管理 EKS 资源:创建集群、创建插件、删除资源
- 包含只读工具(如列出所有 EKS 资源)和写入工具(如创建集群)

第二类:Kubernetes 资源管理工具
- 管理 Kubernetes 资源:Pod、Service
- 可以创建、删除资源
- 包含应用 YAML 和生成清单的工具

37:30 - 第三类:文档和故障排查工具(重点)
- **搜索 EKS 文档工具**:解决知识截止日期问题
  - 连接到所有 AWS 文档、What's New 帖子、博客文章的索引
  - 增强 LLM 对新功能的理解
- **EKS 故障排查指南**:知识库工具
  - 汇集了 AWS 管理数百万 Kubernetes 集群的经验
  - 包含内部 runbook(可外部共享的部分)
  - 为 LLM 提供故障排查 runbook

40:00 - 第四类:遥测和安全工具
- 遥测工具:获取指标、事件、日志(故障排查的前两步)
- 安全工具:处理 IAM 权限相关问题

42:00 - 前置要求:IAM 权限配置
- EKS MCP 服务器受 SigV4 和 IAM 保护
- **三个关键权限**:
  1. eks:InvokeMCP:允许 MCP 客户端列出所有可用工具
  2. ReadOnlyTools:授予只读工具访问权限
  3. CallPrivilegeTool:允许所有工具(包括写入操作)

44:30 - 生产环境安全建议
- **强烈建议**:生产环境仅使用只读工具
- LLM 可能会产生幻觉,意外删除资源
- 在开发/测试环境可以使用 CallPrivilegeTool
- 从 InvokeMCP 和 ReadOnlyTools 开始

46:00 - 额外权限需求
- 连接 MCP 服务器后,工具需要额外权限(如访问 CloudWatch 日志)
- AWS 提供托管策略:EKS_MCP_Access
- 在 IAM 控制台搜索该策略即可找到
- 包含所有只读工具所需的完整权限列表
- 写入工具权限列在 EKS 用户指南中

48:15 - 代理(Proxy)配置
- 代理是 MCP 客户端和 MCP 服务器之间的中介,执行 SigV4 签名
- 可从 GitHub 仓库获取,也可从 Python Package Index 安装
- 使用 uvx 简单安装
- **重要**:一个代理可用于所有 AWS 第一方托管 MCP 服务器(不仅限于 EKS 和 ECS)

50:30 - 代理配置参数
- **Profile**:指定 AWS 配置文件,代理从中获取凭证进行 SigV4 签名
- **Regional Endpoint**:指定区域(如 us-west-2)
- **Service**:指定服务名称(如 eksmcp)
- **Read-only 参数**:如果指定,MCP 客户端仅获得只读工具访问权限(第二层安全控制)

52:45 - ECS MCP 服务器介绍
- 大部分内容与 EKS 类似
- 使用自然语言管理 ECS 资源
- 功能包括:部署监控、调查容器/任务健康状况、故障排查、查看网络配置

54:00 - ECS 工具分类
- **运维工具**:获取部署状态、获取网络配置(故障排查的关键)
- **资源管理工具**:任务定义详情等
- **故障排查工具**:ECS 针对客户最大痛点精心设计的工具

55:30 - 会议后续内容预告
- 将展示控制台集成的故障排查功能
- 实际演示如何使用 MCP 服务器

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


总结:本次会议全面介绍了 MCP 技术及其在 AWS 容器服务中的应用。通过标准化 AI 与工具的交互方式,MCP 解决了传统 LLM 的实时数据访问和操作执行问题。AWS 推出的托管 MCP 服务器为开发者提供了安全、可扩展的方式,通过自然语言与 ECS 和 EKS 资源交互,大幅提升了开发者体验和生产力。