# AWS re:Invent 2025 会议总结

## 会议概述

本次会议由 Alex Livingstone（AWS 首席专家解决方案架构师，专注于云运维和可观测性）和 Jared Nance（CloudWatch 首席工程师）主讲，重点探讨了企业级可观测性的最佳实践和实施方案。

会议首先指出了企业可观测性面临的现实挑战：需要管理数百甚至数千个账户、跨多个区域、处理成千上万的微服务，以及每天可能产生 PB 级别的遥测数据。传统监控方式存在诸多问题，包括工具分散（日志、追踪、指标分别在不同工具中）、成本高昂、告警疲劳等。这些问题导致平均修复时间增加、数据孤岛严重、需要手动关联不同工具的数据，以及监控覆盖不一致。

会议特别强调了业务成果指标的重要性。演讲者指出，90% 的企业每小时停机成本为 30 万美元，41% 的企业成本在 100-500 万美元之间。因此，投资可观测性具有明显的投资回报率。更重要的是，监控不应仅停留在基础设施层面（CPU、内存、网络等），而应关注客户真正关心的业务成果指标。例如，Amazon.com 最重要的指标是"每分钟订单数"，而非技术指标。测量业务成果指标有两个关键原因：一是当技术指标未发现问题时，业务指标能够发现；二是当技术指标发现问题时，业务指标能够量化业务影响。

随后，Jared Nance 分享了 Amazon 内部如何使用 CloudWatch 进行大规模监控。CloudWatch 每月处理 20 千万亿次指标观测、13 EB 日志数据、4550 亿条追踪记录，并运行 8.61 亿次金丝雀测试。Amazon 采用 DevOps 模型，通过"两个披萨团队"运营服务，使用蓝图模板自动配置可观测性功能，包括自动日志记录、追踪和指标收集。他们使用嵌入式指标格式（EMF）将高基数上下文存储在日志中，同时提取指标用于告警和仪表板，并通过 Contributor Insights 进行实时贡献者排名分析，有效解决高基数数据挑战。

## 详细时间线与关键要点

### 00:00 - 开场介绍
- Alex Livingstone 自我介绍，拥有 25 年运维经验，在 AWS 工作 9 年
- 专注于云运维和可观测性领域

### 02:30 - 企业可观测性现状
- 企业需要管理数百或数千个账户
- 跨多个区域部署数万甚至数十万微服务
- 每天可能产生 PB 级遥测数据

### 04:15 - 可观测性挑战
- 工具分散：日志、追踪、指标在不同工具中
- 成本高昂
- 告警疲劳问题严重
- 可能导致错过关键告警

### 06:00 - 可观测性不足的后果
- 平均修复时间（MTTR）增加
- 告警噪音和疲劳
- 数据孤岛和团队孤岛
- 需要在多个工具间手动关联数据
- 监控覆盖不一致

### 08:30 - 停机成本数据
- 90% 企业：每小时 30 万美元
- 41% 企业：每小时 100-500 万美元
- 强调投资可观测性的投资回报率
- 除直接成本外，还有工程师时间损失、客户体验问题、声誉损失和功能延迟

### 11:45 - 监控思维转变：业务成果指标
- 传统监控关注基础设施指标（计算、网络、容器、存储）
- 应用指标（性能、API 调用、IOPS）
- 黄金信号（延迟、流量、错误、饱和度）
- **关键观点**：应该监控业务成果指标，客户不关心 CPU 利用率，而关心业务功能
- Amazon.com 最重要指标：每分钟订单数

### 15:20 - 为什么测量业务成果
- 原因一：技术指标未发现问题时，业务指标能发现
- 原因二：技术指标发现问题时，业务指标能量化业务影响

### 17:00 - 企业可观测性蓝图概览
- 集中式日志记录
- 指标收集
- 追踪
- 智能化：异常检测、高基数指标、自动关联
- CloudWatch Investigations
- Application Signals（APM）
- 专业化洞察集成

### 18:30 - Jared Nance 介绍 Amazon 内部实践
- CloudWatch 首席工程师
- 分享 Amazon 如何使用 CloudWatch 监控自身服务

### 19:00 - CloudWatch 规模数据
- 每月处理 20 千万亿次指标观测
- 13 EB 日志数据
- 4550 亿条追踪
- 8.61 亿次金丝雀测试

### 20:30 - Amazon 的组织方式
- 采用 DevOps 模型
- 通过"两个披萨团队"划分服务复杂性
- 使用蓝图创建新服务

### 22:00 - 服务蓝图示例
- API Gateway + Lambda 架构
- 基础设施即代码模板自动配置可观测性
- 自动配置执行日志、主动追踪
- Lambda 自动集成 CloudWatch Logs

### 24:15 - 自定义遥测
- 工作负载或业务特定的仪器化
- 蓝图预配置仪器化框架
- 自动添加调用身份、追踪 ID 链接到日志
- 开发者无需手动处理

### 26:30 - 仪器化互操作性
- Amazon 标准化仪器化框架
- 建议使用 OpenTelemetry 实现互操作性
- 缓存框架和 Web 框架统一发送遥测数据

### 28:00 - 嵌入式指标格式（EMF）
- 在事件数据中并置指标和标签
- 将高基数上下文存储在 span 中
- 使用指标进行告警和仪表板
- 可通过 Logs Insights 查询快速回答问题

### 30:15 - 高基数数据挑战
- 传统系统可能发送数百万唯一指标
- 洞察被埋藏在基数爆炸中
- 示例：1000 客户 × 50 API × 10 区域 = 50 万唯一指标维度

### 32:00 - Contributor Insights 解决方案
- 采用自动 top-N 分析
- 从结构化日志识别指标的主要贡献者
- 实时贡献者排名
- 成本效益高，不会导致指标维度爆炸
- 支持告警集成

### 34:30 - Contributor Insights 应用
- Amazon 内部用于所有关键指标
- 可识别单个客户的问题
- 用于支持个人健康仪表板
- 大规模事件中快速识别受影响客户

### 36:45 - 从聚合指标到单个追踪
- 通过并置指标和日志数据
- 使用 Logs Insights 查询过滤错误请求
- 获取追踪 ID 和异常消息

### 38:00 - 跨账户和跨区域监控
- AWS 按区域隔离工作负载到不同账户
- 创建中央监控账户聚合 CloudWatch 数据
- 跨账户和区域聚合

### 40:00 - 事件检测和响应
- 蓝图包含预定义仪表板
- 通过基础设施即代码部署到 CloudWatch
- 每周审查客户体验指标
- 定期深入分析问题

### 42:15 - 告警和复合告警
- 使用告警在问题发生时通知
- 使用复合告警避免大规模事件中的多个告警
- 子告警触发复合告警
- 自动创建事件管理系统工单
- 自动触发 CloudWatch Investigation

### 44:30 - CloudWatch Investigation 工作流
- AI 驱动的调查
- 在运维人员登录前识别根本原因
- 工单中嵌入调查链接
- 运维人员可直接联合到问题账户
- 审查 AI 摘要并进行进一步手动调查

### 46:00 - Alex 继续讲解功能细节
- 集中式日志记录

### 47:00 - 集中式日志记录新功能
- 几个月前发布的新功能
- 填补了重要空白
- 之前已支持跨账户跨区域集中指标和追踪
- 现在支持日志集中化

### 48:30 - 集中式日志记录优势
- 在一个中央位置免费复制日志
- 单一账户、单一区域
- 从一个地方查询所有日志
- 支持多账户和多区域
- 统一的 Logs Insights 查询
- 集中式保留策略管理成本

### 51:00 - 多资源告警
- 几个月前发布
- 解决大规模创建告警的挑战
- 之前需要为每个资源创建告警
- 导致告警泛滥、阈值不一致、无集中管理

### 53:15 - Metric Insights 增强
- SQL 类查询 CloudWatch 指标
- 新增：基于标签的过滤（用于供应商指标）
- **关键功能**：多资源告警
- 示例：10 万个容器，一个告警监控所有容器 CPU > 80%
- 提供集中控制和趋势分析

### 56:00 - 追踪和采样问题
- 询问观众是否进行追踪（约 1/3 到 1/2）
- 询问是否因成本进行采样（相当多）

### 57:00 - Transaction Search 解决方案
- 解决采样问题
- 捕获 100% 追踪而非 1-5% 采样
- 实时搜索追踪
- 数秒内搜索数百万追踪
- 支持自定义属性和可选索引

### 59:00 - 采样的问题
- 即使尾部采样也不够
- 可能需要查看成功请求但不在样本中
- 采样只能看到聚合或部分追踪
- Transaction Search 允许查询每个追踪

### 1:01:00 - Transaction Search 功能
- 查询数百万追踪
- 按业务上下文过滤（客户 ID、会话 ID、功能标志）
- 自动关联日志和指标
- 导出追踪数据用于机器学习分析
- 支持最多 10,000 个账户

### 1:03:30 - Transaction Search 演示
- 按状态码分组搜索所有追踪
- "总结结果"按钮使用 AI 总结查询结果
- Logs Insights 也支持此功能

### 1:05:00 - 异常检测概述
- 三大支柱：指标、日志、追踪
- 指标：考虑季节性的基线，使用过去 14 天数据
- 持续调整模型
- 支持自定义和供应商指标
- 识别异常值

### 1:07:00 - 指标异常检测用例
- 可重复模式（白天繁忙、夜间安静）
- 持续上升或下降的指标
- 首次生产部署，不知道基线

### 1:08:30 - 日志异常检测
- 基于日志模式检测
- 自动发现日志异常
- 五种异常类型：频率增加、频率减少、新模式出现、模式消失
- 可持续运行或作为 Logs Insights 查询

### 1:10:00 - 日志异常检测查询技巧
- **关键查询**：pattern @message | anomaly
- 可查看所有日志组的所有异常
- 如果集中化日志，可在一个查询中查看所有异常

### 1:11:30 - 追踪异常检测
- 集成 X-Ray Analytics
- 监控延迟、错误率
- 监控对其他服务的依赖关系

### 1:12:30 - 指标异常检测演示
- 显示稳定可重复指标
- 灰色带表示正常范围
- 可调整带宽
- 可告警超出或低于范围

### 1:14:00 - 日志异常检测演示
- 检测新错误或频率增加
- 模式检测去除变量（称为 token）
- 可查看 token 值（如追踪 ID）
- 可从日志异常直接跳转到追踪
- 日志和追踪自动关联

### 1:16:30 - 追踪异常检测演示
- X-Ray 控制台中显示
- 提供描述和根本原因服务
- 可深入查看更多信息

### 1:18:00 - Application Signals 介绍
- "更多洞察，更少工作"
- 之前需要手动代码仪器化
- 每次发布手动更新
- 数据收集不一致
- 库覆盖选择性

### 1:20:00 - Application Signals 自动仪器化
- 支持 Python、Java、.NET、Node.js
- 使用 OpenTelemetry 自动仪器化
- 追踪发送到 X-Ray，指标发送到 CloudWatch
- 基于代理部署，无需代码
- 即插即用配置

### 1:22:00 - EKS 部署特别简单
- 添加可观测性插件
- 启用 Application Signals
- 完成
- ECS 和 EC2 需要部署代理和配置
- Lambda 内置选项

### 1:24:00 - Application Signals 优势
- 实施速度快
- 几乎无需开发者工作
- 易于维护，AWS 维护代理
- EKS 可自动更新代理
- 标准化遥测
- 全栈可见性

### 1:25:30 - 自动仪器化注意事项
- **例外情况**：高频交易等延迟敏感应用
- 不应使用任何自动仪器化（任何供应商）
- 自动仪器化有微小开销
- 实时分析代码会增加少量延迟

### 1:27:00 - Application Signals 界面演示
- 服务发现
- 自动创建黄金信号
- 基于黄金信号创建 SLO
- 显示服务健康状态
- 按故障率排序服务
- 显示依赖关系和服务交互

### 1:29:30 - 专业化洞察：Container Insights
- "更多洞察，零工作"（只需启用）
- 支持 EKS 和 ECS
- 从集群到 Pod 级别的资源利用率
- 容器性能、集群性能指标
- 部署信息
- 集成 Application Signals

### 1:31:00 - Database Insights
- 默认启用（有两个层级）
- 生产环境建议启用高级层
- RDS 性能监控
- 查询分析
- 连接池跟踪
- 主动性能建议

### 1:32:30 - Lambda Insights
- 可启用
- 函数级指标
- 冷启动分析
- 内存和 CPU 利用率
- 网络指标
- 集成追踪

### 1:33:30 - Container Insights 演示
- 显示特定服务视图
- 运行两个 Pod
- 显示该服务的所有指标

### 1:34:30 - Database Insights 演示
- 大量信息
- 显示 top SQL
- 示例数据库不太繁忙

### 1:35:30 - Lambda Insights 演示
- 多函数或单函数视图
- 示例：获取当前天气的服务
- 显示调用次数、持续时间、内存利用率、CPU 利用率
- 最近 10,000 次调用视图
- 直接链接到应用日志
- 链接到 Application Insights

### 1:37:00 - AI 驱动的可观测性
- "让 AI 为你工作"
- 跨指标、日志、追踪的异常检测
- 使用 CloudWatch Investigation 关联所有资源

### 1:38:00 - CloudWatch Investigation 演示场景
- 从服务可用性图表开始
- 聚合指标，每个样本包含多个请求
- 需要获取单个请求了解详情

注：字幕在此处截断，会议可能还有后续内容