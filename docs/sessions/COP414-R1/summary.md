# AWS re:Invent 2025 - Lambda 函数混沌工程与 FIS 原生故障操作

## 会议概述

本次技术分享会由 AWS 高级解决方案架构师 Saurabh Kumar 和 Haresh Nandwani 主讲，重点介绍了如何使用 AWS 故障注入服务 (FIS) 的原生故障操作对 Lambda 函数进行混沌工程和弹性测试。会议针对已在生产环境中使用 Lambda 函数但尚未进行弹性测试的开发者，展示了 FIS Lambda 操作的工作原理和实际应用。

演讲者通过现场编码演示，详细展示了如何配置和部署 FIS 实验，包括 CDK 代码实现、实验模板创建以及故障注入的具体过程。会议强调了可观测性在混沌工程中的重要性，并介绍了 FIS 扩展的轮询机制和性能权衡。

## 详细时间线与关键要点

### 0:00-5:00 开场与背景介绍
- 调查显示大多数与会者在生产环境使用 Lambda 函数，但很少进行弹性测试
- 介绍 AWS FIS 原生故障操作如何简化无服务器工作负载的混沌工程
- 演讲者自我介绍：两位都是专注于弹性和混沌工程的解决方案架构师

### 5:00-15:00 混沌工程基础与 FIS 优势
- 混沌工程定义：通过在系统中引入故障来验证系统弹性的实验方法
- FIS 的三大优势：完全无服务器的托管服务、丰富的故障场景库、与 AWS 服务的原生集成
- 关键术语解释：实验模板、操作、目标、安全杠杆等概念
- 强调 CloudWatch 可观测性的重要性："如果无法观察，就等于没有发生"

### 15:00-25:00 Lambda 服务与 FIS 操作介绍
- Lambda 作为区域性服务的弹性设计，利用多可用区提供冗余和故障隔离
- 三种新的 FIS Lambda 操作：
  - 添加启动延迟：测试 Lambda 函数延迟对下游系统的影响
  - 修改集成响应：测试错误响应对系统的影响
  - 调用错误：测试 Lambda 函数失败对调用组件的影响

### 25:00-35:00 FIS 扩展工作原理
- Lambda 组件架构：函数代码、库代码、执行环境、扩展
- FIS 扩展实现 API 代理模式，挂钩到 Lambda 执行生命周期
- 轮询机制详解：
  - 慢轮询模式：60秒间隔（无实验运行时）
  - 热轮询模式：20秒间隔（实验运行时）
  - 性能与快速恢复之间的权衡

### 35:00-45:00 应用架构与 CDK 代码演示
- 演示应用架构：DynamoDB 数据库 + Lambda 函数 + API Gateway
- CDK 代码关键配置参数：
  - AWS_FIS_CONFIGURATION_LOCATION：S3 存储桶位置
  - AWS_LAMBDA_EXEC_WRAPPER：扩展包装脚本位置
  - AWS_FIS_EXTENSION_METRICS：扩展性能指标配置
  - SLOW_POLL_INTERVAL：慢轮询间隔设置

### 45:00-55:00 实验模板创建与部署
- 现场编码创建两个实验模板：
  - 注入延迟实验：2秒启动延迟，持续5分钟
  - 调用错误实验：100%调用失败率
- IAM 策略配置：S3 访问、Lambda 目标识别、CloudWatch 日志记录
- 实验报告配置：预实验状态、实验状态、恢复状态的持续时间设置

### 55:00-60:00 实验结果分析与新功能介绍
- 实验报告展示：时间线、仪表板指标、轮询延迟影响
- 轮询间隔对实验生效时间的影响对比（120秒 vs 30秒）
- 新的故障场景介绍：
  - AZ 应用程序减速：单个可用区内资源间添加延迟
  - 跨 AZ 流量减速：多可用区间组件的数据包丢失测试
- 资源推荐：GitHub 代码库、FIS 工作坊、AWS 弹性中心网页