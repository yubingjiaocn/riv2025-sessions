# AWS re:Invent 2025 HAProxy 会议总结

## 会议概述

本次会议由 Frank 和 Jakub 主讲，主题为"多云混乱：统一云网格架构"（Multi-Cloud Chaos: The Unified Cloud Mesh Architecture）。两位演讲者来自 HAProxy 企业团队，分享了他们在服务网格解决方案方面的实战经验和见解。

会议重点讨论了传统服务网格架构的局限性，特别是在多云、多区域和混合环境中的复杂性问题。演讲者提出了 HAProxy 的"通用网格"（Universal Mesh）架构作为解决方案，强调其在性能、安全性和联邦管理方面的优势。会议还深入展示了多层安全防护、动态速率限制、机器人检测等高级功能，并通过实时演示展现了该架构在实际环境中的应用效果。

## 详细时间线与关键要点

### 0:00-5:00 开场介绍与问题定义
- Frank 和 Jakub 介绍会议主题和背景
- 调查现场观众对 HAProxy 的使用情况
- 提出核心观点：服务网格本意解决连接性问题，但实际上只是将复杂性转移到了其他地方
- 分析现代基础设施的碎片化特征：多云、多区域、本地数据中心、遗留应用

### 5:00-10:00 传统架构问题分析
- 详细分析 Sidecar 架构的"网格税"问题：每个 Pod 或服务实例都需要一个 Sidecar，成本和复杂性随规模增长
- 介绍 Sidecar-less 架构的改进但仍存在的问题：复杂性转移到 Layer 4 和 Layer 7 代理组件
- 指出两种架构都无法有效防止资源扩散、管理南北向流量，在联邦或多云设置中存在困难

### 10:00-15:00 通用网格解决方案
- 提出"通用网格"概念：在网络边界部署战略网关，而非管理扩散的 Sidecar 和代理部署
- 介绍 HAProxy 的全向特性：可处理南北向和东西向流量
- 外层边缘功能：TLS 终止、安全、集中日志、速率限制
- 内层边缘功能：东西向流量管理、流量分割等
- 强调三大核心优势：收敛（ingress、mesh、proxy 合一）、联邦（开箱即用的多集群/多云支持）、统一管理

### 15:00-20:00 性能基准测试
- 回顾 2021 年在 AWS Graviton2 实例上实现 200 万请求/秒的里程碑
- 解释 2023 年 TLS 库性能下降问题及解决方案
- 介绍 2024-2025 年的 TLS 栈重构，采用 AWS-LC 作为默认 TLS 库
- 发布最新 HAProxy 3.3 性能数据：在 Graviton4 实例上达到 254 万请求/秒
- 成本分析：10 亿请求成本约 41 美分，优化后可降至 20 美分左右

### 20:00-25:00 联邦管理与用例
- 解释联邦架构：控制平面可独立配置各个代理实例，同时保持全局感知
- 实际应用案例：
  - 广告技术推荐系统与 AWS 合作
  - 5G 移动提供商在 AWS Wavelength 区域的覆盖扩展
  - 支付提供商的跨区域冗余和故障转移
- 零信任安全：TLS 证书管理、健康检查、客户端证书等全自动化处理

### 25:00-30:00 身份验证与授权
- 身份验证模块支持：OpenID、SAML、ADFS 代理协议
- JWT 原生支持：算法验证、发行者验证、过期时间、作用域检查
- HAProxy 3.3 新增 JWE（加密 JWT）令牌支持
- 开放策略代理（OPA）集成：支持 Rego 语言定义复杂策略

### 30:00-35:00 多层安全架构
- Jakub 详细介绍四层安全检测架构：
  1. 访问控制：IP 地址黑白名单、指纹识别
  2. 速率计算：基于 IP、带宽、机器人标签的动态速率限制
  3. 机器人检测：识别爬虫、AI 抓取器等自动化流量
  4. Web 应用防火墙：低延迟的攻击检测和防护
- 强调所有层级同时工作，可灵活配置响应策略

### 35:00-40:00 高级安全功能演示
- 全局分析引擎：跨多个 HAProxy 实例聚合统计数据
- 动态速率限制：基于历史数据的 95 百分位数自动调整
- 多种响应策略：拒绝、允许、延迟响应（tarpit）、验证码挑战
- AI 时代的新挑战：基于令牌的速率限制、PII 检测、API 密钥保护

### 40:00-45:00 实时演示与总结
- 现场演示通用网格架构的实际运行
- 展示外部流量路由：mesh.hapee-demo.com/payment-gw
- 演示安全防护：自动阻止 /etc/password 等恶意请求
- Kubernetes 服务发现：自动配置新部署的服务路由
- 控制平面可视化：实时监控流量、安全事件和路由决策
- 总结核心价值：解决多云连接问题，提供统一的安全性、连接性和可观测性