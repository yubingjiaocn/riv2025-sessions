# AWS re:Invent 2025 SAS 412 会议总结

## 会议概述

本次会议主题为"成本高效的多租户知识库"，由AWS解决方案架构师Mike Gillespie（9年AWS经验）和Steven Warwick（5.5年AWS经验）主讲。会议采用互动式chalk talk形式，重点讨论如何构建支持多租户的RAG（检索增强生成）架构，解决数据隔离、性能分层和成本优化等关键挑战。

两位讲师都专注于为软件公司提供解决方案，本次分享源于客户在构建知识库时遇到的多租户需求。会议强调这只是解决方案的一种方式，鼓励参会者分享自己的实践经验和反馈。

## 详细时间线与关键要点

### 0:00-5:00 开场介绍
- Mike Gillespie和Steven Warwick自我介绍
- 强调会议的互动性质，鼓励参会者提问
- 介绍会议议程：知识库基础、多租户挑战、演示和代码讲解

### 5:00-15:00 多租户知识库设计挑战
- **数据分段**：确保租户间数据完全隔离，防止数据泄露
- **混合搜索**：支持语义搜索和关键词搜索
- **分层性能**：不同客户对延迟和成本有不同需求
- **数据生命周期管理**：处理文档更新和过期，特别是非结构化数据的快速老化

### 15:00-25:00 向量存储比较分析
- **OpenSearch**：低延迟，支持混合搜索，需要预置成本
- **pgVector**：低延迟，与结构化数据集成，适合混合查询
- **S3 Vector**：按使用付费，延迟较高，适合免费层或评估用例
- 强调一种尺寸不适合所有场景，需要抽象层来简化多种后端的管理

### 25:00-35:00 架构演示
- 展示基于Cognito的用户认证，JWT令牌包含租户信息
- Lambda函数使用Bedrock进行LLM推理
- Bedrock知识库作为抽象层连接不同向量存储
- 演示租户A（S3向量存储）和租户C（OpenSearch）的不同配置

### 35:00-45:00 代码实现详解
- **CDK基础设施**：创建多个知识库配置
- **知识库配置**：设置向量类型、嵌入模型和存储配置
- **数据源配置**：使用自定义数据源而非批量导入
- **元数据管理**：添加tenant_id和user_id进行数据隔离

### 45:00-52:00 查询和清理机制
- **过滤表达式**：基于租户ID和用户ID进行查询过滤
- **DynamoDB记录**：跟踪文件信息和TTL设置
- **自动清理**：使用DynamoDB TTL触发向量存储中的文档删除
- **灵活性**：支持手动删除记录实现"被遗忘权"

### 52:00-56:00 问答环节
- 讨论向量存储选择的利弊权衡
- 解答关于嵌套元数据、缓存层、文档更新等技术问题
- 分享OpenSearch Serverless性能优化建议
- 探讨MongoDB和Neptune Analytics的集成可能性