# AWS re:Invent 2025 网络防火墙代理会话总结

## 会议概述

本次会话介绍了AWS刚刚发布的网络防火墙代理(Network Firewall Proxy)服务，这是一个全新的显式代理解决方案。会话由解决方案架构师Tom和产品经理Ashray共同主讲，详细介绍了代理的工作原理、配置方法以及不同的网络架构实现方案。

网络防火墙代理是AWS在透明代理(如现有的网络防火墙)基础上推出的显式代理服务，旨在为客户提供集中化的流量控制和治理能力。该服务支持高级过滤控制，包括基于域名、IP地址的过滤，以及在启用TLS拦截时对HTTP头属性的细粒度过滤。代理还提供全面的流量可视性，帮助客户了解应用程序的网络行为模式。

## 详细时间线和要点

### 00:00-05:00 - 会话开场和介绍
- **00:30**: Tom介绍自己为专注于网络、边缘和安全的解决方案架构师
- **01:15**: Ashray介绍为VPC网络团队的产品经理
- **02:00**: 强调产品刚于上周发布，仍在更新演示材料
- **03:30**: 呼吁客户提供反馈，帮助完善产品功能

### 05:00-15:00 - 代理基础概念
- **05:30**: 定义代理为客户端和服务器之间的中间盒，用于过滤所有流量
- **07:00**: 介绍客户使用代理的三大用例：集中控制、访问控制、流量可视性
- **09:15**: 区分显式代理和透明代理的概念
- **12:00**: 展示传统DIY代理实现的复杂性和挑战

### 15:00-25:00 - AWS现有出口控制解决方案
- **15:30**: 回顾AWS现有的出口控制选项：安全组、网络ACL、Route 53解析器DNS防火墙
- **17:00**: 介绍中间盒解决方案：透明代理(网络防火墙)和第三方解决方案
- **19:45**: 宣布网络防火墙代理在俄亥俄州区域预览版可用

### 25:00-35:00 - 网络防火墙代理功能特性
- **25:30**: 详细介绍高级过滤控制功能
- **27:15**: 解释TLS拦截后的HTTP头属性过滤能力
- **29:00**: 介绍域名验证和SNI欺骗防护功能
- **31:30**: 说明通过私有链接端点访问代理的优势

### 35:00-45:00 - 代理架构和流量路径
- **35:45**: 展示典型代理设置架构图
- **38:00**: 详细解释代理配置的概念和作用
- **40:30**: 介绍代理端点的创建和使用方法
- **43:15**: 说明完全限定域名(FQDN)的配置

### 45:00-55:00 - 三阶段过滤机制
- **45:30**: 解释TCP连接建立和HTTP CONNECT请求流程
- **47:45**: 详细介绍PDNS过滤(第一阶段)
- **50:00**: 说明DNS后和请求前过滤(第二阶段)
- **52:30**: 介绍响应流量过滤(第三阶段)

### 55:00-65:00 - TLS拦截和解密
- **55:15**: 解释TLS拦截的必要性和实现方法
- **57:30**: 介绍AWS私有证书颁发机构的使用
- **60:00**: 详细说明前向证书生成和信任链建立
- **62:45**: 对比加密和非加密流量的处理差异

### 65:00-75:00 - 规则配置和管理
- **65:30**: 演示规则创建的具体步骤
- **68:00**: 介绍规则组的概念和组织方式
- **70:15**: 说明代理配置中的默认动作设置
- **72:30**: 展示规则组优先级的配置方法

### 75:00-85:00 - 代理创建和端点配置
- **75:45**: 演示代理创建过程中的关键参数
- **78:00**: 说明NAT网关选择的重要性
- **80:30**: 详细介绍服务名称的获取和使用
- **82:15**: 展示私有链接端点的创建步骤

### 85:00-95:00 - 网络架构模式(Tom接管)
- **85:30**: 介绍单VPC架构的最简实现
- **87:45**: 解释路由表配置的关键要点
- **90:00**: 说明私有子网无需默认路由的优势
- **92:30**: 展示本地客户端的流量流向

### 95:00-105:00 - 多VPC和混合架构
- **95:45**: 介绍跨多个VPC的集中化部署模式
- **98:00**: 说明私有链接在跨VPC场景中的优势
- **100:30**: 展示Transit Gateway集成的架构选项
- **103:15**: 介绍AWS Cloud WAN的使用场景

### 105:00-115:00 - 混合安全架构
- **105:30**: 说明HTTP/HTTPS流量限制
- **107:45**: 介绍与传统防火墙的组合使用
- **110:00**: 强调通过端点访问代理的重要性
- **112:30**: 对比网络防火墙代理与传统防火墙的差异

### 115:00-结束 - 现场演示
- **115:30**: Tom开始首次现场演示
- **117:00**: 展示演示环境的VPC配置
- **119:15**: 演示资源映射和路由表配置
- **121:30**: 连接到隔离的EC2实例进行测试
- **123:45**: 验证无互联网连接状态下的网络行为