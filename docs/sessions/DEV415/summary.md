# AWS re:Invent 2025 - DEV415 会议总结

## 会议概述

本次会议主题为"使用 A2A 和 MCP 构建可扩展的自编排 AI 工作流"，由 AWS 开发者倡导者 Gunnar Grosch 和 AWS Serverless Hero、Momento 生态系统工程师 Alan Helton 共同主讲。

这是一场 400 级别的技术深度会议，重点探讨了如何在生成式 AI 环境中构建自主代理系统。与传统的编排模式不同，本次会议强调使用编舞（choreography）而非中央控制来设计自编排系统。核心理念是：AI 代理的推理过程是非确定性的，不遵循线性剧本，因此需要新的架构模式来确保工作流的可靠性和可预测性。

会议通过 Swift Ship 物流配送系统作为实际案例，展示了从单一代理到多代理协作的完整演进过程。演讲者强调了一个关键原则："没有规则的自主就是混乱"，因此在非确定性范式中实现确定性协调至关重要。整个系统建立在三个核心技术基础上：Lambda 函数作为代理运行环境、Bedrock Agent Core 提供内存和可观测性、以及 Momento 作为快速协调层。

## 详细时间线与关键要点

### 开场介绍 (0:00-2:30)
- **0:00** - 会议开始，介绍主讲人 Gunnar Grosch（AWS 开发者倡导者）和 Alan Helton（AWS Serverless Hero、Momento 工程师）
- **0:30** - 说明这是 400 级别会议，假设观众具备 AWS 基础知识
- **1:00** - 概述会议内容：自编排系统设计、A2A 协议、MCP、Agent Core 和 Lambda

### 问题背景与挑战 (2:30-6:00)
- **2:30** - 提出核心问题：生成式 AI 不遵循线性剧本，推理基于上下文而非代码
- **3:15** - 传统编排服务不适用于 AI 代理工作流
- **4:00** - 引入编舞 vs 编排的辩论
- **4:45** - 比喻：协调代理就像"传话游戏"，每个代理都会添加自己的解释
- **5:30** - 强调核心原则："没有规则的自主就是混乱"

### 第一个演示：单一自主代理 (6:00-9:00)
- **6:00** - 介绍 Swift Ship 配送场景：司机到达但客户不在家
- **7:00** - 演示配送司机 Web 门户，填写配送失败表单
- **7:45** - 展示后台实时处理：自动重新安排配送并通知客户
- **8:30** - Alan 自嘲这是"本周最无聊的演示"，但它展示了代理工作流的基础

### 技术基础组件 (9:00-15:00)
- **9:00** - 介绍三个核心技术原语
- **9:30** - A2A 协议：代理通过发布 Agent Card 来发现和协作，包含能力、版本和输入模式
- **10:30** - 使用 Lambda Function URLs 暴露能力作为 HTTP 端点
- **11:15** - MCP（模型上下文协议）：为代理提供标准化方式加载上下文和交互工具
- **12:00** - MCP 工具定义严格的输入输出结构，消除歧义
- **13:00** - 核心服务：Lambda（代理运行环境）、Bedrock Agent Core（内存和可观测性）、Momento（快速协调层）

### 从聊天机器人到自主代理的演进 (15:00-19:00)
- **15:00** - 回顾三年前 ChatGPT 的发布：基本的聊天机器人交互
- **16:00** - MCP 发布后代理兴起：代理是被赋予工具能力的聊天机器人
- **17:00** - 自主代理：在架构后台异步运行，响应系统事件，无需人工交互
- **18:00** - 展示典型架构：API Gateway → Lambda → DynamoDB → EventBridge → Agent

### Agent Loop（代理循环）详解 (19:00-28:00)
- **19:00** - 介绍 Agent Loop：每个自主代理遵循的执行模型
- **19:45** - 四个阶段：Compose（组合）、Query（查询）、Execute（执行）、Continue（继续）
- **20:30** - Compose 阶段：通过 MCP 工具加载类型化上下文，从 Agent Core Memory 检索任务状态
- **21:30** - 引入 RISEN 框架构建系统提示：Role（角色）、Instructions（指令）、Steps（步骤）、Expectations（期望）、Narrowing（边界）
- **23:00** - 展示仓库管理代理的 RISEN 提示示例
- **24:30** - Agent Core Memory 的作用：由于 Lambda 无状态，内存用于恢复工作流上下文
- **26:00** - Agent Card：JSON 格式的机器可读能力描述文档
- **27:00** - 展示可视化的 Agent Card 界面

### Query 阶段：模型选择 (28:00-32:00)
- **28:00** - 强调不同 LLM 的输出和行为差异很大
- **29:00** - 对比示例：Cohere Command R（简洁直接）vs 更强推理能力的模型（详细回答）
- **30:00** - Supervisor vs Worker 代理的模型需求差异
- **30:45** - Supervisor 需要：全局推理、多步规划、依赖解析、判断输出质量
- **31:15** - Worker 需要：快速、低成本、确定性、模式完美匹配
- **31:45** - 模型推荐：Supervisor 用 Nova Pro/Premiere、Sonnet、Opus；Worker 用 Nova Canvas、Haiku

### Execute 阶段：执行动作 (32:00-36:00)
- **32:00** - Execute 阶段将模型输出转化为系统实际效果
- **32:30** - 第一步：模式验证，拒绝不符合 RISEN 提示的输出
- **33:15** - 执行动作：更新数据库、调用 API、写入 DynamoDB、更新 Agent Core Memory、发布事件
- **34:00** - 强调幂等性：使用从 Task ID 派生的幂等键，重试不会产生重复副作用
- **35:00** - A2A 代理调用：当需要另一个代理接管时，构造 A2A 负载并启动新的 Agent Loop

### Continue 阶段：循环决策 (36:00-40:00)
- **36:00** - 第四阶段：决定是否继续循环
- **36:30** - 重要说明：前四个阶段都在同一个 Bedrock Converse API 调用中
- **37:30** - Supervisor 评估：原始任务、其他代理的结果、未满足的能力、验证 Worker 返回的模式
- **38:30** - Worker 评估：是否满足了单个工作项（A2A 消息）的要求
- **39:15** - 决策：需要调用更多代理？等待异步响应？还是完成？

### 多代理协作的必要性 (40:00-45:00)
- **40:00** - 从单一代理转向多代理场景
- **40:30** - 类比：大家都知道单体应用（Monolith）不好
- **41:00** - 引入新术语：**Mono-Agent**（单一代理）- 拥有所有权限的代理，同样不好
- **42:00** - 领域划分：将代理范围限定在特定领域
- **42:45** - Swift Ship 示例：Triage Agent（Supervisor）+ Payment Agent + Warehouse Agent + Order Agent（Workers）
- **43:30** - 每个 Worker 只负责一个应用领域，不能跨越领域边界
- **44:15** - Gunnar 提问："这听起来熟悉吗？" - 引出微服务架构类比

### 代理即微服务 (45:00-49:00)
- **45:00** - 代理行为更接近分布式微服务而非传统 AI 聊天机器人
- **45:45** - 代理发现 = 服务发现：通过 Agent Card 而非 DNS 或服务网格
- **46:30** - 健康行为：从行为推断健康状态，而非轮询健康检查；A2A 请求失败时自然重试或选择不同路径
- **47:30** - 任务分配 = 负载均衡：依赖 Agent Core Memory 和分布式状态协调任务 ID、幂等键、进度标记
- **48:30** - 这些模式已经应用了几十年，只是现在用于代理系统

### 确定性协调原则 (49:00-53:00)
- **49:00** - 多代理工作流只有在每次交互都是确定性的情况下才能保持可预测
- **49:45** - 核心理念：相同输入应产生相同输出，即使多个代理并行运行
- **50:15** - 提示清晰度：使用 RISEN 模式确保稳定的行为契约
- **51:00** - 幂等性：在分布式系统中重试是常态（网络波动、Lambda 冷启动、超时）
- **52:00** - 使用任务 ID 确保相同指令多次接收不会产生重复效果（如多次转账）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


注： 字幕在约 53 分钟处截断，完整会议可能还包含更多演示和总结内容。