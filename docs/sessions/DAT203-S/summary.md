# AWS re:Invent 2025 技术分享会总结

## 会议概述

本次分享会探讨了在构建AI代理系统时，企业架构如何从简单的原型演变成复杂的"弗兰肯斯坦架构"（Franken Stack）。演讲者指出，没有人会故意设计一个包含六个数据库、三个缓存、消息总线、两个流平台以及只在满月时运行的自制ETL管道的系统，但这种复杂性往往在不知不觉中产生。通过一个电商平台定价优化引擎的真实案例，演讲者展示了当系统从POC阶段进入生产环境后，如何因为50个看似合理的决策而逐步演变成难以维护的怪物系统。

随着AI代理的引入，这个问题变得更加严重。AI代理不是简单的仪表板或批处理作业，而是需要实时访问结构化、非结构化、向量和事件数据的交互式有状态系统。当系统需要同时查询库存数据库、时间序列数据、向量数据库、产品目录等多个数据源时，延迟会不可预测地飙升，缓存会过时，复杂度呈阶乘级增长。演讲者强调，复杂度不是指数级增长，而是阶乘级增长——这是任何人都不希望看到的扩展方式。

演讲者提出的解决方案是采用统一数据库架构，而不是拼凑多个专用数据存储。通过实际对比数据显示，统一架构相比弗兰肯架构在代码行数上减少了3倍，数据库连接从多个减少到一个，故障点从三个减少到一个。这不仅降低了技术复杂度，还显著提升了团队速度、缩短了功能交付周期，并减少了凌晨2点收到生产环境告警的频率。最终信息是：弗兰肯架构的产生不是因为一个糟糕的决策，而是因为我们的架构是为仪表板设计的，现在却要求它们支持实时多模态AI代理。

## 详细时间线

00:00:00 - 开场与问题引入
- 演讲者以幽默的方式询问现场有多少人故意构建过"弗兰肯架构"（包含六个数据库、三个缓存、消息总线、两个流平台和只在满月运行的ETL管道）
- 调查显示现场许多人维护着超过五个数据存储系统，且自2020年以来数量还在增加

00:01:30 - 复杂度的本质
- 强调演示环境很简单，但生产环境才是真正的挑战
- 指出数据存储的复杂度不是指数级增长，而是阶乘级增长
- AI代理将显著放大这种复杂性效应

00:02:45 - 架构演变的起点
- 展示了最初的简洁架构：Web/移动应用 + AI代理 + 数据存储
- 这个架构足以赢得黑客马拉松、获得老板的掌声，甚至赢得奖杯或免费T恤
- 此时处于"蜜月期"，架构看起来具有良好的可扩展性

00:03:30 - 复杂度的累积
- 需要搜索功能？添加另一个数据存储
- 需要推荐引擎？再添加一个数据存储
- 需要分析功能？又添加一个数据存储
- 每次都说"我们稍后会清理"，但实际上永远不会清理

00:04:15 - 怪物的诞生
- 复杂度不是突然爆发，而是从小的"耳语"开始
- 每个新数据存储、每个同步作业、每个"临时"环境变量都在增加复杂度
- 弗兰肯架构不是一个糟糕决策的结果，而是50个合理决策的累积

00:05:00 - 症状显现
- 延迟问题、缓存不一致、模式漂移、意外成本
- 调试过程需要三个Slack频道、一次降神会，以及在左肩上撒三次山羊血
- 这些不是大的戏剧性故障，而是令人烦恼的、像甲虫蛀空南瓜一样的小问题

00:06:00 - 真实案例：电商定价优化引擎
- 用户点击"立即购买"按钮（例如购买弗兰肯斯坦服装）
- 系统需要根据用户意图和实时库存个性化折扣
- 请求会扇出到所有不同的系统，每个系统都有自己的SLA和特性

00:07:00 - 数据流的复杂性
- 需要查询：库存系统（OLTP数据库）、时间序列数据库（行为趋势）、向量数据库（嵌入和相似度匹配）、产品目录、库存水平
- 期望在50毫秒内返回结果
- 还要加上数据湖、分析仓库、报告表、模型训练、编排系统
- 数据需要导出、转换、重新摄取、版本控制、拼接后放回在线系统

00:08:00 - 双重架构的困境
- 实际上有两个并行的技术栈：一个用于实时处理，一个用于批处理
- 架构现在是一个巨大的相互依赖的蜘蛛网
- POC阶段只有三个系统（Web应用、OLTP数据库、向量存储），但生产环境完全不同

00:09:00 - 架构图对比
- 询问现场有多少人的架构图更像左边的混乱图而不是右边的简洁图
- 左边的架构图看起来像"解剖了一个火星人，放在幻灯片上，然后说'好的，发布吧'"
- 更糟糕的是，支持左边的架构比构建它更困难

00:10:00 - 僵尸管道和人力成本
- 存在多年前就应该淘汰的"僵尸管道"
- 支持团队人手不足（图中甚至没有显示）
- 整个系统能运行是因为有一整个团队每天都在努力维持它

00:11:00 - 可量化的成本
- 不可预测的延迟峰值
- 嵌入漂移和过时的缓存
- 复杂度不断攀升
- 用户开始收到基于"对小丑鞋感兴趣"的错误推荐
- 修复一个问题，角落里又会出现更多问题

00:12:00 - 招聘负担
- 需要每个不同数据存储的专家来操作它们
- 人力成本巨大但经常被忽视

00:12:30 - AI代理的特殊需求
- AI代理不是仪表板，也不是批处理作业
- 它们是交互式、有状态的系统，需要实时访问结构化、非结构化、向量和事件数据
- 如果其中任何一个部分变慢，整个系统就会崩溃

00:13:30 - 从代理需求出发重新思考
- 代理需要一个能读取企业数据并运行向量邻近查询的系统，数据移动和开销最小
- 需要更快的开发模式、更少的代码行、更少的依赖项
- 更少的外部系统意味着更少的SDK升级、更少的客户端库补丁、更少的凌晨2点的生产故障消息

00:14:30 - 减少监控负担
- 每个后台作业、同步任务、流消费者都会成为值班轮换中的一个"幽灵"
- 目标是减少涉及的"恶魔"（技术和万圣节双关意义）

00:15:00 - 简化后的架构
- 从代理开始设计时，架构看起来不再像鬼屋
- 变成了周一早上实际可以支持的系统

00:15:30 - 实际对比数据
- 虽然客户不允许使用生产代码，但演讲者重建了演示来获取指标
- 代码行数：统一存储 vs 拼凑系统相差3倍
- 数据库连接：1个 vs 多个
- 故障点：1个 vs 3个
- 每增加一个数据库/数据存储，就有更多空间让"小妖精"藏在技术栈中

00:17:00 - 生产环境的理智
- 使用单一数据库让生产环境变得合理
- 不再是管道、缓存、同步作业和"为什么这个表只在3/4月周期更新"的迷宫
- 调试变得可预测
- CI/CD更容易
- 值班更安静，涉及的人更少，事故解决更快

00:18:00 - 扩展性优势
- 只需扩展一个系统
- 只需监控一个账单
- 只需查看一个图表
- 只需一个专家团队来调试

00:18:30 - 最终收益：速度
- 从弗兰肯架构迁移到统一数据库后，首先注意到的是速度
- 不是理论速度，而是人的速度、团队速度、功能速度
- 可以在不需要三次团队会议（或那个本应该是邮件的会议）的情况下发布更新
- 产品经理可以在几周而不是几个月内推出功能
- 不需要维护那个只在满月后2月29日运行的神秘ETL作业

00:19:30 - 核心信息与总结
- 弗兰肯架构不是因为一个糟糕的决策而产生
- 它的产生是因为我们的架构是为仪表板设计的，现在却要求它们支持实时多模态AI代理
- AI代理需要实时状态、低延迟访问、一致的向量/结构化/非结构化数据，且不能有意外

00:20:00 - 结束语
- 感谢观众参与并忍受所有万圣节笑话
- 邀请观众访问Single Store展位（1559号展位）了解更多信息
- 祝大家在re:Invent度过愉快的时光