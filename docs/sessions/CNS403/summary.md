# AWS re:Invent 2025 无服务器开发者最佳实践会议总结

## 会议概述

本次会议由AWS无服务器开发者倡导者Julian主讲，主题为"无服务器开发者最佳实践"，但实际适用于所有在云端构建应用的开发者。会议通过跟踪一个名为Amelie的糕点店从单一店铺发展为国际成功企业的故事，展示了无服务器架构在五年间的演进过程。

Julian通过Amelie糕点店的真实案例，展示了从每月40个订单扩展到32万个订单的惊人增长历程，以及支撑这种增长所需的架构演进。会议涵盖了无服务器应用的核心原则，包括正确的规模调整、异步优于同步、避免不必要的工作、性能优化、故障处理、可观测性、成本优化以及AI集成等关键主题。

## 详细时间线与关键要点

### 00:00-05:00 会议开场与背景介绍
- Julian介绍自己作为AWS无服务器开发者倡导者的身份
- 展示Amelie糕点店五年发展历程概览
- 强调从40个订单到32万个订单的巨大规模增长
- 介绍会议将涵盖的无服务器最佳实践内容

### 05:00-10:00 Amelie的发展历程回顾
- **2020年**: 疫情期间开业，单一Lambda函数处理所有业务，200行代码，基础DynamoDB表
- **2021年**: 架构仍然简单，开始拆分Lambda函数处理支付和库存跟踪
- **2022年**: 多个地点，42个Lambda函数，复杂依赖链，早高峰级联故障，6秒订单处理时间
- **2024年**: 架构重构，引入Step Functions、EventBridge、SQS，函数数量减少到10个，处理时间降至400毫秒

### 10:00-15:00 无服务器应用的规模调整和组织原则
- 每个Lambda函数应该有明确的单一职责
- 避免创建复杂的"万能"Lambda函数
- Lambda根据内存配置按比例分配CPU和内存
- 包大小直接影响冷启动时间
- 避免过早创建微函数，从内聚函数开始，只在遇到实际问题时才拆分

### 15:00-20:00 团队组织和技术选择
- 不同团队可以根据专业知识选择运行时和工具
- 订单团队使用SAM或Java，库存团队使用Python，客户体验团队使用TypeScript
- 推荐使用框架（SAM、CDK等）简化开发
- 避免为每个函数创建单独的代码库

### 20:00-25:00 同步vs异步架构的挑战
- 2023年同步架构在高峰期造成级联系统故障
- 早高峰期间23%的订单被放弃
- 同步链意味着每个步骤必须完成才能获得响应
- 一个缓慢的支付API调用会阻塞整个下游流程

### 25:00-30:00 事件驱动设计解决方案
- 使用事件总线进行服务间调用
- 停止直接服务依赖，实现松耦合
- 引入EventBridge、SQS、AppSync Events
- 客户立即获得订单确认，然后通过EventBridge异步处理各项服务

### 30:00-35:00 Lambda事件源映射(ESM)最佳实践
- ESM自动轮询事件源并调用Lambda函数
- 支持内容过滤，减少不必要的调用
- 区分队列和流：队列适合独立任务处理，流适合多消费者或需要重放的场景
- SQS提供生产者和消费者之间的完美解耦

### 35:00-40:00 SQS配置最佳实践
- 设置可见性超时为Lambda函数超时的至少6倍
- 配置重驱策略为3-5次重试
- 设置足够长的消息保留时间
- 必须设置死信队列(DLQ)防止消息丢失
- 使用过滤功能节省成本，Amelie通过过滤节省了92%的成本

### 40:00-45:00 Step Functions和直接服务集成
- 2024年Amelie有42个Lambda函数，许多只做简单数据转换
- 配置即代码可以替代许多Lambda函数
- API Gateway可以直接连接DynamoDB、SQS、Step Functions等服务
- Step Functions提供数千种AWS SDK操作的直接集成
- 支持JSONata表达式进行数据转换

### 45:00-50:00 Lambda性能优化
- 宣布Lambda托管实例，提供EC2的完整范围和Lambda的运营简便性
- Lambda生命周期：创建执行环境、下载代码、启动运行时、运行初始化代码
- 内存分配影响CPU性能，更高内存通常能降低总成本
- Lambda Power Tuning工具帮助找到最佳内存配置

### 50:00-55:00 冷启动优化策略
- 冷启动影响不到1%的生产调用
- 专注于延迟敏感的面向用户的工作负载
- 优化包大小、导入和初始化逻辑
- 预置并发为所有语言提供预热执行环境
- SnapStart为Java、Python、.NET提供快照恢复功能

### 55:00-59:00 总结和后续步骤
- 无服务器在任何规模下都有效，从40个订单到32万个订单
- 核心原则：正确规模调整、异步优于同步、避免不必要工作、性能优化、故障处理、可观测性、成本优化
- 建议的下一步行动：优化一个Lambda函数、添加结构化日志、实现错误处理、检查函数规模调整、使用EventBridge而非直接调用