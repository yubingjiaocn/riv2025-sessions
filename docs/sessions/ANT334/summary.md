# AWS re:Invent 2025 分会场总结：利用 Amazon Redshift 空间功能实现道路安全分析

## 会议概览

本次分会场由 Cambridge Mobile Telematics (CMT) 的 Ryan McMahon 和 AWS 分析团队的 Ravi 共同主讲,重点介绍了如何利用 Amazon Redshift 的地理空间功能来提升道路安全。CMT 是一家专注于测量驾驶行为的技术公司,其使命是让全球道路和驾驶员更加安全。传统上,CMT 通过识别和理解导致交通事故的风险因素,帮助预防事故发生。然而,公司历史上主要关注个体驾驶员的一对一分析。

随着传感器数据的爆炸式增长(从功能手机到智能手机,再到专有标签设备),CMT 开始将分析范围从个体驾驶员扩展到道路本身的风险评估。这一转变需要处理海量的地理空间数据——每天超过 1 万亿个数据点。为了实现这一目标,CMT 与 AWS 合作,利用 Amazon Redshift 的空间分析能力,特别是 H3 六边形分层索引系统,构建了名为"Street Vision"的平台。该平台能够预测性地识别高风险路段,而不是被动地等待事故发生后再采取行动,真正实现了道路安全的"Zillow 式"可视化地图。

## 详细时间线与关键要点

### 开场介绍 (0:00 - 2:30)
- **0:00** - Ryan McMahon 介绍 Cambridge Mobile Telematics 公司背景
- **0:30** - 阐述公司使命：通过测量驾驶行为使道路和驾驶员更安全
- **1:00** - 说明核心方法：识别导致交通事故的风险因素,帮助预防事故
- **1:30** - 介绍数据处理基础设施：在 AWS 上处理来自各种传感器的海量数据
- **2:00** - 强调历史重点：主要针对个体驾驶员进行一对一的风险评估

### 从个体到道路的转变 (2:30 - 5:00)
- **2:30** - 数据复杂性增长：传感器类型不断增加(功能手机→智能手机→专有标签设备)
- **3:00** - 介绍"风险金字塔"概念：塔尖是道路死亡事故
- **3:20** - 触目惊心的数据：美国每年超过 4 万人死于交通事故,全球超过 100 万人
- **3:45** - 研究发现：交通事故不仅与驾驶员有关,车辆和道路本身也起重要作用
- **4:30** - 战略转变：从个体驾驶员风险扩展到道路风险评估

### 预测性道路安全分析 (5:00 - 7:30)
- **5:00** - 核心目标：预测交通事故发生的地点
- **5:30** - 关键洞察：单个致命事故本身不具备预测性,需要识别导致风险的底层因素
- **6:00** - AWS 的关键作用：处理每天超过 1 万亿个数据点
- **6:30** - 技术挑战：从个体驾驶员处理转向地理空间处理需要完全不同的计算方法
- **7:00** - 解决方案：构建基于地理空间分析的新系统

### 实际案例展示 (7:30 - 10:00)
- **7:30** - 阿肯色州案例：在阿肯色州安全峰会上展示的实际道路风险数据
- **8:00** - 数据聚合：展示三个月内"令人心碎的事件"的聚合分析
- **8:30** - 问题识别：通过人类行为数据识别出被树木遮挡的停车标志
- **9:00** - 华盛顿特区案例：亲自实地考察,拍摄被遮挡的停车标志照片
- **9:30** - 近距离碰撞检测：系统能够识别出频繁发生近距离碰撞的地点
- **9:45** - 传统方法的局限：目前交通部门通常等待事故发生后才采取行动

### 技术选型：H3 六边形索引 (10:00 - 11:30)
- **10:00** - 技术决策：选择使用 H3 六边形索引而非传统道路分段
- **10:30** - 挑战：当时 AWS 尚不支持 H3 六边形索引的数据处理
- **11:00** - 突破：AWS 开发了相应功能,使大规模处理成为可能
- **11:15** - 数据规模：每天加载超过 50 亿条记录到系统中
- **11:30** - 愿景："道路安全领域的 Zillow"——全球可用的风险地图

### Amazon Redshift 空间能力介绍 (11:30 - 14:00)
- **11:30** - Ravi 接棒,介绍 Redshift 空间功能的发展历程(7-8 年前开始)
- **12:00** - 核心优势：CMT 的 Street Vision 平台使用 Redshift 的空间数据和查询功能
- **12:30** - 易用性：所有操作都通过 SQL 完成,无需学习新技能
- **13:00** - H3 功能：重点介绍新增的 H3 分层六边形索引功能
- **13:30** - 开源起源：H3 是 Uber 发起的开源项目,在空间性能上实现巨大飞跃

### Redshift 架构优势 (14:00 - 16:30)
- **14:00** - 历史地位：Redshift 是近 14 年前发布的首个云原生数据仓库
- **14:30** - MPP 架构：大规模并行处理架构,从第一天起就具备此能力
- **15:00** - 数据规模：能够处理 PB 级数据
- **15:30** - 列式存储：采用列式数据存储,提供向量化扫描等优势
- **16:00** - 空间数据处理：架构非常适合处理 PB 级空间数据
- **16:30** - 数值精度：高精度、数值准确、稳健的空间实现(如 WGS84 标准)

### 空间数据类型与功能 (16:30 - 19:00)
- **16:30** - 首个数据类型：Geometry(几何)作为 Redshift 的一等数据类型
- **17:00** - Geography 数据类型：几年后添加,用于基于经纬度的坐标系统
- **17:30** - 数据类型区别：Geometry 用于 2D 非椭球坐标,Geography 用于需要投影精度的场景
- **18:00** - 函数库：目前拥有超过 100 个空间函数
- **18:30** - H3 函数：最新添加的功能,从 CMT 最需要的 5 个函数开始
- **19:00** - 持续扩展：计划引入更多 H3 函数

### SQL 查询示例 (19:00 - 20:30)
- **19:00** - 简单示例：展示如何在 Redshift 中运行空间查询
- **19:30** - 标准流程：创建表→加载空间数据→使用 SQL 查询
- **20:00** - 柏林地图示例：查找多边形内的所有酒店
- **20:30** - 查询性能：能够每秒或每分钟处理数百万次查询

### 支持的空间格式 (20:30 - 21:30)
- **20:30** - Shape 文件支持
- **20:45** - WKT(Well-Known Text)和 WKB(Well-Known Binary)格式
- **21:00** - 扩展版本：EWKT 和 EWKB
- **21:15** - GeoJSON 及其他多种格式
- **21:30** - 灵活性：读写空间数据格式具有高度灵活性

### H3 索引的革命性优势 (21:30 - 24:00)
- **21:30** - 传统方法问题：多边形查询本质上是笛卡尔连接,复杂、昂贵且规模呈指数增长
- **22:00** - H3 解决方案：为位置预先计算索引,每个单元格的索引就是位置本身
- **22:30** - 分辨率选择：提供 0-15 共 16 个级别,可根据需求选择
- **23:00** - 性能提升：查找速度极快,可节省 98% 的计算资源
- **23:30** - 资源节约：内存、CPU 时间和查询响应时间都大幅降低
- **24:00** - 成本优势：可节省高达 85% 的 Redshift 使用费用

### NLP 与 AI 集成 (24:00 - 27:00)
- **24:00** - Query Editor 集成：通过 Redshift Query Editor 实现 NLP 功能
- **24:30** - Jupyter 风格笔记本：支持 SQL 的笔记本式界面
- **25:00** - Amazon Q SQL 集成：完全集成 Amazon 的所有模型(自研和第三方)
- **25:30** - 自然语言处理：非 SQL 专家可以使用纯英语查询数据仓库
- **26:00** - 核心优势：与 Redshift 完全集成,拥有完整的查询历史和元数据
- **26:30** - 模式理解：自动进行模式爬取,理解表和列的结构
- **27:00** - QuickSight 集成：AWS 的其他查询工具也在构建与 Redshift 的集成

### 生成式 SQL (27:00 - 28:30)
- **27:00** - 意图理解：将自然语言意图转换为 SQL 查询
- **27:30** - 历史分析：查看查询历史并推断用户意图
- **28:00** - 预测性查询：能够进行预测性查询生成
- **28:15** - 可编辑性：在笔记本中可以编辑生成的查询后再执行
- **28:30** - 差异化优势：与第三方 BI 工具相比,对 Redshift 元数据的深度集成是真正的差异化因素

### 总结与问答 (28:30 - 29:30)
- **28:30** - 感谢参会者
- **28:45** - 开放问答环节
- **29:00** - 团队介绍：Ryan(CMT)和 Ravi(AWS 分析团队)
- **29:30** - 会议结束