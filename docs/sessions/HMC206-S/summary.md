# AWS re:Invent 2025 云勒索软件攻击剖析 - 实时模拟演练

## 会议概述

本次会议是由Rubric公司创建的名为"Zero Hour"的沉浸式桌面演练体验,在AWS re:Invent 2025大会上进行。会议通过模拟一家名为Horizon Retail的虚构零售公司遭受复杂云勒索软件攻击的完整过程,向与会者展示了现代云环境中网络攻击的真实场景。虽然公司和具体场景是虚构的,但所有攻击手法、技术和流程(TTPs)都基于真实的云攻击案例。

演练分为五个场景,通过视频和角色扮演的方式,展现了从攻击初期的异常信号发现,到攻击全面爆发,再到恢复尝试失败的完整过程。会议强调了三个核心目标:观察Horizon公司战略中的漏洞如何导致危机、反思并将经验教训带回自己的组织、以及通过安全的环境进行互动讨论和经验分享。整个演练揭示了云攻击与传统攻击的本质区别,特别强调了操作性恢复与网络安全恢复之间的关键差异。

## 详细时间线与关键要点

### 场景一:攻击初现 (视频场景)

时间戳: 会议开始 - 约15分钟

- **攻击发现的初期信号**
  - EBS卷的写入延迟异常飙升,但读取IO保持平稳
  - 这是一个不寻常的模式,特别是在周日早晨这样的低流量时段
  - 单个进程持续反复写入的异常行为

- **S3存储桶遭受攻击**
  - 每分钟数千次API调用针对关键存储桶
  - 大量的PutObject和DeleteObjectVersions操作
  - 所有对象名称被重写,添加了".locked"后缀
  - 确认这是主动的恶意攻击,而非脚本失控

- **攻击范围扩大**
  - 核心S3存储桶出现大规模加密
  - 主RDS实例出现高IO警报
  - 面向客户的网站开始返回503错误
  - 攻击呈现协调性和快速蔓延的特征

- **攻击来源追踪**
  - CloudTrail显示数千次未授权的SSE-C加密调用
  - 攻击源自公司自己的VPC内部
  - GuardDuty警报指向单个EC2实例(一台QA服务器)
  - 攻击者已经渗透到内部环境

关键要点:
- 现代云攻击始于"低语而非巨响" - 表现为一系列不协调的数据点
- 云攻击的复杂性需要跨多个服务的专业知识和协调
- 需要全面的可见性来理解服务之间的相互作用
- 这是针对业务运营的直接"斩首式打击"
- 勒索软件以机器速度运行,可在几分钟内加密数十万个对象

### 场景二:攻击链分析与恢复困境

时间戳: 上午8:00 (东部时间) - 约30分钟

- **攻击入侵路径还原**
  - 初始入口点:社会工程学攻击,通过帮助台获取标准员工账户凭证
  - 发现并利用未打补丁的QA服务器
  - 利用该服务器上配置错误的IAM角色获取更高权限
  - 这是一个从未清理的技术债务

- **权限提升过程**
  - 配置错误的角色允许攻击者入侵云管理员账户
  - 接管身份提供商(SSO),获得"王国的钥匙"
  - 通过SSO控制访问零售ETL角色和RDS数据库
  - 使用SSE-C(服务器端加密与客户提供的密钥)在关键S3存储桶部署加密脚本

- **数据渗透发现**
  - 取证显示攻击者在环境中潜伏数周
  - 采用"低速慢行"方式持续渗透数据
  - 不仅锁定数据,还提前复制了一份

- **业务影响评估**
  - 东北地区门店客户因手动结账流程(每人超过20分钟)而放弃购物车
  - 媒体介入,本地新闻车出现在旗舰店外
  - 基于小时收入率,每小时损失数十万美元
  - 品牌损害正在电视直播中实时发生

时间戳: 上午11:00 (东部时间)

- **攻击组织确认**
  - 外部安全顾问和FBI确认攻击者为Scattered Spider组织
  - 勒索金额:400万美元比特币
  - 支付期限:3天

- **恢复能力评估**
  - EC2实例可从AWS Backup恢复
  - S3数据恢复存在严重问题:部分数据仅依赖版本控制和跨区域复制
  - 版本控制不是备份,无法防御此类攻击
  - 攻击者使用SSE-C重新加密了每个对象的每个版本
  - 其他区域的副本只是相同无用加密对象的副本

- **决策失误追溯**
  - 去年资本分配审查期间决定削减云存储成本
  - 风险已记录并正式接受,认为版本控制可缓解意外删除
  - 没有人预料到如此复杂的攻击

- **数据损失规模**
  - 所有运营数据、POS和传感器日志
  - 整个门店网络的所有BI数据集
  - 上一财年开业的所有门店的完整年度数据
  - 公司一年的增长实际上被抹去

关键要点:
- 80%的数据泄露可归因于某种配置错误
- 35%的云事件源于滥用有效账户 - 攻击者是"登录"而非"黑客入侵"
- 版本控制适用于操作性恢复,但在网络恢复场景中无效
- 今天的安全漏洞往往是昨天的预算削减造成的
- 管理层将安全加固工作降级以支持新功能开发是系统性失败

### 场景三:恢复尝试与二次打击

时间戳: 周日晚上9:00 - 约45分钟

- **恢复工作的艰难进展**
  - 团队已连续工作15小时
  - 从备份保管库挂载第10个EBS快照进行深度取证扫描
  - 每TB数据扫描需要近1小时
  - 以此速度,仅验证单个关键应用的备份就需要数天时间
  - 如同"在受感染的干草堆中寻找干净的针"

- **攻击者的侦察优势**
  - 攻击者在环境中潜伏超过30天
  - 他们比公司自己更了解备份保留策略
  - 等待恶意软件复制到所有最近的恢复点后才发动主攻击
  - 不仅要对抗加密,还要对抗他们30天的侦察成果

- **备份工具的局限性**
  - 现有备份工具在操作性恢复中表现良好
  - 但在应对复杂攻击时严重不足
  - 工具从未设计用于抵御拥有管理员凭证的攻击者的直接恶意攻击
  - 无法识别哪些备份是安全的

时间戳: 周一凌晨1:00

- **短暂的希望**
  - 发现两周前的EC2快照,在主要恶意软件植入之前
  - 初步扫描显示干净,未发现rootkit特征
  - 在完全隔离的新VPC中启动恢复过程
  - 预计午夜前可建立核心应用测试环境

- **恢复失败**
  - 系统上线约5秒后崩溃
  - CPU利用率达到100%
  - 文件系统正在被重新加密
  - 恶意软件处于休眠状态,等待特定事件触发(数据库连接或特定API调用)
  - 这是一个定时炸弹,恢复操作触发了它

时间戳: 凌晨2:00

- **财务后果加剧**
  - 周日损失超过100万美元
  - 股票预计开盘下跌至少8%
  - 市值蒸发5亿美元
  - 唯一可行的备份失败,回到原点

- **勒索金额上涨**
  - 攻击者看到了失败的恢复尝试
  - 将勒索金额提高到600万美元
  - 攻击者认为他们占据上风
  - 故事被全国新闻媒体报道,失去对叙事的控制

关键要点:
- 攻击者的首要目标是破坏备份 - 93%的组织报告攻击者试图影响数据备份
- 攻击者利用长时间的潜伏期研究恢复策略,确保恶意软件植入所有恢复点
- 网络恢复与操作性恢复根本不同:数据和身份本质上不可信
- 传统工具在网络恢复场景中失效,它们是为防范操作问题而非恶意对手设计的
- 必须在开始恢复前知道哪些备份已被破坏
- 隔离的恢复环境至关重要(Horizon在独立VPC中恢复是正确的)
- 凭证隔离在云中极其重要

### 场景四:数据泄露调查

时间戳: 周二下午 - 攻击开始后48小时以上 - 约55分钟

- **业务影响持续恶化**
  - 公司股票暴跌超过10%
  - 恢复工作是"残酷且令人沮丧的苦战"
  - 确认攻击者在系统内至少36天

- **数据暴露评估**
  - 网络事件响应经理召集IT和法律团队紧急会议
  - 核心问题:攻击者到底窃取了什么数据?
  - S3清单的完整性受到质疑,特别是考虑到丢失的数据
  - 法律团队需要准确清点受损S3数据

- **数据分类混乱**
  - 对S3环境进行深度扫描,试图核对清单与实际情况
  - 使用正则表达式在存储桶清单和对象名称中搜索PII模式
  - 许多存储桶没有数据分类标签,完全"盲飞"

- **惊人发现**
  - 发现名为"Q3_rewards_members_full_dump.csv"和"loyalty_test_data_prod_sample.json"的文件
  - 文件名本身就在"尖叫"包含PII
  - S3清单显示生产环境中有920个存储桶
  - 深度扫描发现965个存储桶
  - 有45个存储桶完全未被跟踪、未被监控、未被备份

时间戳: 周二深夜

- **未跟踪存储桶的来源**
  - 这些未跟踪的存储桶似乎是为上季度开发的客户忠诚度计划创建的
  - 作为开发环境,不应该包含生产数据
  - 但为了正确测试新的预测模型,开发团队可能从生产环境中提取了样本数据

关键要点:
- 影子IT和未跟踪资源是重大安全风险
- 缺乏准确的资产清单(CMDB)使组织在攻击中"盲飞"
- 数据分类和标记对于了解暴露风险至关重要
- 开发环境经常不当使用生产数据,造成合规风险
- 必须映射关键业务功能与云资源之间的依赖关系

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


## 核心教训总结

1. 采用"假设已被攻破"的心态 - 恢复能力就是一切
2. 网络恢复需要专门的工具和流程 - 传统备份工具不够用
3. 凭证隔离和独立恢复环境是必需的
4. 版本控制不是备份 - 不能防御复杂攻击
5. 时间就是金钱 - 每小时的停机都在造成巨大损失
6. 安全投资不能被削减 - 今天的漏洞是昨天的预算决策造成的