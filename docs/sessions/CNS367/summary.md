# AWS re:Invent 2025 - CNS367 会议总结

## 会议概述

本次会议主题为"调试 Lambda 函数的新方法"，由 AWS 无服务器团队的首席产品经理 Shrar Pande 和高级软件工程师 Harold Sun 主讲。会议重点介绍了三项革命性的新功能，旨在彻底改变 Lambda 函数的开发、测试和调试体验。传统的 Lambda 调试方式需要反复添加日志、部署、调用和检查日志，这个过程耗时且影响生产力。新功能的推出将开发周期加速了 40%，使开发者能够在本地设备上无缝测试 Lambda 函数，并像调试本地代码一样轻松地调试云端函数。

会议深入探讨了无服务器开发工作流程中的"内循环"（本地快速迭代）和"外循环"（云端部署和协作）概念。内循环的核心要求是速度，任何减慢内循环的因素都会严重影响开发者生产力。演讲者识别了三个主要挑战：设置摩擦（传统设置需要 30-40 分钟）、本地测试限制（多服务工作流难以在本地复现）、以及仅在云端出现的问题（如 VPC 配置、IAM 权限等）。针对这些挑战，AWS 推出了控制台到 IDE 的无缝转换、LocalStack 集成和远程调试功能，分别将设置时间减少到 30 秒以内、本地测试迭代速度提升 75-80%、调试时间减少 80-85%。

## 详细时间线

00:00 - 02:30 - 会议开场与介绍
- 欢迎参加 CNS367 会议
- 演讲者自我介绍：Shrar Pande（首席产品经理）和 Harold Sun（高级软件工程师）
- 现场调查：询问有多少人最近花费 30 分钟以上调试 Lambda 函数

02:30 - 05:00 - 问题陈述与愿景
- 描述传统 Lambda 调试的痛点：反复添加日志、部署、调用、检查日志
- 提出理想状态：在本地设备上无缝测试 Lambda 函数，像调试本地代码一样调试云端函数

05:00 - 08:00 - 会议议程介绍
- 讨论当前无服务器开发者体验及其挑战
- 介绍转型新功能
- 分享最佳实践
- 展望未来发展

08:00 - 11:00 - 无服务器开发工作流程概念
- 解释"内循环"（inner loop）：本地开发环境中的快速迭代
- 解释"外循环"（outer loop）：推送到生产/测试环境，包括 CI/CD 流程
- 强调内循环最重要的要求是速度

11:00 - 15:00 - 三大核心挑战详解
- 挑战一：设置摩擦 - 传统设置需要 30-40 分钟
- 挑战二：本地测试限制 - 多服务工作流难以在本地测试
- 挑战三：云端特定问题 - VPC 配置、IAM 权限等无法在本地完全复现，传统调试每个 bug 需要 20-30 分钟

15:00 - 17:00 - 三大新功能介绍
- 控制台到 IDE 的无缝转换
- LocalStack 集成
- 云端函数远程调试
- 整体效果：开发周期加速 40%

17:00 - 22:00 - 功能一：控制台到 IDE 转换
- 解决设置摩擦问题
- 一键将代码和配置传输到本地 VS Code IDE
- 设置时间从 30-40 分钟减少到 30 秒以内（减少 95%）
- 现场演示：创建 Hello World 函数，点击"在 VS Code 中打开"，自动下载和设置代码，修改代码后自动同步回云端

22:00 - 28:00 - 功能二：LocalStack 集成
- 解决多服务工作流测试问题
- 展示示例架构：SQS → Lambda → DynamoDB → Lambda → EventBridge → SNS
- 介绍 LocalStack 作为本地云模拟器的集成
- 现场演示：投票计数应用，使用 SAM build 和 deploy 命令部署到 LocalStack，验证资源创建，运行测试脚本
- 效果：本地测试迭代速度提升 75-80%

28:00 - 35:00 - 功能三：远程调试介绍
- 解决仅在云端出现的问题
- 可以直接从本地 VS Code IDE 调试运行在 AWS 云端账户中的函数
- 调试真实的函数设置和数据，无需任何设置
- 桥接内循环和外循环：IDE 体验（断点、单步调试、变量检查）+ 生产环境真实性（AWS 服务、VPC、IAM）
- 调试时间减少 80-85%（从 20-30 分钟减少到 3-5 分钟）

35:00 - 40:00 - 远程调试简单示例演示
- 演示认证应用：API Gateway + Lambda
- 逻辑：如果用户名是 Harold 则登录成功，否则失败
- 使用 curl 测试，发现 Harold 也登录失败
- 在 VS Code 的 Application Builder 中启动远程调试会话
- 设置断点，发现 user_info 字段没有获取到值
- 识别问题：请求 payload 中的字段名有下划线，代码中没有
- 修复代码，SAM sync 自动部署，验证修复成功

40:00 - 48:00 - 远程调试复杂示例演示（Harold Sun）
- 订单处理应用架构：SQS → Lambda → 外部支付 API
- Lambda 在 VPC 私有子网中，使用 VPC endpoint 连接 Parameter Store，使用 NAT gateway 访问外部 API
- 问题：应用在 US East 1 工作正常，但在 EU West 1 部署后不工作
- 发送测试订单到 US East 1 成功，发送到 EU West 1 超时
- 使用远程调试，设置断点，单步执行
- 发现函数在读取 Parameter Store 配置时卡住
- 检查 VPC endpoint 的安全组入站规则
- 发现安全组允许 10.10 IP 范围，但 Lambda 函数使用 10.2 CIDR 范围
- 修复安全组规则，重新测试成功

48:00 - 52:00 - 远程调试工作原理
- 三个组件：本地 VS Code 中的 AWS Toolkit、IoT 安全隧道服务、Lambda layer
- AWS Toolkit 设置本地隧道连接到安全隧道服务
- Lambda layer 拦截调用并设置本地代理连接到隧道
- 本地调试器通过隧道连接到 Lambda 运行时

52:00 - 54:00 - 用户反馈
- 展示来自 Luke（Post 公司首席工程师）和 Omini 公司无服务器软件工程师的积极评价
- 用户认为这些功能是无服务器开发者的"游戏规则改变者"

54:00 - 60:00 - 最佳实践
- 在开发的不同阶段组合使用工具
- 从 Lambda 控制台开始，使用控制台到 IDE 功能
- 使用 SAM local 和 LocalStack 进行本地测试
- 部署到测试环境后使用远程调试
- 生产环境使用 CloudWatch 日志和追踪进行监控

60:00 - 62:00 - 安全最佳实践
- "朋友不让朋友在生产环境调试"
- 在开发或测试环境使用远程调试
- 使用 IAM 策略或 SCP 在生产账户中禁用调试功能
- 锁定生产环境的函数更新操作，仅允许 CI/CD 角色执行

62:00 - 64:00 - 远程调试注意事项
- 远程调试允许检查状态、运行代码、查看变量和单步执行，但不允许更改代码
- 使用 SAM sync 命令持续监视代码变化并快速同步到云端
- 远程调试会附加 layer、延长超时到 15 分钟、发布临时版本
- 对于有 SnapStart 或预置并发的函数，可以选择不发布版本以加快速度
- 可以使用事件触发器（如 SQS）直接触发调试会话

64:00 - 67:00 - 总结与展望
- 三个新功能有意义地转变了无服务器测试和调试体验
- 这些功能相互补充，帮助桥接内循环和外循环
- 与现有功能无缝协作，整体加速开发时间 40% 或更多
- 宣布 Lambda 公开路线图（GitHub）
- 邀请社区查看路线图、分享反馈、投票和贡献想法

67:00 - 68:30 - 行动号召与结束
- 三步开始使用新功能
- 提供文档链接的二维码
- 感谢参会者
- 请求完成会议调查