# AWS 技术会议总结：Sky 如何利用 Redis Cloud 实现流媒体服务的无限扩展

## 会议概述

本次会议由 Redis 首席产品官 John Fritz 和 NBC Universal Sky 全球流媒体工程经理 Lena Ysef 共同主讲，主题聚焦于 Sky 如何通过 Redis Cloud 重新架构其书签服务，实现流媒体平台的大规模扩展。

会议首先介绍了 Redis 的最新创新，包括 Redis 8.4 版本带来的高达 90% 的延迟改进、Redis Cloud 的两种部署模式（Essentials 和 Pro）以及新推出的 Redis Flex 功能。Redis Flex 允许同时使用 RAM 和 SSD，可扩展至 50TB，并降低高达 75% 的成本。此外，Redis 在生成式 AI 领域的应用也得到重点强调，特别是 Redis 向量搜索和语义缓存解决方案 Redis Lane Cache，后者可将 LLM 调用性能提升 15 倍，成本降低 90%。

随后，Lena 详细分享了 Sky 的实践案例。Sky 拥有超过 4100 万 Peacock 用户，是直播体育流媒体领域的领导者。他们的书签服务每天处理数百万次读写操作，原有的 Cassandra 架构面临成本高昂、扩展困难、无法满足产品需求等挑战。通过采用 Redis Cloud 的双集群架构（String 集群用于高频写入，Sorted Set 集群用于数据处理），Sky 成功将数据库写入压力降低了 20-40 倍，实现了向 AWS Keyspaces 的平滑迁移，并为即将到来的 NFL 独家赛事做好了准备。

## 详细时间线与关键要点

### 开场与 Redis 产品介绍

[00:00:00 - 00:02:30] 会议开场
- John Fritz 介绍会议议程：前 10-15 分钟介绍 Redis 创新，随后由 Lena 分享 Sky 的实践案例
- Redis 已超过 100 亿次 Docker 拉取，是第二个达到此里程碑的数据库项目
- Stack Overflow 调查显示 Redis 是最受欢迎的非关系型数据库

[00:02:30 - 00:04:00] Redis 8.4 版本发布
- 刚刚在开源版本发布，即将在 Redis Cloud 和企业版中提供
- 延迟改进高达 90%
- 显著提升扩展性和吞吐量
- 改进内存压缩，降低成本

[00:04:00 - 00:06:30] Redis Cloud 产品介绍
- Redis Cloud Essentials：完全无服务器，每 GB 成本最低，提供免费层级
- Redis Cloud Pro：高可用性（5 个 9 的可用性）、专用集群、主动-主动架构、快速扩展
- 两种部署模式：托管计算模型和自带云（BYOC）模型

[00:06:30 - 00:08:00] Redis Flex 新功能
- 结合 RAM 和 SSD 存储
- 可自定义 RAM 与 SSD 比例（最低 10% RAM，90% SSD）
- 扩展至 50TB
- 每 GB 成本降低高达 75%
- 适用于特征存储等用例

[00:08:00 - 00:09:30] 性能与扩展性改进
- 扩展速度提升 40%
- Redis 8.4 的原子槽迁移功能将进一步提升扩展性
- 智能客户端切换功能：在计划内事件（扩展、升级）期间消除中断
- 采用 AWS Graviton 实例，降低延迟并提升性能

[00:09:30 - 00:12:00] Redis 数据集成（RDI）
- 公开预览版现已在 Redis Cloud 中提供
- 实时从源数据库（PostgreSQL、Oracle、MongoDB、Snowflake）同步数据
- CDC 方式的数据转换
- 案例：Access Bank 使用 RDI 从 Oracle 提取数据构建移动银行应用，大幅降低延迟并提升扩展性

[00:12:00 - 00:15:30] Redis 在生成式 AI 中的应用
- Redis 快速、准确且高度集成（30+ AI 框架）
- 客户包括 OpenAI、Relevance AI、Raymond James
- Redis 在 GenAI 技术栈中的多层应用：长期存储（Redis Flex）、数据管道（RDI）、工作内存层、向量搜索

[00:15:30 - 00:18:00] Redis Lane Cache 语义缓存
- 缓存 LLM 响应以降低成本和延迟
- 性能提升高达 15 倍
- 成本降低高达 90%
- 案例：Assurion 客户服务应用响应时间提升 50%，网站互动率提升 4 倍

[00:18:00 - 00:19:00] Redis 多云部署能力
- 支持所有主要云平台、Kubernetes、本地部署
- 企业客户可在任何环境中部署统一的 Redis 引擎

### Sky 的书签服务案例分享

[00:19:00 - 00:21:00] Sky 公司介绍
- Peacock 在美国拥有超过 4100 万用户
- 直播体育流媒体领域的领导者
- 2024 年 NFL 外卡赛创下流媒体记录，占美国互联网流量的 30%
- 全球团队分布在美国、英国、捷克、葡萄牙和印度

[00:21:00 - 00:23:30] 书签功能概述
- 用户在观看内容时暂停，稍后可从同一位置继续
- 每天处理数百万次书签保存
- 支持"继续观看"功能，显示未完成的内容
- 技术挑战：在高频率读写下保持一致性和低延迟

[00:23:30 - 00:25:30] 原有架构的挑战
- 使用 Cassandra 存储书签
- 面临数据规模和负载压力
- 成本高昂
- 无法满足产品需求（如扩展书签保留期）
- 无法迁移到 AWS Keyspaces

[00:25:30 - 00:27:00] 旧架构分析
- 所有读写操作直接访问 Cassandra
- 无缓存层吸收流量
- 无短期和长期数据区分
- 持续高负载，无缓解点
- 横向扩展无法解决根本问题

[00:27:00 - 00:29:30] 评估 Redis 解决方案
- 最初考虑 Redis 开源版，但自管理运维负担重
- 选择 Redis Cloud Pro 托管服务
- 关键优势：自动扩展、跨区域复制、2 秒闪存持久化、多种数据结构支持、基于 TTL 的驱逐策略

[00:29:30 - 00:32:00] 新架构设计
- 双 Redis Cloud 集群架构
- String 集群：处理高频写入，去重数据，时间复杂度 O(1)
- Sorted Set 集群：按顺序处理书签，类似排行榜
- 书签在 Redis 中保留至少 10 分钟后写入长期存储
- 读取时并行查询 Redis 和长期存储，返回最新书签

[00:32:00 - 00:35:00] 实施过程
- 2023 年进行概念验证：功能测试、NFT、负载和延迟测试
- 累积率测试显示写入减少 20-40 倍
- 延迟基准测试（使用 memtier）
- Redis 8.2 版本改进了负载下的重新分片性能
- 等待 AWS PrivateLink 支持（2024 年夏季推出）
- 几周前正式上线，零事故

[00:35:00 - 00:37:00] 实施成果
- 写入压力降低 20 倍
- 解除性能瓶颈，加速功能开发
- 能够处理流量峰值而不降级
- 为 12 月底的 NFL 独家赛事做好准备
- 大幅降低成本
- 成功解锁向 AWS Keyspaces 的迁移

[00:37:00 - 00:39:00] 迁移到 AWS Keyspaces
- 托管 SaaS 服务，无需运维负担
- 每秒处理数百万次操作
- 5 个 9 的高可用性，多可用区复制
- 与 Apache Cassandra 兼容，无需代码更改
- AWS 合作提供大型数据库迁移支持，提升吞吐量

[00:39:00 - 00:42:00] 未来的 Redis 用例
- **并发管理（Conman）**：控制用户同时活跃的流数量，计划集成 Redis Cloud 和 PrivateLink，评估 Redis Flex
- **继续观看**：采用与书签类似的解决方案
- **个性化**：评估 Redis 作为特征存储替代方案

[00:42:00 - 00:45:00] GenAI 平台（Geneap）
- 多用途生成式 AI 平台，支持开发和生产工作负载
- 供应商和云提供商无关
- 提供护栏、治理和安全性
- 标准化、成本跟踪
- 三种租户类型：工作流（连续 AI 请求）、应用程序、开发环境
- 计划使用 Redis 向量搜索和语义缓存功能

[00:45:00 - 结束] 总结
- Redis Cloud 帮助 Sky 解决了关键的扩展性和成本挑战
- 成功案例为更多用例铺平道路
- 持续探索 Redis 在 AI 和流媒体领域的应用