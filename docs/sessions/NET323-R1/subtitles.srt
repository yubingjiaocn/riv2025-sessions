1
00:00:01,290 --> 00:00:02,123
- [Pablo] Perfect.

2
00:00:02,123 --> 00:00:03,840
So let's get started.

3
00:00:03,840 --> 00:00:08,040
So network operations at scale
has three major challenges,

4
00:00:08,040 --> 00:00:10,380
manual processes that don't scale,

5
00:00:10,380 --> 00:00:13,590
inconsistent deployments
that create security risks,

6
00:00:13,590 --> 00:00:16,980
and validation that happens too late.

7
00:00:16,980 --> 00:00:17,880
In the session today,

8
00:00:17,880 --> 00:00:19,650
we're going to try to
solve these challenges,

9
00:00:19,650 --> 00:00:21,220
applying the same principles

10
00:00:22,380 --> 00:00:24,060
majority of your developer teams

11
00:00:24,060 --> 00:00:26,010
or of your developers are already doing

12
00:00:26,939 --> 00:00:27,772
in your own teams,

13
00:00:27,772 --> 00:00:29,880
which is automation testing

14
00:00:29,880 --> 00:00:31,623
and policy-driven deployment.

15
00:00:32,640 --> 00:00:33,473
Welcome, everybody.

16
00:00:33,473 --> 00:00:35,460
This is NET323,

17
00:00:35,460 --> 00:00:38,970
networks at scale and how
to automate operations.

18
00:00:38,970 --> 00:00:39,840
My name is Pablo Sanchez.

19
00:00:39,840 --> 00:00:43,320
I'm a senior network specialist
solutions architect at AWS.

20
00:00:43,320 --> 00:00:45,210
And with me I have Claudia.

21
00:00:45,210 --> 00:00:46,267
- [Claudia] Hi, everyone.

22
00:00:46,267 --> 00:00:47,400
I'm Claudia Izquierdo.

23
00:00:47,400 --> 00:00:50,253
I'm a senior solutions
architect here at AWS.

24
00:00:51,090 --> 00:00:53,763
- [Pablo] Perfect. So
what's the agenda today?

25
00:00:55,500 --> 00:00:58,080
Which one of you knows
what a code talk is?

26
00:00:58,080 --> 00:00:59,610
Raise your hand.

27
00:00:59,610 --> 00:01:00,810
So not so many people.

28
00:01:00,810 --> 00:01:01,643
Okay, perfect.

29
00:01:01,643 --> 00:01:03,690
So the agenda today is going to be

30
00:01:03,690 --> 00:01:06,660
intensive in coding solutions.

31
00:01:06,660 --> 00:01:10,260
So we will try to be here
speaking less amount of time

32
00:01:10,260 --> 00:01:13,530
and just more interacting with
you while we build something.

33
00:01:13,530 --> 00:01:16,500
But first of all we wanted
to kind of expand on these

34
00:01:16,500 --> 00:01:19,530
scaling challenges in AWS networking.

35
00:01:19,530 --> 00:01:20,790
What are the best practices

36
00:01:20,790 --> 00:01:22,470
for these automated network operations

37
00:01:22,470 --> 00:01:24,540
that we have seen in customers?

38
00:01:24,540 --> 00:01:27,990
We will explain briefly the use
case that we're going to use

39
00:01:27,990 --> 00:01:29,400
as an example today.

40
00:01:29,400 --> 00:01:30,720
And then, of course, time to code,

41
00:01:30,720 --> 00:01:33,900
and then a little bit of
takeaways for the session.

42
00:01:33,900 --> 00:01:35,550
We're going to be talking
about all of the things,

43
00:01:35,550 --> 00:01:38,913
so which things we want you to
take after the session today.

44
00:01:40,170 --> 00:01:42,120
So about these challenges.

45
00:01:42,120 --> 00:01:44,370
So let me start kind of painting a picture

46
00:01:44,370 --> 00:01:46,980
that maybe the majority
of you kind of can relate.

47
00:01:46,980 --> 00:01:51,210
So a company starts small,
small number of VPCs,

48
00:01:51,210 --> 00:01:53,700
just connect between them,
a couple of accounts,

49
00:01:53,700 --> 00:01:55,860
and that it's easy to get full control,

50
00:01:55,860 --> 00:01:57,810
to know exactly how things connect,

51
00:01:57,810 --> 00:02:00,060
what's the security of this application,

52
00:02:00,060 --> 00:02:03,120
and of course, like, make sure
that everything's documented

53
00:02:03,120 --> 00:02:04,920
and it's working perfectly.

54
00:02:04,920 --> 00:02:06,090
But then growth happens.

55
00:02:06,090 --> 00:02:10,950
New VPCs come in, new
accounts, mergers can happen,

56
00:02:10,950 --> 00:02:12,960
and then suddenly it's
not a natural growth.

57
00:02:12,960 --> 00:02:14,283
It can be exponential.

58
00:02:15,210 --> 00:02:18,510
And those tight controls
or those controls initially

59
00:02:18,510 --> 00:02:21,870
for these small environments
can be called a bottleneck

60
00:02:21,870 --> 00:02:23,040
for specific teams.

61
00:02:23,040 --> 00:02:25,410
Usually cloud network networking teams

62
00:02:25,410 --> 00:02:29,100
are not that big teams in comparison

63
00:02:29,100 --> 00:02:33,450
to the amount of resources
that you guys need to manage.

64
00:02:33,450 --> 00:02:36,540
And then applications team,
they're asking them to be agile,

65
00:02:36,540 --> 00:02:38,730
but then they need to start waiting time

66
00:02:38,730 --> 00:02:41,010
to get some approvals and
to get some routes done

67
00:02:41,010 --> 00:02:44,310
or some specific security
controls in place.

68
00:02:44,310 --> 00:02:45,630
And of course, these teams,

69
00:02:45,630 --> 00:02:47,370
because they want to be agile, they are,

70
00:02:47,370 --> 00:02:49,500
well, let's say that
they're well-intentioned,

71
00:02:49,500 --> 00:02:51,990
hopefully a majority of the time, yes.

72
00:02:51,990 --> 00:02:52,823
They open a port,

73
00:02:52,823 --> 00:02:55,770
they open a security group
a little bit more open

74
00:02:55,770 --> 00:02:58,500
that we would like to have to get

75
00:02:58,500 --> 00:03:01,410
that connectivity happening.

76
00:03:01,410 --> 00:03:03,390
And now we have configuration drifts

77
00:03:03,390 --> 00:03:05,190
and now we have configuration

78
00:03:05,190 --> 00:03:07,260
that we don't know what's
happening with them.

79
00:03:07,260 --> 00:03:09,390
And of course, like, when
we need to troubleshoot

80
00:03:09,390 --> 00:03:11,280
or when we need to know
exactly what's happening

81
00:03:11,280 --> 00:03:12,390
with our environment,

82
00:03:12,390 --> 00:03:14,940
we're not really sure on what's happening.

83
00:03:14,940 --> 00:03:17,470
So kind of that's what we see that

84
00:03:18,570 --> 00:03:20,970
when we grow we get
these three main things,

85
00:03:20,970 --> 00:03:23,580
this consistency and governance issues,

86
00:03:23,580 --> 00:03:25,080
manual configuration bottlenecks,

87
00:03:25,080 --> 00:03:27,810
and especially change management.

88
00:03:27,810 --> 00:03:30,870
We always tell, like, the
cloud allows you to be agile,

89
00:03:30,870 --> 00:03:32,870
but then, of course,
usually we think, like,

90
00:03:32,870 --> 00:03:34,830
the network is something fixed,

91
00:03:34,830 --> 00:03:35,910
and that shouldn't be like that.

92
00:03:35,910 --> 00:03:39,570
The cloud network should also
allow for change management

93
00:03:39,570 --> 00:03:42,513
without adding extra complexity into that.

94
00:03:44,880 --> 00:03:47,340
- [Claudia] So to face
these three challenges

95
00:03:47,340 --> 00:03:48,780
that Pablo just mentioned,

96
00:03:48,780 --> 00:03:51,330
we are starting to first, one,

97
00:03:51,330 --> 00:03:56,310
adopt the to work with a
multi-account environment,

98
00:03:56,310 --> 00:03:58,020
and this multi-account environment

99
00:03:58,020 --> 00:04:00,840
also comes with guardrails.

100
00:04:00,840 --> 00:04:03,270
So working with guardrails helps you

101
00:04:03,270 --> 00:04:07,260
to focus on permission
control for the security

102
00:04:07,260 --> 00:04:11,640
of your architecture instead
of only networking blocking.

103
00:04:11,640 --> 00:04:16,020
And with this you can improve
how to manage the security

104
00:04:16,020 --> 00:04:17,280
of your architecture

105
00:04:17,280 --> 00:04:20,370
and with that your network in AWS

106
00:04:20,370 --> 00:04:23,940
and also to make this easier for everyone.

107
00:04:23,940 --> 00:04:28,940
And second is to use
managed AWS network services

108
00:04:29,940 --> 00:04:32,130
that we have here at AWS,

109
00:04:32,130 --> 00:04:37,110
but more specifically the
service to build global networks.

110
00:04:37,110 --> 00:04:39,150
So like Pablo mentioned,

111
00:04:39,150 --> 00:04:42,210
the task for all these network engineers

112
00:04:42,210 --> 00:04:45,030
like creating Amazon VPCs,

113
00:04:45,030 --> 00:04:47,280
creating AWS site-to-site VPN,

114
00:04:47,280 --> 00:04:48,930
creating a routing table,

115
00:04:48,930 --> 00:04:51,540
adding routes, deleting these routes,

116
00:04:51,540 --> 00:04:54,600
all of these different
tasks can be optimized

117
00:04:54,600 --> 00:04:57,660
and help all these network engineers

118
00:04:57,660 --> 00:04:59,880
working with these global networks.

119
00:04:59,880 --> 00:05:02,250
And then go serverless.

120
00:05:02,250 --> 00:05:04,920
Use the different serverless services

121
00:05:04,920 --> 00:05:08,280
that we have at AWS so you can deploy

122
00:05:08,280 --> 00:05:11,340
and automate these many different tasks

123
00:05:11,340 --> 00:05:15,750
that not only the network
engineers has to do,

124
00:05:15,750 --> 00:05:19,200
but also the many requests
that may be having

125
00:05:19,200 --> 00:05:23,820
for the many different
users that are asking

126
00:05:23,820 --> 00:05:26,760
for help from these network engineers.

127
00:05:26,760 --> 00:05:30,330
So how does this look at AWS?

128
00:05:30,330 --> 00:05:35,330
First one, to start
using AWS Organizations.

129
00:05:35,418 --> 00:05:39,430
AWS Organization is the
service that we have at AWS

130
00:05:40,980 --> 00:05:43,380
where you can deploy

131
00:05:43,380 --> 00:05:46,470
multi-accounts
environments, architectures,

132
00:05:46,470 --> 00:05:49,560
and also app guardrails

133
00:05:49,560 --> 00:05:52,920
which are named service control policies.

134
00:05:52,920 --> 00:05:57,360
So first start with AWS Organizations.

135
00:05:57,360 --> 00:06:01,250
That then work with AWS Cloud WAN.

136
00:06:01,250 --> 00:06:05,880
AWS Cloud WAN, it's a service
to build global networks,

137
00:06:05,880 --> 00:06:08,040
but not only building global networks,

138
00:06:08,040 --> 00:06:11,430
to build global networks
with policy as code.

139
00:06:11,430 --> 00:06:13,620
So in this session you're going to learn

140
00:06:13,620 --> 00:06:15,810
how to build these policies.

141
00:06:15,810 --> 00:06:20,040
So the idea here is to
know a little bit more

142
00:06:20,040 --> 00:06:21,870
about AWS Cloud WAN

143
00:06:21,870 --> 00:06:23,790
and AWS Step Functions.

144
00:06:23,790 --> 00:06:26,190
Step Functions is going to help you

145
00:06:26,190 --> 00:06:30,480
to automate the different steps

146
00:06:30,480 --> 00:06:33,360
that are required to build the things

147
00:06:33,360 --> 00:06:36,510
that the networking engineers need help,

148
00:06:36,510 --> 00:06:41,040
but orchestrating those
different steps that are required

149
00:06:41,040 --> 00:06:44,250
for this to happen

150
00:06:44,250 --> 00:06:47,703
and to help everyone in everything.

151
00:06:48,600 --> 00:06:49,433
- [Pablo] Perfect.

152
00:06:49,433 --> 00:06:51,690
So what's the use case we're going to try

153
00:06:51,690 --> 00:06:55,710
to use today to show you
these best practices?

154
00:06:55,710 --> 00:06:59,040
So basically we have an environment

155
00:06:59,040 --> 00:07:00,330
where the IP address management

156
00:07:00,330 --> 00:07:02,310
we want to be controlled by VPC IPAM.

157
00:07:02,310 --> 00:07:07,170
We want to make sure that
teams don't create VPCs

158
00:07:07,170 --> 00:07:09,592
with IPs are not into the IPAM portal

159
00:07:09,592 --> 00:07:11,430
that we are going to provide to them.

160
00:07:11,430 --> 00:07:12,900
We need traffic segmentation.

161
00:07:12,900 --> 00:07:15,540
The logic we're using
today is we want to have

162
00:07:15,540 --> 00:07:17,763
a routing domain per environment,

163
00:07:18,660 --> 00:07:21,917
dev, prod, whatever routing
environment we have,

164
00:07:21,917 --> 00:07:23,700
we are going to keep it simple for today,

165
00:07:23,700 --> 00:07:26,850
but we want to have that
traffic segmentation

166
00:07:26,850 --> 00:07:28,410
also in our network.

167
00:07:28,410 --> 00:07:29,640
We want to have traffic inspection.

168
00:07:29,640 --> 00:07:32,610
We want to make sure that
everything is inspected

169
00:07:32,610 --> 00:07:34,140
between routing domains

170
00:07:34,140 --> 00:07:36,930
and anything that goes
out to the internet.

171
00:07:36,930 --> 00:07:40,770
And of course, it needs to be
low in operational overhead

172
00:07:40,770 --> 00:07:42,900
because we only have two engineers,

173
00:07:42,900 --> 00:07:45,960
the two people that you see
right now here talking to you

174
00:07:45,960 --> 00:07:49,530
only managing all that network at scale.

175
00:07:49,530 --> 00:07:51,150
So what we have already built

176
00:07:51,150 --> 00:07:54,300
and then I'll go to what we
are going to be building today.

177
00:07:54,300 --> 00:07:55,740
So this is the organizations we have.

178
00:07:55,740 --> 00:07:57,150
We're keeping it simple

179
00:07:57,150 --> 00:08:01,650
but definitely think of more
than one organizational unit.

180
00:08:01,650 --> 00:08:02,760
But we have three accounts.

181
00:08:02,760 --> 00:08:04,050
We have the account that is going to be

182
00:08:04,050 --> 00:08:07,140
managing AWS Organizations, one account,

183
00:08:07,140 --> 00:08:09,870
networking accounting in the
networking organizational unit,

184
00:08:09,870 --> 00:08:13,950
and the spoke account in
the dev organizational unit.

185
00:08:13,950 --> 00:08:15,240
In the networking account,

186
00:08:15,240 --> 00:08:20,220
we have defined Amazon VPC
IPAM with a root pool 10/8,

187
00:08:20,220 --> 00:08:23,610
and then to each one of the
regions we are defining a pool

188
00:08:23,610 --> 00:08:25,470
for the dev environment

189
00:08:25,470 --> 00:08:29,730
that we are sharing using AWS
Resource Access Manager, RAM,

190
00:08:29,730 --> 00:08:32,040
with that specific spoke account.

191
00:08:32,040 --> 00:08:34,770
So the spoke account can
only use the IPAM pools

192
00:08:34,770 --> 00:08:35,603
we are sharing.

193
00:08:36,540 --> 00:08:38,610
On the network level, AWS Cloud WAN,

194
00:08:38,610 --> 00:08:41,730
we have a initial version of the network

195
00:08:41,730 --> 00:08:42,930
and we're going to be building more

196
00:08:42,930 --> 00:08:45,000
during the session today.

197
00:08:45,000 --> 00:08:47,970
We have a hybrid segment
and a dev segment.

198
00:08:47,970 --> 00:08:49,770
I think we also have a prod segment.

199
00:08:49,770 --> 00:08:52,680
So we have, like, some
segmentation already created

200
00:08:52,680 --> 00:08:56,100
and we have, for the ones that don't know,

201
00:08:56,100 --> 00:08:57,120
we have service insertion.

202
00:08:57,120 --> 00:08:58,650
We will explain later in a moment.

203
00:08:58,650 --> 00:09:02,730
But that's our way in Cloud
WAN to automate the creation

204
00:09:02,730 --> 00:09:06,120
of inspection by just
simply telling the service,

205
00:09:06,120 --> 00:09:08,910
hey, I want to inspect these
two or these two segments

206
00:09:08,910 --> 00:09:10,950
or between a segment

207
00:09:10,950 --> 00:09:13,830
or things outside of the, to the internet.

208
00:09:13,830 --> 00:09:17,130
But we have already created
that inspection segment,

209
00:09:17,130 --> 00:09:18,660
which is called a network function group,

210
00:09:18,660 --> 00:09:22,690
and our three inspection VPCs
with AWS Network Firewall

211
00:09:23,640 --> 00:09:24,780
already created them.

212
00:09:24,780 --> 00:09:27,873
So we are just going to be
creating the inspection itself.

213
00:09:28,890 --> 00:09:32,373
And of course, AWS Cloud
WAN is created by AWS,

214
00:09:33,540 --> 00:09:36,360
is shared using Resource Access Manager

215
00:09:36,360 --> 00:09:39,663
with the rest of the accounts.

216
00:09:41,790 --> 00:09:44,460
- [Claudia] But Pablo, don't
you think that everyone is here

217
00:09:44,460 --> 00:09:46,350
to learn a little bit of coding?

218
00:09:46,350 --> 00:09:47,940
- [Pablo] Yeah, so we
are going to be coding.

219
00:09:47,940 --> 00:09:49,470
I think we took 10 minutes,

220
00:09:49,470 --> 00:09:52,140
which is exactly the time
we were thinking about.

221
00:09:52,140 --> 00:09:54,210
So let's go into with the
different requirements.

222
00:09:54,210 --> 00:09:55,800
Let's go with the first requirement,

223
00:09:55,800 --> 00:09:59,490
which is VPC IPAM as only
IP allocation source.

224
00:09:59,490 --> 00:10:00,990
So what are we going to do?

225
00:10:00,990 --> 00:10:03,090
First, we're going to
show that by default,

226
00:10:03,090 --> 00:10:05,790
I can create noncompliant VPCs

227
00:10:05,790 --> 00:10:08,910
just to show that how, that by default,

228
00:10:08,910 --> 00:10:10,200
yes, someone can create something

229
00:10:10,200 --> 00:10:12,510
outside of the VPC IPAM.

230
00:10:12,510 --> 00:10:13,343
Once we do that,

231
00:10:13,343 --> 00:10:16,680
what we're going to do is
create a service control policy

232
00:10:16,680 --> 00:10:21,390
that only allows creation
of VPCs with the IPAM pools

233
00:10:21,390 --> 00:10:23,070
shared with the account.

234
00:10:23,070 --> 00:10:24,420
We're going to do the same creation

235
00:10:24,420 --> 00:10:26,010
and we're going to get it denied

236
00:10:26,010 --> 00:10:28,830
and afterwards we're going
to be starting creating

237
00:10:28,830 --> 00:10:31,830
the different VPCs.

238
00:10:31,830 --> 00:10:34,920
So let me change to the demo.

239
00:10:34,920 --> 00:10:36,033
Let's go for it.

240
00:10:37,440 --> 00:10:38,730
- [Claudia] Thanks, Pablo.

241
00:10:38,730 --> 00:10:41,850
So I'll be walking around here,

242
00:10:41,850 --> 00:10:45,123
so if you have questions
please, let me know.

243
00:10:46,020 --> 00:10:48,240
Remember this is an interactive session,

244
00:10:48,240 --> 00:10:51,750
so the idea is to hear from you too.

245
00:10:51,750 --> 00:10:55,770
So Pablo, can I just
know what are you coding,

246
00:10:55,770 --> 00:10:57,798
what type of coding it is,

247
00:10:57,798 --> 00:11:00,390
why are you using Kiro?

248
00:11:00,390 --> 00:11:01,950
- [Pablo] Yes, so, well, first of all,

249
00:11:01,950 --> 00:11:04,050
I'm using Kiro, if you don't know,

250
00:11:04,050 --> 00:11:09,050
it's our IDE that also allows
us to use GenAI agents.

251
00:11:09,330 --> 00:11:11,760
We're not going to be doing
the help of AI agents today.

252
00:11:11,760 --> 00:11:13,533
It's going to be Pablo AI.

253
00:11:15,568 --> 00:11:18,690
But then what I'm using
is VPC Terraform module

254
00:11:18,690 --> 00:11:21,163
that we're going to be coding
everything today in Terraform,

255
00:11:21,163 --> 00:11:26,163
a VPC module created by us
that are maintained by us,

256
00:11:26,340 --> 00:11:30,330
by the networking team
in in AWS just to create

257
00:11:30,330 --> 00:11:33,570
where I'm going to start
creating that non-compliant VPC

258
00:11:33,570 --> 00:11:36,990
and then I'm going to move to put the SCP

259
00:11:36,990 --> 00:11:38,583
in AWS Organizations.

260
00:11:40,350 --> 00:11:41,677
- [Claudia] Thank you, Pablo.

261
00:11:41,677 --> 00:11:45,600
So the idea in here is that
we are just getting started.

262
00:11:45,600 --> 00:11:47,133
This is IPAM.

263
00:11:47,133 --> 00:11:50,160
IPAM is, as Pablo mentioned,

264
00:11:50,160 --> 00:11:55,160
is trying to stop someone
to deploying IP address

265
00:11:56,423 --> 00:11:58,290
that is not allowed.

266
00:11:58,290 --> 00:11:59,550
And why it's not allowed,

267
00:11:59,550 --> 00:12:03,090
because Pablo and I as
the networking architects

268
00:12:03,090 --> 00:12:06,630
and engineers decided that that's the pool

269
00:12:06,630 --> 00:12:09,240
that everyone has to use

270
00:12:09,240 --> 00:12:12,330
or it's divided by the different segments

271
00:12:12,330 --> 00:12:16,410
that it's based on the
best practices that he

272
00:12:16,410 --> 00:12:18,300
and I just decide.

273
00:12:18,300 --> 00:12:22,560
So the idea here is to work with IPAM

274
00:12:22,560 --> 00:12:25,530
to use that pool that Pablo and I decide,

275
00:12:25,530 --> 00:12:29,280
but service contrast policy
from AWS Organization,

276
00:12:29,280 --> 00:12:31,110
it's going to help us

277
00:12:31,110 --> 00:12:34,050
so no one is going to deploy a network

278
00:12:34,050 --> 00:12:35,580
that it's not allowed.

279
00:12:35,580 --> 00:12:37,170
So back to you, Pablo.

280
00:12:37,170 --> 00:12:38,850
- [Pablo] Yeah, so basically right now

281
00:12:38,850 --> 00:12:40,830
I'm creating that VPC,

282
00:12:40,830 --> 00:12:43,630
so I'm coming here, I think
I'm creating North Virginia.

283
00:12:45,240 --> 00:12:48,570
So basically now, I guess
you see now better, right?

284
00:12:48,570 --> 00:12:49,590
- [Claudia] Mm-hmm.

285
00:12:49,590 --> 00:12:50,940
- [Pablo] So now we have that VPC

286
00:12:50,940 --> 00:12:52,320
that is not compliant at all

287
00:12:52,320 --> 00:12:54,540
because we are going to be using the 10/8

288
00:12:54,540 --> 00:12:57,990
and we have the 172 range.

289
00:12:57,990 --> 00:13:01,800
So now I'm going to add AWS, the SCP,

290
00:13:01,800 --> 00:13:04,710
to block that specific action to happen.

291
00:13:04,710 --> 00:13:07,470
Let me start by destroying this

292
00:13:07,470 --> 00:13:10,683
and then I'll move to the
part of the code for AWS.

293
00:13:12,210 --> 00:13:14,613
And yes, and then I'll remove this.

294
00:13:16,890 --> 00:13:17,723
Perfect.

295
00:13:17,723 --> 00:13:20,703
So if I move to my organization's folder,

296
00:13:21,720 --> 00:13:23,787
I already have defined the SCP

297
00:13:23,787 --> 00:13:25,230
and the only thing I'm going to do is

298
00:13:25,230 --> 00:13:26,610
going to create the resources

299
00:13:26,610 --> 00:13:29,250
to deploy in my organization's account.

300
00:13:29,250 --> 00:13:32,580
Basically what I'm doing is
denying any creation of a VPC

301
00:13:32,580 --> 00:13:35,400
and also association of
a secondary CIDR block.

302
00:13:35,400 --> 00:13:36,750
I don't want anyone cheating

303
00:13:36,750 --> 00:13:39,630
after they created the
VPC with the IPAM pool.

304
00:13:39,630 --> 00:13:43,713
So denying these two
actions if there's no IPv4

305
00:13:43,713 --> 00:13:44,910
IPAM pool true.

306
00:13:44,910 --> 00:13:47,760
And also because we're
controlling which IPAM pool

307
00:13:47,760 --> 00:13:49,830
we're providing to the dev account,

308
00:13:49,830 --> 00:13:53,400
we're controlling that
is the specific IPAM pool

309
00:13:53,400 --> 00:13:55,050
that they can build.

310
00:13:55,050 --> 00:13:58,263
So I'll create the two
resources right now.

311
00:13:59,970 --> 00:14:01,050
- [Claudia] Thank you, Pablo.

312
00:14:01,050 --> 00:14:05,327
So who from the audience
is working with IPAM?

313
00:14:08,272 --> 00:14:12,243
Okay, and who is working
with AWS Cloud WAN?

314
00:14:13,860 --> 00:14:16,233
Great, I love that.

315
00:14:17,730 --> 00:14:22,620
So the thing in here is
to let that only Pablo

316
00:14:22,620 --> 00:14:25,750
and I as the network specialist to decide

317
00:14:26,880 --> 00:14:28,920
what IP address can be used

318
00:14:28,920 --> 00:14:32,310
by many of the other part of our team,

319
00:14:32,310 --> 00:14:37,310
because, you know, /24, it's
not for all the Amazon VPCs

320
00:14:37,911 --> 00:14:38,744
and for all the subnets.

321
00:14:40,020 --> 00:14:44,040
So if anyone has a question,
please raise your hand

322
00:14:44,040 --> 00:14:48,720
and I will reach to you to
see what question do you have.

323
00:14:48,720 --> 00:14:51,120
So Pablo, back to you.

324
00:14:51,120 --> 00:14:52,980
- [Pablo] Yeah, I'm still finishing, so...

325
00:14:52,980 --> 00:14:53,813
- [Claudia] Okay.

326
00:14:53,813 --> 00:14:55,530
- [Pablo] I don't think I can type

327
00:14:55,530 --> 00:14:57,690
and speak at the same time.

328
00:14:57,690 --> 00:14:58,740
- [Claudia] Don't worry.

329
00:14:58,740 --> 00:15:03,740
- [Miguel] So my question
is how can you share,

330
00:15:03,810 --> 00:15:06,870
maybe you need to RAM
share a specific segment

331
00:15:06,870 --> 00:15:08,280
to a specific account.

332
00:15:08,280 --> 00:15:09,113
- [Claudia] Okay.

333
00:15:09,113 --> 00:15:10,560
- [Miguel] So I wanna know, for example,

334
00:15:10,560 --> 00:15:14,550
if I have a situation where I
dynamically create accounts,

335
00:15:14,550 --> 00:15:18,300
I wanna make sure that specific siders

336
00:15:18,300 --> 00:15:21,450
or segments go to specific accounts.

337
00:15:21,450 --> 00:15:25,515
- [Claudia] Okay, so the
question that, what's your name?

338
00:15:25,515 --> 00:15:26,348
- [Miguel] Miguel.

339
00:15:26,348 --> 00:15:29,340
- [Claudia] Miguel just
ask is how can you make

340
00:15:29,340 --> 00:15:33,210
that an IP address to be attached

341
00:15:33,210 --> 00:15:37,770
or go with a specific
segment like, for example,

342
00:15:37,770 --> 00:15:39,363
dev or production?

343
00:15:41,160 --> 00:15:43,620
Pablo, have you done that before?

344
00:15:43,620 --> 00:15:44,550
- [Pablo] Yeah. Give me a moment.

345
00:15:44,550 --> 00:15:46,230
I'm just troubleshooting.

346
00:15:46,230 --> 00:15:47,200
- [Claudia] Don't worry.

347
00:15:47,200 --> 00:15:50,460
(audience member speaking off mic)

348
00:15:50,460 --> 00:15:52,460
- [Pablo] Ah, yeah, thank you very much.

349
00:15:53,340 --> 00:15:55,293
Definitely I needed an AI for this.

350
00:15:56,310 --> 00:15:58,260
So what was exactly the question?

351
00:15:58,260 --> 00:16:00,120
- [Claudia] How can you make an IP address

352
00:16:00,120 --> 00:16:01,560
to go for a specific segment,

353
00:16:01,560 --> 00:16:04,470
like this is for dev, this is for prod,

354
00:16:04,470 --> 00:16:06,090
and things like that?

355
00:16:06,090 --> 00:16:08,340
- [Pablo] So you need
to apply that logic more

356
00:16:08,340 --> 00:16:11,370
the way you share the
IPAM pools currently.

357
00:16:11,370 --> 00:16:12,870
So you create your IPAM pools

358
00:16:12,870 --> 00:16:14,940
and then, like, you do, like,

359
00:16:14,940 --> 00:16:17,700
when you are doing your
infrastructure as code,

360
00:16:17,700 --> 00:16:19,800
when you do RAM to a specific OU

361
00:16:19,800 --> 00:16:22,773
where it's dev or a test or production.

362
00:16:23,777 --> 00:16:26,640
- [Miguel] But in that case (indistinct)

363
00:16:26,640 --> 00:16:28,663
accounts be dynamically created?

364
00:16:28,663 --> 00:16:29,496
- [Pablo] Mm-hmm.

365
00:16:29,496 --> 00:16:32,370
- [Miguel] I'll have to
have some management.

366
00:16:32,370 --> 00:16:33,203
- [Pablo] Yeah, okay.

367
00:16:33,203 --> 00:16:35,820
So that majority of
customers use control tower

368
00:16:35,820 --> 00:16:37,407
that you can use for CloudFormation

369
00:16:37,407 --> 00:16:40,470
or for Terraform where you can do your...

370
00:16:40,470 --> 00:16:41,820
You can do your account factory,

371
00:16:41,820 --> 00:16:42,653
which you can say, hey,

372
00:16:42,653 --> 00:16:45,540
if this account is dev
then this is the IPAM pool,

373
00:16:45,540 --> 00:16:47,580
and then, of course,
this is your Cloud WAN

374
00:16:47,580 --> 00:16:48,840
or Transit Gateway.

375
00:16:48,840 --> 00:16:50,310
You do that when you create that account,

376
00:16:50,310 --> 00:16:51,600
you create your blueprint,

377
00:16:51,600 --> 00:16:53,430
and then when you do that dynamically,

378
00:16:53,430 --> 00:16:56,760
you just provide those
kind of shared services

379
00:16:56,760 --> 00:16:57,900
in the beginning.

380
00:16:57,900 --> 00:16:59,400
- [Miguel] Would you need
to have a specific account

381
00:16:59,400 --> 00:17:01,500
to run the tower from?

382
00:17:01,500 --> 00:17:02,340
- [Pablo] I think yes.

383
00:17:02,340 --> 00:17:03,930
And I'm not sure,

384
00:17:03,930 --> 00:17:05,760
but definitely yes, you
will need one account

385
00:17:05,760 --> 00:17:07,063
that is the one managing
the account factory.

386
00:17:07,063 --> 00:17:08,217
- [Claudia] Yes.

387
00:17:08,217 --> 00:17:10,200
- [Pablo] And then pushing
to the rest of the accounts.

388
00:17:10,200 --> 00:17:11,970
- [Claudia] Yes, best practices,

389
00:17:11,970 --> 00:17:15,390
it should be one main
account to push everything

390
00:17:15,390 --> 00:17:18,360
from the other accounts
in AWS Organization

391
00:17:18,360 --> 00:17:20,250
and in AWS Control Tower.

392
00:17:20,250 --> 00:17:21,357
Mm-hmm. Yeah.

393
00:17:23,520 --> 00:17:24,353
- [Pablo] Perfect.

394
00:17:24,353 --> 00:17:26,070
So I already have the
service control policy.

395
00:17:26,070 --> 00:17:29,610
You can see here I have
the same JSON I shared you

396
00:17:29,610 --> 00:17:33,420
but now created with our
target or dev account.

397
00:17:33,420 --> 00:17:37,500
So I think I removed that.

398
00:17:37,500 --> 00:17:39,150
Let me see if I can put it back.

399
00:17:39,150 --> 00:17:41,760
Yeah, so now I'm going
to try to create it again

400
00:17:41,760 --> 00:17:43,560
and see that now I want...

401
00:17:43,560 --> 00:17:48,157
I shouldn't be able to
create that specific VPC.

402
00:17:50,100 --> 00:17:51,050
- [Claudia] Mm-hmm.

403
00:17:52,290 --> 00:17:54,150
So Pablo, we have another question.

404
00:17:54,150 --> 00:17:57,450
Why are we using Terraform
and not CloudFormation?

405
00:17:57,450 --> 00:18:00,600
- [Pablo] Hmm, that's a personal decision.

406
00:18:00,600 --> 00:18:03,450
It's just, like, for me it's more native

407
00:18:03,450 --> 00:18:05,700
to write Terraform than CloudFormation.

408
00:18:05,700 --> 00:18:09,166
But that's on me.

409
00:18:09,166 --> 00:18:10,200
(audience member speaking off mic)

410
00:18:10,200 --> 00:18:12,000
Yeah, yeah, all the resources-

411
00:18:12,000 --> 00:18:14,220
- [Audience Member] Libraries
that were created there.

412
00:18:14,220 --> 00:18:15,150
- [Pablo] Yeah, yeah, all the resources

413
00:18:15,150 --> 00:18:16,710
that we are creating today,

414
00:18:16,710 --> 00:18:18,960
they're available in CloudFormation.

415
00:18:18,960 --> 00:18:21,120
Also if you use CDK,

416
00:18:21,120 --> 00:18:23,400
we have layer two constructs for...

417
00:18:23,400 --> 00:18:26,040
Layer three also for these
AWS networking services.

418
00:18:26,040 --> 00:18:27,847
Yeah, yeah.

419
00:18:27,847 --> 00:18:29,400
So I think I did the clear,

420
00:18:29,400 --> 00:18:31,470
but now if I do the apply,

421
00:18:31,470 --> 00:18:34,800
I should get deny on the
service control policy.

422
00:18:34,800 --> 00:18:37,620
So now what I'm going to do
is I'm going to start typing

423
00:18:37,620 --> 00:18:40,530
our proper VPC configuration

424
00:18:40,530 --> 00:18:44,643
with the VPC IPAM pool configure.

425
00:18:47,130 --> 00:18:48,517
- [Claudia] What's the question?

426
00:18:48,517 --> 00:18:52,343
- [Audience Member] Is it
possible to write the SCP policy

427
00:18:52,343 --> 00:18:55,794
without mentioning the IPAM pool?

428
00:18:55,794 --> 00:19:00,794
So basically just mention (indistinct).

429
00:19:01,253 --> 00:19:03,535
So as long as your VPC

430
00:19:03,535 --> 00:19:06,600
gets assigned (indistinct) range.

431
00:19:06,600 --> 00:19:08,670
- [Claudia] So, like, hard code the IP?

432
00:19:08,670 --> 00:19:09,503
- [Audience Member] Yeah.

433
00:19:09,503 --> 00:19:10,336
- [Claudia] Oh, okay.

434
00:19:10,336 --> 00:19:14,280
So the question in here is
that if we can not use IPAM

435
00:19:14,280 --> 00:19:19,280
and go to hard code the IP
addresses in the coding per se.

436
00:19:21,120 --> 00:19:22,650
So it's possible,

437
00:19:22,650 --> 00:19:24,960
but in here, like, the thing is that

438
00:19:24,960 --> 00:19:27,300
with IPAM you are not, like, hard coding.

439
00:19:27,300 --> 00:19:30,280
You're letting to IPAM
to take advantage of...

440
00:19:30,280 --> 00:19:34,230
IPAM, it's not only to,
like, give you IP addresses.

441
00:19:34,230 --> 00:19:38,430
It's going to help you to keep
control of your IP addresses.

442
00:19:38,430 --> 00:19:41,550
So for example, if you
are close to not having

443
00:19:41,550 --> 00:19:43,620
enough IP addresses pretty soon,

444
00:19:43,620 --> 00:19:44,490
it will let you know.

445
00:19:44,490 --> 00:19:49,490
Like, if you are not going to
have enough IP addresses soon.

446
00:19:49,710 --> 00:19:53,160
And also it helps you, as Pablo just say,

447
00:19:53,160 --> 00:19:55,830
to, like, have a design

448
00:19:55,830 --> 00:19:58,290
and how you want to
distribute your IP addresses.

449
00:19:58,290 --> 00:20:02,820
So I think that it helps more to have IPAM

450
00:20:02,820 --> 00:20:06,780
so you can more than just, like,

451
00:20:06,780 --> 00:20:09,090
stop people from not using the IP address

452
00:20:09,090 --> 00:20:10,020
that you would like,

453
00:20:10,020 --> 00:20:11,340
to also have control

454
00:20:11,340 --> 00:20:15,120
and monitoring the
addresses, the IP addresses.

455
00:20:15,120 --> 00:20:16,380
- [Audience Member]
Yeah, but for situations

456
00:20:16,380 --> 00:20:18,549
where you don't use IPAM

457
00:20:18,549 --> 00:20:19,778
or you use a different IPAM.

458
00:20:19,778 --> 00:20:20,697
- Yeah.
- Yeah?

459
00:20:20,697 --> 00:20:22,780
- [Claudia] Yeah. Mm-hmm.

460
00:20:25,194 --> 00:20:26,856
So back to you, Pablo.

461
00:20:26,856 --> 00:20:27,689
- [Pablo] Yeah, so now I have

462
00:20:27,689 --> 00:20:29,640
the version of the VPC created.

463
00:20:29,640 --> 00:20:33,360
So you see that the way we're
doing this is just defining

464
00:20:33,360 --> 00:20:35,970
the VPC IPAM pool, the netmask length.

465
00:20:35,970 --> 00:20:37,800
In that case, it's 24.

466
00:20:37,800 --> 00:20:39,830
Then we also are creating dual stack VPC.

467
00:20:39,830 --> 00:20:43,200
So also with IPv6.

468
00:20:43,200 --> 00:20:45,900
I'm cheating a little bit just
doing a classic copy paste

469
00:20:45,900 --> 00:20:48,180
and change the region.

470
00:20:48,180 --> 00:20:50,520
You see that we're using
North Virginia, Oregon,

471
00:20:50,520 --> 00:20:55,520
and the Spanish region
just to show you, like,

472
00:20:55,620 --> 00:20:58,710
a multi-region solution.

473
00:20:58,710 --> 00:21:02,970
But yeah, and then here what
I'm doing is I have my...

474
00:21:02,970 --> 00:21:04,410
I have some local variable

475
00:21:04,410 --> 00:21:08,507
where I'm obtaining the
IPAM pools from AWS RAM

476
00:21:10,650 --> 00:21:13,950
and just putting in a
local value just to gather,

477
00:21:13,950 --> 00:21:18,120
which is the IPAM ID per
each specific region.

478
00:21:18,120 --> 00:21:20,700
So I won't create the VPCs now.

479
00:21:20,700 --> 00:21:22,170
I will do it everything at the end

480
00:21:22,170 --> 00:21:24,300
so you see how everything
will connect to Cloud WAN

481
00:21:24,300 --> 00:21:27,060
and all the automation it's running.

482
00:21:27,060 --> 00:21:29,490
So now we were able to show,

483
00:21:29,490 --> 00:21:32,490
let me come back to these
slides for a moment,

484
00:21:32,490 --> 00:21:33,570
to show exactly this,

485
00:21:33,570 --> 00:21:36,210
how our first requirement has been met.

486
00:21:36,210 --> 00:21:39,390
So now our VPCs are
compliant in that sense

487
00:21:39,390 --> 00:21:41,517
and they are able to
get the pool from IPAM

488
00:21:41,517 --> 00:21:43,710
and not being hard coded.

489
00:21:43,710 --> 00:21:46,500
So I think we can move to
the second requirement,

490
00:21:46,500 --> 00:21:50,400
which is an easy-to-build global network,

491
00:21:50,400 --> 00:21:52,020
and for that we have AWS Cloud WAN.

492
00:21:52,020 --> 00:21:53,640
But what we need to do there,

493
00:21:53,640 --> 00:21:55,470
we need to do all this,

494
00:21:55,470 --> 00:21:58,920
have inspection between routing domains,

495
00:21:58,920 --> 00:22:01,860
egress inspection, also between regions.

496
00:22:01,860 --> 00:22:03,270
If I have traffic between regions,

497
00:22:03,270 --> 00:22:04,933
I don't want to inspect in both regions.

498
00:22:04,933 --> 00:22:06,930
I only want to inspect in one,

499
00:22:06,930 --> 00:22:10,170
and the one in orange is
the region I want to inspect

500
00:22:10,170 --> 00:22:12,930
for every pair of regions that I have.

501
00:22:12,930 --> 00:22:15,090
And also I want to do something
quite cool in Cloud WAN,

502
00:22:15,090 --> 00:22:17,400
which is I want to automate

503
00:22:17,400 --> 00:22:20,250
how the attachments get associated

504
00:22:20,250 --> 00:22:22,470
to the routing domain automatically.

505
00:22:22,470 --> 00:22:24,080
So basically the logic I want to apply

506
00:22:24,080 --> 00:22:26,640
is that VPC attachments are associated

507
00:22:26,640 --> 00:22:29,460
to their OU routing domain

508
00:22:29,460 --> 00:22:31,080
and anything that is hybrid,

509
00:22:31,080 --> 00:22:32,820
so VPNs, connect attachments,

510
00:22:32,820 --> 00:22:35,010
so to integrate SD-WAN networks

511
00:22:35,010 --> 00:22:38,550
and Direct Connect are
associated to the hybrid segment.

512
00:22:38,550 --> 00:22:41,408
So that's what I'm going to be doing now.

513
00:22:41,408 --> 00:22:45,573
I'm using policy as code in Cloud WAN.

514
00:22:47,070 --> 00:22:48,120
- [Claudia] Perfect.

515
00:22:48,120 --> 00:22:51,600
So something really important
that you are going to see

516
00:22:51,600 --> 00:22:55,050
now that Pablo's going to code that part,

517
00:22:55,050 --> 00:22:57,330
it's that he's going
to work with something

518
00:22:57,330 --> 00:23:00,420
that it's sent to and sent via.

519
00:23:00,420 --> 00:23:03,330
It's, like, the main part of the coding

520
00:23:03,330 --> 00:23:05,130
with AWS Cloud WAN.

521
00:23:05,130 --> 00:23:09,337
Sent to, it's used when you want to know

522
00:23:10,890 --> 00:23:14,160
what the network traffic it's going to end

523
00:23:14,160 --> 00:23:18,180
and sent via is when you
want the network traffic to,

524
00:23:18,180 --> 00:23:20,010
before reaching the end,

525
00:23:20,010 --> 00:23:23,250
to pass in the mid part

526
00:23:23,250 --> 00:23:26,790
before going into the final destination.

527
00:23:26,790 --> 00:23:29,880
So, for example, sent to is like,

528
00:23:29,880 --> 00:23:33,750
hey, it's going to the final destination,

529
00:23:33,750 --> 00:23:36,357
it's on premises or the internet,

530
00:23:36,357 --> 00:23:37,920
and send via is,

531
00:23:37,920 --> 00:23:42,920
hey, but before reaching
the final destination,

532
00:23:42,960 --> 00:23:45,030
go through this part.

533
00:23:45,030 --> 00:23:50,030
And usually as the architecture
that we are working in here,

534
00:23:50,070 --> 00:23:53,310
it's AWS Network Firewall

535
00:23:53,310 --> 00:23:55,190
and inspection Amazon VPC

536
00:23:55,190 --> 00:23:58,110
or a third-party solution for security.

537
00:23:58,110 --> 00:24:02,280
So the, for example,
you have an Amazon VPC

538
00:24:02,280 --> 00:24:03,810
that wants to reach the internet,

539
00:24:03,810 --> 00:24:06,900
and it's like, okay send to internet,

540
00:24:06,900 --> 00:24:11,250
but send via to AWS Network Firewall

541
00:24:11,250 --> 00:24:13,410
or send to Amazon VPC

542
00:24:13,410 --> 00:24:16,950
but send via AWS Network Firewall

543
00:24:16,950 --> 00:24:20,760
so you can deploy the finish

544
00:24:20,760 --> 00:24:24,900
or the end of the network
traffic but also the mid part

545
00:24:24,900 --> 00:24:29,100
before reaching that final destination.

546
00:24:29,100 --> 00:24:31,350
So back to you, Pablo.

547
00:24:31,350 --> 00:24:34,932
- [Pablo] Yeah, so give me a moment

548
00:24:34,932 --> 00:24:39,703
so I don't lose what I'm doing.

549
00:24:39,703 --> 00:24:40,950
So you see that I'm doing something weird

550
00:24:40,950 --> 00:24:42,660
that it's kind of this dynamic block.

551
00:24:42,660 --> 00:24:44,970
So if you have not worked with Terraform,

552
00:24:44,970 --> 00:24:47,070
this is just a way for me

553
00:24:47,070 --> 00:24:49,443
to create dynamically different blocks.

554
00:24:50,820 --> 00:24:51,683
Cloud WAN uses JSON,

555
00:24:51,683 --> 00:24:55,440
but in Terraform to make
it more easy to build,

556
00:24:55,440 --> 00:24:57,360
we use what we call a data source

557
00:24:57,360 --> 00:24:59,700
that we do it in these specific blocks

558
00:24:59,700 --> 00:25:01,773
that then get translated to JSON.

559
00:25:04,657 --> 00:25:07,560
And then, like, because I need
to create the edge override,

560
00:25:07,560 --> 00:25:11,520
which is the way I'm telling
Cloud WAN between two regions,

561
00:25:11,520 --> 00:25:13,560
what is the region I want to use?

562
00:25:13,560 --> 00:25:16,470
What I did is define that logic outside

563
00:25:16,470 --> 00:25:18,390
of the policy document definition,

564
00:25:18,390 --> 00:25:20,400
kind of like creating a variable

565
00:25:20,400 --> 00:25:25,400
and then just creating dynamically
that those blocks here.

566
00:25:25,500 --> 00:25:27,360
So if I need to do any changes,

567
00:25:27,360 --> 00:25:29,670
I don't need to go to the
definition of the policy document.

568
00:25:29,670 --> 00:25:33,810
I can go to my variable,
local variable, do the change,

569
00:25:33,810 --> 00:25:37,560
and then anytime I deploy
again the policy document,

570
00:25:37,560 --> 00:25:39,810
I will get that updated.

571
00:25:39,810 --> 00:25:43,473
So now let me continue
with the next block,

572
00:25:44,490 --> 00:25:47,010
because we did from prod to dev and hybrid

573
00:25:47,010 --> 00:25:50,520
and we missed dev to hybrid.

574
00:25:50,520 --> 00:25:52,230
And now the last thing I need to do

575
00:25:52,230 --> 00:25:53,910
is the attachment policy.

576
00:25:53,910 --> 00:25:56,280
So I already have one attachment policy

577
00:25:56,280 --> 00:26:01,280
which is getting the tag
value of the attachment,

578
00:26:02,670 --> 00:26:05,100
and if the tag is inspection equal true,

579
00:26:05,100 --> 00:26:07,230
that means that it's an inspection VPC

580
00:26:07,230 --> 00:26:08,430
because the inspection VPCs

581
00:26:08,430 --> 00:26:10,500
I have already connected to Cloud WAN.

582
00:26:10,500 --> 00:26:13,530
And now I'm going to do two
more attachment policies,

583
00:26:13,530 --> 00:26:15,270
one based on the tag

584
00:26:15,270 --> 00:26:18,930
and another one based on
the type of attachment.

585
00:26:18,930 --> 00:26:21,520
So give me a moment
that I finish that piece

586
00:26:22,650 --> 00:26:23,970
- [Claudia] Of course.

587
00:26:23,970 --> 00:26:28,234
So what you can see here is that basically

588
00:26:28,234 --> 00:26:31,380
AWS Cloud WAN works with segments.

589
00:26:31,380 --> 00:26:35,490
These segments can be across regions.

590
00:26:35,490 --> 00:26:38,910
And we are having dev
segment, prod segment,

591
00:26:38,910 --> 00:26:43,715
and the security segment
with AWS Network Firewall.

592
00:26:43,715 --> 00:26:44,548
Yeah.

593
00:26:44,548 --> 00:26:48,270
- [Audience Member] If you
were to automate this in GenAI,

594
00:26:48,270 --> 00:26:50,041
what tool would you use?

595
00:26:50,041 --> 00:26:52,291
I mean Amazon Q can do this

596
00:26:53,514 --> 00:26:54,931
or Kiro also has-

597
00:26:56,220 --> 00:26:57,840
- [Claudia] Yeah, the question in here is

598
00:26:57,840 --> 00:27:02,100
how to automate this
even more using GenAI.

599
00:27:02,100 --> 00:27:05,730
And yup, you can work with Kiro

600
00:27:05,730 --> 00:27:08,640
or you can work with Amazon Q Developer.

601
00:27:08,640 --> 00:27:12,060
Remember the Amazon Q
Developer advise you, like,

602
00:27:12,060 --> 00:27:13,950
the next slide to write.

603
00:27:13,950 --> 00:27:17,970
It works also with AWS Cloud, mm-hmm.

604
00:27:17,970 --> 00:27:18,803
Yeah.

605
00:27:23,490 --> 00:27:28,050
So the other thing that we
are really excited with Pablo,

606
00:27:28,050 --> 00:27:32,340
it's that we just got announced
a couple of weeks ago,

607
00:27:32,340 --> 00:27:35,280
I don't know if somebody saw it,

608
00:27:35,280 --> 00:27:40,280
that we are now having advanced
routing with AWS Cloud WAN.

609
00:27:40,530 --> 00:27:45,530
Advanced routing, it's a
new function where, like,

610
00:27:47,340 --> 00:27:49,380
you know, like, adding many routes,

611
00:27:49,380 --> 00:27:53,970
like, 100 routes, 1,000 routes,

612
00:27:53,970 --> 00:27:57,180
like, every day of the network engineers.

613
00:27:57,180 --> 00:27:59,220
So the idea with advanced routing is

614
00:27:59,220 --> 00:28:01,170
you can add now filters.

615
00:28:01,170 --> 00:28:05,100
You can now, like, inbound
filter, outbound filter,

616
00:28:05,100 --> 00:28:06,990
you can summarize route,

617
00:28:06,990 --> 00:28:10,500
you can use BGP attributes, BGP metrics.

618
00:28:10,500 --> 00:28:12,180
So you can add that.

619
00:28:12,180 --> 00:28:15,630
So this can just to
make easier the routing

620
00:28:15,630 --> 00:28:16,680
and your route tables.

621
00:28:16,680 --> 00:28:19,530
So it's freshly baked,

622
00:28:19,530 --> 00:28:22,500
so if you start implementing AWS Cloud WAN

623
00:28:22,500 --> 00:28:25,893
also can take advantage
of this new feature.

624
00:28:26,850 --> 00:28:29,010
So back to you, Pablo.

625
00:28:29,010 --> 00:28:31,950
- [Pablo] Yeah, so we have already created

626
00:28:31,950 --> 00:28:33,720
the new version of the policy document.

627
00:28:33,720 --> 00:28:37,050
Let me go to the console so I
can show you how that works.

628
00:28:37,050 --> 00:28:39,510
So this is the AWS Network Manager console

629
00:28:39,510 --> 00:28:41,190
where Cloud WAN lives.

630
00:28:41,190 --> 00:28:42,240
If you have transit cases,

631
00:28:42,240 --> 00:28:43,470
you can also take advantage

632
00:28:43,470 --> 00:28:46,470
of these Network Manager capabilities

633
00:28:46,470 --> 00:28:49,140
by just importing the transit cases.

634
00:28:49,140 --> 00:28:52,140
But in Cloud WAN, it works natively.

635
00:28:52,140 --> 00:28:57,140
So you see that my policy
version, it's the 15th.

636
00:28:57,500 --> 00:28:59,943
So we did a lot of dry
runs before this session.

637
00:29:01,110 --> 00:29:04,230
That I have two different kind of aliases

638
00:29:04,230 --> 00:29:05,490
when I'm doing some changes.

639
00:29:05,490 --> 00:29:07,320
I have my live policy,

640
00:29:07,320 --> 00:29:10,260
which is the one that
is currently deployed,

641
00:29:10,260 --> 00:29:15,260
the one without notice attachment,
the attachment policies,

642
00:29:15,420 --> 00:29:17,610
the service insertion,
routing, and everything.

643
00:29:17,610 --> 00:29:18,480
And then the new version,

644
00:29:18,480 --> 00:29:21,120
which is the one we have just created.

645
00:29:21,120 --> 00:29:23,190
That is going to take some time to deploy

646
00:29:23,190 --> 00:29:24,450
and once its it's deployed,

647
00:29:24,450 --> 00:29:27,480
it will move to the live version of it.

648
00:29:27,480 --> 00:29:28,440
It will take some time,

649
00:29:28,440 --> 00:29:32,520
so of course, like, maybe it's
time for some questions or...

650
00:29:32,520 --> 00:29:37,520
And also maybe we can
move to the next section

651
00:29:37,642 --> 00:29:38,850
if it takes longer,

652
00:29:38,850 --> 00:29:41,100
because usually it can take longer

653
00:29:41,100 --> 00:29:42,360
if it's adding new region,

654
00:29:42,360 --> 00:29:45,030
removing region can take some minutes.

655
00:29:45,030 --> 00:29:49,320
Now that we are just
creating some routing,

656
00:29:49,320 --> 00:29:50,550
maybe it doesn't take that much.

657
00:29:50,550 --> 00:29:52,110
And also you see that

658
00:29:52,110 --> 00:29:54,900
what I have already created are my three

659
00:29:54,900 --> 00:29:59,700
inspection VPCs attached
to the network function

660
00:29:59,700 --> 00:30:00,810
group inspection VPC.

661
00:30:00,810 --> 00:30:03,180
So that piece is already there.

662
00:30:03,180 --> 00:30:06,540
So now we can just create
those specific routing.

663
00:30:06,540 --> 00:30:09,240
So it's already been deploying everything

664
00:30:09,240 --> 00:30:11,760
so it's telling you which actions apply.

665
00:30:11,760 --> 00:30:14,700
The attachment policies are
just applied automatically now.

666
00:30:14,700 --> 00:30:17,973
It's going to be creating
all the static routes.

667
00:30:19,200 --> 00:30:21,060
Do we have any questions?

668
00:30:21,060 --> 00:30:23,760
- [Claudia] Yes, I just have one in here,

669
00:30:23,760 --> 00:30:28,760
and that is if someone has
permissions in the account level,

670
00:30:29,220 --> 00:30:33,840
can they, like, bypass the
service control policy,

671
00:30:33,840 --> 00:30:35,760
and the answer, it's no.

672
00:30:35,760 --> 00:30:36,744
- [Pablo] Yeah.

673
00:30:36,744 --> 00:30:40,050
- [Claudia] Service control
policy will always be up

674
00:30:40,050 --> 00:30:44,778
or over the account level
permission that you have.

675
00:30:44,778 --> 00:30:45,611
- [Pablo] Yeah, exactly.

676
00:30:45,611 --> 00:30:48,204
And there was a question over there?

677
00:30:48,204 --> 00:30:49,773
- [Audience Member] So
you defined where all the,

678
00:30:49,773 --> 00:30:51,832
what regions are your inspection VPCs,

679
00:30:51,832 --> 00:30:52,680
what they look like,

680
00:30:52,680 --> 00:30:55,113
and did you also tell it
whether you're inspecting

681
00:30:55,113 --> 00:30:58,050
on both the source and destination region

682
00:30:58,050 --> 00:30:59,280
or just one of them?

683
00:30:59,280 --> 00:31:00,510
Is that part of it?

684
00:31:00,510 --> 00:31:01,343
- [Pablo] Can you repeat that?

685
00:31:01,343 --> 00:31:02,273
I didn't hear the question.

686
00:31:02,273 --> 00:31:04,557
- [Claudia] If you are
inspecting both source

687
00:31:04,557 --> 00:31:05,458
and destination region-

688
00:31:05,458 --> 00:31:06,291
- [Pablo] Yes.

689
00:31:06,291 --> 00:31:08,280
So in service insertion, when you say,

690
00:31:08,280 --> 00:31:10,383
so let me come back to the definition.

691
00:31:11,850 --> 00:31:15,210
So when you say where I have it here,

692
00:31:15,210 --> 00:31:19,650
like, dev to hybrid also is hybrid to dev.

693
00:31:19,650 --> 00:31:21,390
So it's bidirectional when you do it.

694
00:31:21,390 --> 00:31:24,338
So it's going to be between
source and destination, yeah.

695
00:31:24,338 --> 00:31:25,218
- [Audience Member]
Right, but if you're going

696
00:31:25,218 --> 00:31:26,703
from us-east-1 to us-east-2

697
00:31:26,703 --> 00:31:27,960
and you want to inspect (indistinct).

698
00:31:27,960 --> 00:31:30,690
- [Pablo] Yeah, so now
that's where I define that,

699
00:31:30,690 --> 00:31:33,090
for example, between us-east-1

700
00:31:33,090 --> 00:31:34,590
and eu-south-2, so Spain,

701
00:31:34,590 --> 00:31:38,430
I'm saying that I only want
inspecting US in North Virginia.

702
00:31:38,430 --> 00:31:42,300
I can say by defining here dual hop

703
00:31:42,300 --> 00:31:44,850
that I want to be inspecting
in the two, in both.

704
00:31:44,850 --> 00:31:46,980
But in that case we're doing single hop

705
00:31:46,980 --> 00:31:48,663
for the sake of the example.

706
00:31:51,030 --> 00:31:51,863
Cool.

707
00:31:53,100 --> 00:31:57,240
Then while we create AWS Cloud WAN,

708
00:31:57,240 --> 00:31:59,850
I think we can move to
the third requirement,

709
00:31:59,850 --> 00:32:01,620
and then, of course,

710
00:32:01,620 --> 00:32:04,860
we have everything connected together.

711
00:32:04,860 --> 00:32:09,860
Okay, so what have we created so far?

712
00:32:10,890 --> 00:32:13,650
So basically we have all this.

713
00:32:13,650 --> 00:32:15,761
We have the inspection
between routing domains,

714
00:32:15,761 --> 00:32:16,980
we have the egress inspection,

715
00:32:16,980 --> 00:32:20,460
we have the cross-region and
the attachment automation.

716
00:32:20,460 --> 00:32:23,650
Do you think that we have
met all these requirements

717
00:32:25,140 --> 00:32:26,523
or are we missing anything?

718
00:32:30,210 --> 00:32:32,610
- [Claudia] I think we're
missing something, Pablo.

719
00:32:32,610 --> 00:32:33,491
- [Pablo] Hmm?

720
00:32:33,491 --> 00:32:35,160
(audience member speaking off mic)

721
00:32:35,160 --> 00:32:40,050
Yes, so thing is I, we can do it.

722
00:32:40,050 --> 00:32:42,600
So we can meet that one easily

723
00:32:42,600 --> 00:32:44,550
by just simply saying to everyone,

724
00:32:44,550 --> 00:32:49,550
hey, put your OU tag
when you connect your VPC

725
00:32:51,180 --> 00:32:53,820
or doing in the account factoring
that we mentioned before,

726
00:32:53,820 --> 00:32:56,280
doing it by default that
they don't need to do it.

727
00:32:56,280 --> 00:33:00,363
But what if someone puts the
wrong value of the tag domain?

728
00:33:01,590 --> 00:33:03,000
They may be connecting to hybrid.

729
00:33:03,000 --> 00:33:04,260
They may be connecting to prod.

730
00:33:04,260 --> 00:33:07,860
So still we need for our
use case or requirement of,

731
00:33:07,860 --> 00:33:12,860
I want to make sure that new
VPCs go to the right segment

732
00:33:14,310 --> 00:33:17,250
and the way we define the policy document,

733
00:33:17,250 --> 00:33:20,250
we need a little bit of extra help to make

734
00:33:20,250 --> 00:33:22,890
that requirement to be met.

735
00:33:22,890 --> 00:33:25,440
And that's how we're going
to enforce routing domains

736
00:33:25,440 --> 00:33:27,765
from OU using, again,

737
00:33:27,765 --> 00:33:32,163
AWS Organizations and AWS Step Functions.

738
00:33:33,240 --> 00:33:35,370
So as we did with the VPCs,

739
00:33:35,370 --> 00:33:38,220
we're going to create another
service control policy

740
00:33:38,220 --> 00:33:39,810
for the spoke OU

741
00:33:39,810 --> 00:33:42,270
and the spoke accounts
that they won't be able

742
00:33:42,270 --> 00:33:44,613
to create the tag domain.

743
00:33:45,540 --> 00:33:48,180
It will be created from
the networking account.

744
00:33:48,180 --> 00:33:50,457
So they can create any
tags in the attachment,

745
00:33:50,457 --> 00:33:51,690
but not the tag domain

746
00:33:51,690 --> 00:33:53,340
because that's the one that defines

747
00:33:53,340 --> 00:33:55,440
in which segment they're connecting

748
00:33:55,440 --> 00:33:58,770
and we want to do it from
the networking accounts.

749
00:33:58,770 --> 00:34:01,230
Once we do that, that's
going to be denied,

750
00:34:01,230 --> 00:34:03,450
so they're going to be
creating the attachment

751
00:34:03,450 --> 00:34:05,490
to nowhere in Cloud WAN.

752
00:34:05,490 --> 00:34:08,370
So it's just an attachment
without any association.

753
00:34:08,370 --> 00:34:11,400
And now what we're doing is
as part of Network Manager,

754
00:34:11,400 --> 00:34:12,480
we have the capability

755
00:34:12,480 --> 00:34:15,093
to get events from changes in the network.

756
00:34:16,200 --> 00:34:20,850
AWS Network Manager events
are sent to EventBridge.

757
00:34:20,850 --> 00:34:22,470
I'm showing there Oregon,

758
00:34:22,470 --> 00:34:23,700
and why I'm showing Oregon,

759
00:34:23,700 --> 00:34:27,420
because the home region of AWS Cloud WAN

760
00:34:27,420 --> 00:34:30,570
where their control
plane resides is Oregon,

761
00:34:30,570 --> 00:34:32,095
so all the metrics

762
00:34:32,095 --> 00:34:35,820
and the events are going to
be populated into that region.

763
00:34:35,820 --> 00:34:38,370
So our even breach is going
to catch those events.

764
00:34:38,370 --> 00:34:39,930
We are going to filter

765
00:34:39,930 --> 00:34:42,150
by only new VPC attachments.

766
00:34:42,150 --> 00:34:45,420
I don't want to get much
events, only those ones.

767
00:34:45,420 --> 00:34:47,430
And I'm going to send
it to a Step Functions

768
00:34:47,430 --> 00:34:49,710
to do this logic.

769
00:34:49,710 --> 00:34:51,510
Wait for the VPC attachment creation.

770
00:34:51,510 --> 00:34:52,980
That most likely is just, like,

771
00:34:52,980 --> 00:34:56,400
a measure to make sure that
we don't start doing the logic

772
00:34:56,400 --> 00:34:58,380
before the attachment is created.

773
00:34:58,380 --> 00:35:03,380
I'm going to obtain the OU
information from the account ID

774
00:35:03,570 --> 00:35:06,270
because that's metadata
that I get from the event

775
00:35:06,270 --> 00:35:08,280
and I'm going to create the tag

776
00:35:08,280 --> 00:35:10,410
from the networking account.

777
00:35:10,410 --> 00:35:13,530
So we will see how after
the attachment is created,

778
00:35:13,530 --> 00:35:15,810
it changes from no segment

779
00:35:15,810 --> 00:35:20,070
to the segment we want to be connecting.

780
00:35:20,070 --> 00:35:22,533
So that's what we're
going to do right now.

781
00:35:24,810 --> 00:35:25,643
- [Claudia] Perfect.

782
00:35:25,643 --> 00:35:27,660
So we had a question back there,

783
00:35:27,660 --> 00:35:30,540
and I'm going to move now for that one,

784
00:35:30,540 --> 00:35:35,540
that the thing in here is just
we are using AWS Cloud WAN

785
00:35:35,970 --> 00:35:37,950
to deploy the network,

786
00:35:37,950 --> 00:35:40,800
but service control policy is the one

787
00:35:40,800 --> 00:35:45,363
that is helping us from someone
to not deploying the things

788
00:35:45,363 --> 00:35:46,920
that we don't want as,

789
00:35:46,920 --> 00:35:50,373
Pablo and I, as the network
specialists, to be deployed.

790
00:35:51,690 --> 00:35:54,870
So yeah, as you saw the beginning,

791
00:35:54,870 --> 00:35:57,330
there was only IPAM and
service control policies.

792
00:35:57,330 --> 00:36:00,520
There were no AWS Cloud
WAN just to show you that

793
00:36:01,620 --> 00:36:05,280
you cannot, like, bypass
service control policy

794
00:36:05,280 --> 00:36:08,340
or deploy other IP addresses
that are not allowed.

795
00:36:08,340 --> 00:36:10,143
But it's not because our IPAM

796
00:36:10,143 --> 00:36:12,813
or AWS Cloud WAN is for
service control policies.

797
00:36:13,950 --> 00:36:17,230
And I think we had
another question in here.

798
00:36:18,091 --> 00:36:19,332
What was the question?

799
00:36:19,332 --> 00:36:20,471
- [Audience Member] Yeah, the testing.

800
00:36:20,471 --> 00:36:21,660
- [Claudia] Okay, can you repeat that?

801
00:36:21,660 --> 00:36:22,493
- [Audience Member] Yes.

802
00:36:22,493 --> 00:36:26,100
So once we create the new
policy for Cloud WAN, right,

803
00:36:26,100 --> 00:36:27,533
it's generated and we see, you know,

804
00:36:27,533 --> 00:36:30,150
we have a latest one and
we have a current one.

805
00:36:30,150 --> 00:36:32,100
Is there a way to test connectivity

806
00:36:32,100 --> 00:36:33,317
before finally applying it

807
00:36:33,317 --> 00:36:36,360
and if it fails to go to previous version?

808
00:36:36,360 --> 00:36:38,970
- [Pablo] So currently we
don't have that option.

809
00:36:38,970 --> 00:36:42,660
So you can, of course, when
you create the new policy,

810
00:36:42,660 --> 00:36:45,942
you can check what is
changing before you...

811
00:36:45,942 --> 00:36:47,390
From Terraform or CloudFormation,

812
00:36:47,390 --> 00:36:50,310
it will do the approval automatically

813
00:36:50,310 --> 00:36:54,780
to not break the infrastructure
as code way of working.

814
00:36:54,780 --> 00:36:56,580
But if you do it from the console,

815
00:36:56,580 --> 00:36:58,320
you can, of course, check what it's doing

816
00:36:58,320 --> 00:37:00,390
and see if there's any destroy action.

817
00:37:00,390 --> 00:37:03,420
Currently we don't have the
way to test that before live.

818
00:37:03,420 --> 00:37:08,310
What we have created
recently is cloud on MCP

819
00:37:08,310 --> 00:37:10,320
that kind of helps you
with different tools,

820
00:37:10,320 --> 00:37:15,120
how to quickly check if
the routing is happening

821
00:37:15,120 --> 00:37:16,980
once you have it in live,

822
00:37:16,980 --> 00:37:18,540
that policy document.

823
00:37:18,540 --> 00:37:20,250
And then, of course,
you can always roll back

824
00:37:20,250 --> 00:37:23,496
to previous options if you don't, so...

825
00:37:23,496 --> 00:37:28,200
(audience member speaking off mic)

826
00:37:28,200 --> 00:37:31,206
Yeah, so you can use
Reachability Analyzer-

827
00:37:31,206 --> 00:37:35,456
(audience member speaking off mic)

828
00:37:38,896 --> 00:37:40,830
Yeah, yeah, so we are, exactly,

829
00:37:40,830 --> 00:37:42,900
so those tools are the ones used,

830
00:37:42,900 --> 00:37:45,720
but then you need the
coordinator policy already live.

831
00:37:45,720 --> 00:37:48,720
So we're, of course, working to ways,

832
00:37:48,720 --> 00:37:50,220
because feedback is also, like,

833
00:37:50,220 --> 00:37:54,870
I may want to check this
before I have it created,

834
00:37:54,870 --> 00:37:56,070
so we're working on that,

835
00:37:56,070 --> 00:37:57,720
but for now it needs to be live.

836
00:37:57,720 --> 00:37:59,790
Then, of course, use tools

837
00:37:59,790 --> 00:38:01,950
to understand if the
network is properly defined,

838
00:38:01,950 --> 00:38:03,840
but if not, you can quickly roll back

839
00:38:03,840 --> 00:38:06,660
to the previous version
of the policy via API

840
00:38:06,660 --> 00:38:10,320
or via the console and then
continue with your deployment.

841
00:38:10,320 --> 00:38:12,960
So let me go quick to the
service control policy

842
00:38:12,960 --> 00:38:15,420
that I'm going to let create

843
00:38:15,420 --> 00:38:18,450
while I'm explaining everything.

844
00:38:18,450 --> 00:38:22,500
So what I'm doing is
I'm denying the creation

845
00:38:22,500 --> 00:38:25,050
of any VPC attachment

846
00:38:25,050 --> 00:38:27,603
if there's this domain,

847
00:38:28,710 --> 00:38:30,330
there's this domain key,

848
00:38:30,330 --> 00:38:33,000
and of course, denying
any tag modification.

849
00:38:33,000 --> 00:38:34,410
So I'm not allowing anyone

850
00:38:34,410 --> 00:38:37,380
to change the domain
tag once it's created.

851
00:38:37,380 --> 00:38:42,000
So I'm doing that at the dev OU level.

852
00:38:42,000 --> 00:38:45,150
And now I'm going to be
building the automation.

853
00:38:45,150 --> 00:38:47,160
I'm going to cheating
on the automation side

854
00:38:47,160 --> 00:38:51,120
because I have almost
created, I just, I'm going to,

855
00:38:51,120 --> 00:38:54,600
it's coded, I'm just going to uncomment it

856
00:38:54,600 --> 00:38:59,600
and we can discuss it
while it's getting built.

857
00:39:01,260 --> 00:39:04,950
So I'm creating this from
the networking account.

858
00:39:04,950 --> 00:39:08,040
Okay, so the automation, it's
what we mentioned before,

859
00:39:08,040 --> 00:39:09,630
the even bridge rule

860
00:39:09,630 --> 00:39:11,940
that is capturing only VPC attachments

861
00:39:11,940 --> 00:39:14,250
and capturing the Network Manager events,

862
00:39:14,250 --> 00:39:17,100
but only the ones who are
VPC attachment created.

863
00:39:17,100 --> 00:39:19,230
That's the only thing
that's important right now.

864
00:39:19,230 --> 00:39:22,200
And I'm sending this to Step Functions

865
00:39:22,200 --> 00:39:25,140
and to see exactly what I'm creating.

866
00:39:25,140 --> 00:39:26,820
A step function is always better

867
00:39:26,820 --> 00:39:29,850
to check it from the console.

868
00:39:29,850 --> 00:39:31,443
You have a better UI.

869
00:39:34,710 --> 00:39:38,310
And yes, if I go to my state
machine, to the definition,

870
00:39:38,310 --> 00:39:39,330
so it's here.

871
00:39:39,330 --> 00:39:40,713
Let me make it bigger.

872
00:39:41,850 --> 00:39:43,170
That's what we are doing.

873
00:39:43,170 --> 00:39:45,900
So we are getting the VPC attachment

874
00:39:45,900 --> 00:39:49,710
just to first check if
the attachment is created.

875
00:39:49,710 --> 00:39:52,650
Majority of the times is
going to be created already,

876
00:39:52,650 --> 00:39:55,020
just kind of like a safety measure.

877
00:39:55,020 --> 00:39:57,750
And then I'm obtaining
the organizational unit

878
00:39:57,750 --> 00:40:00,030
from the account ID,

879
00:40:00,030 --> 00:40:04,140
getting the domain from that OU.

880
00:40:04,140 --> 00:40:06,120
So in that case we're making it simpler

881
00:40:06,120 --> 00:40:11,040
because the OU name is the name
of the segment in Cloud WAN.

882
00:40:11,040 --> 00:40:13,797
But here this step is maybe
if you have extra logic that,

883
00:40:13,797 --> 00:40:16,680
okay, OU means non-prod,

884
00:40:16,680 --> 00:40:18,990
to add an extra logic in the step.

885
00:40:18,990 --> 00:40:21,330
And then we're creating
the tag in Cloud WAN.

886
00:40:21,330 --> 00:40:25,620
So basically our three,
four steps that allows us

887
00:40:25,620 --> 00:40:30,620
to get this extra logic
into AWS Cloud WAN.

888
00:40:32,130 --> 00:40:35,103
So yeah, so with that, perfect.

889
00:40:38,190 --> 00:40:41,400
So with that we have built these

890
00:40:43,410 --> 00:40:46,350
or we have built those requirements

891
00:40:46,350 --> 00:40:49,320
applying the best practices
that we mentioned before, no?

892
00:40:49,320 --> 00:40:50,703
So with AWS Organizations,

893
00:40:50,703 --> 00:40:54,450
what we are doing is
not putting the efforts

894
00:40:54,450 --> 00:40:56,790
on blocking actions that
they shouldn't happen

895
00:40:56,790 --> 00:41:01,650
at the network level by just
simply, like, denying actions

896
00:41:01,650 --> 00:41:04,200
or putting a firewall when we need to

897
00:41:04,200 --> 00:41:06,253
or just to thinking that, okay,

898
00:41:06,253 --> 00:41:09,150
I don't trust anyone so I
will kind of own everything.

899
00:41:09,150 --> 00:41:10,500
Now what we're doing is creating

900
00:41:10,500 --> 00:41:13,920
those guardrails in
organizations so it's okay,

901
00:41:13,920 --> 00:41:16,170
no one is going to put a CIDR block

902
00:41:16,170 --> 00:41:17,460
that it shouldn't be or it can be...

903
00:41:17,460 --> 00:41:20,340
No one is going to put in
their VPC in that gateway,

904
00:41:20,340 --> 00:41:23,760
so I don't need to just freak out if...

905
00:41:23,760 --> 00:41:26,027
Or not allowing them
to do specific actions.

906
00:41:26,027 --> 00:41:27,840
I know that they cannot
put in that gateway.

907
00:41:27,840 --> 00:41:31,800
So yeah, go free and work with your VPC

908
00:41:31,800 --> 00:41:33,120
because it's your workload,

909
00:41:33,120 --> 00:41:36,690
so you should also work with
your own network for that.

910
00:41:36,690 --> 00:41:37,523
Then with Cloud WAN,

911
00:41:37,523 --> 00:41:41,130
we built a global network
in three AWS regions

912
00:41:41,130 --> 00:41:43,710
with less than 50 lines of code, no?

913
00:41:43,710 --> 00:41:47,070
So we will see later how VPCs
will automatically connect

914
00:41:47,070 --> 00:41:51,300
and the routing will be
created automatically.

915
00:41:51,300 --> 00:41:53,850
And then finally, we had a step function.

916
00:41:53,850 --> 00:41:56,650
So we had this ad hoc requirement

917
00:41:58,181 --> 00:42:00,780
that we needed to build some
automation in top of that

918
00:42:00,780 --> 00:42:03,300
and then we used five states to ensure

919
00:42:03,300 --> 00:42:06,450
that VPCs are only being associated

920
00:42:06,450 --> 00:42:09,360
to their corresponding segment.

921
00:42:09,360 --> 00:42:11,913
So now let's go and try it out.

922
00:42:14,430 --> 00:42:17,340
We're going to finish the
definition of our three VPCs.

923
00:42:17,340 --> 00:42:19,680
We have a data center.

924
00:42:19,680 --> 00:42:21,125
Well, it's A VPC in Paris

925
00:42:21,125 --> 00:42:22,860
that is going to mimic a data center.

926
00:42:22,860 --> 00:42:24,540
And we are going to do a VPN

927
00:42:24,540 --> 00:42:28,350
and we're going to see
how the site-to-site VPN

928
00:42:28,350 --> 00:42:31,110
is going to get connected
directly in the hybrid segment

929
00:42:31,110 --> 00:42:33,703
and our spokes VPCs are
going to first create

930
00:42:33,703 --> 00:42:36,030
a node-to-node segment

931
00:42:36,030 --> 00:42:38,340
and then our automation
is going to kick in

932
00:42:38,340 --> 00:42:42,030
and move them to the routing domain.

933
00:42:42,030 --> 00:42:45,150
And then we're going to show
how the automation works

934
00:42:45,150 --> 00:42:47,490
and get some more

935
00:42:47,490 --> 00:42:50,700
and show you more about the
configuration on Cloud WAN

936
00:42:50,700 --> 00:42:53,580
before we finish the session.

937
00:42:53,580 --> 00:42:56,943
So yeah, so let me come
back to the coding piece.

938
00:43:00,930 --> 00:43:02,610
- [Claudia] Yeah, so in here you can see

939
00:43:02,610 --> 00:43:07,610
that we have been working
mostly with Amazon VPCs,

940
00:43:08,340 --> 00:43:12,882
but AWS Cloud WAN can
work with Amazon VPCs,

941
00:43:12,882 --> 00:43:17,250
AWS site-to-site VPN, AWS Direct Connect.

942
00:43:17,250 --> 00:43:21,600
It can peer with AWS Transit Gateway,

943
00:43:21,600 --> 00:43:24,600
also with AWS Transit Gateway Connect

944
00:43:24,600 --> 00:43:28,110
that it's the solution
to work with SD-WAN.

945
00:43:28,110 --> 00:43:33,110
So in here is that you can
work with AWS Cloud WAN

946
00:43:33,390 --> 00:43:34,917
not only with Amazon VPC,

947
00:43:34,917 --> 00:43:38,577
but also to help you deploying the routing

948
00:43:38,577 --> 00:43:43,290
and everything that you need
for the hybrid connections

949
00:43:43,290 --> 00:43:47,793
that it's pretty usual
for many of our customers.

950
00:43:49,170 --> 00:43:51,573
- [Pablo] Yeah, so right
now what I'm doing is,

951
00:43:52,410 --> 00:43:55,650
as part of the VPC module,

952
00:43:55,650 --> 00:43:59,040
the way to create the core
network attachment is to define,

953
00:43:59,040 --> 00:44:02,097
okay, this is my core
network that was created

954
00:44:02,097 --> 00:44:04,860
and that's why I have a local variable

955
00:44:04,860 --> 00:44:06,990
because I'm checking that ID

956
00:44:06,990 --> 00:44:11,340
or that ARN from AWS RAM,

957
00:44:11,340 --> 00:44:13,200
and here I'm putting just the routes.

958
00:44:13,200 --> 00:44:15,480
So basically I'm sending any IPv4 traffic

959
00:44:15,480 --> 00:44:20,130
or any IPv6 traffic to the
core network attachments.

960
00:44:20,130 --> 00:44:24,120
And the last thing I need to
do is to create the subnet

961
00:44:24,120 --> 00:44:28,800
where I'm going to be
placing that attachment,

962
00:44:28,800 --> 00:44:33,240
and I'm making it dual stack
by assigning an IPv6 block.

963
00:44:33,240 --> 00:44:37,110
And this is just part of the
configuration in the module.

964
00:44:37,110 --> 00:44:41,130
Just we're saying that it
doesn't require any acceptance

965
00:44:41,130 --> 00:44:45,090
because in Cloud WAN you can
also put some controls about

966
00:44:45,090 --> 00:44:47,010
do I want to accept the attachment

967
00:44:47,010 --> 00:44:51,153
before it automatically
connects to a segment or not?

968
00:44:51,153 --> 00:44:53,280
So I can add some manual value.

969
00:44:53,280 --> 00:44:54,390
In our case we didn't want to.

970
00:44:54,390 --> 00:44:56,872
That's why we built the
automation to control that.

971
00:44:56,872 --> 00:44:58,500
But if you don't want to
build that automation,

972
00:44:58,500 --> 00:45:00,000
you can add some manual control

973
00:45:00,000 --> 00:45:03,090
and just simply get notified
when you have a new VPC

974
00:45:03,090 --> 00:45:07,170
to check it and maybe to
approve the association.

975
00:45:07,170 --> 00:45:08,100
I'm cheating a little bit

976
00:45:08,100 --> 00:45:11,490
because I have already my private module

977
00:45:11,490 --> 00:45:13,300
just to create EC2 instances

978
00:45:14,163 --> 00:45:16,261
and some endpoints to connect to.

979
00:45:16,261 --> 00:45:17,550
I don't think we will have time today

980
00:45:17,550 --> 00:45:19,440
to show end-to-end connectivity,

981
00:45:19,440 --> 00:45:21,693
but just in case we have the time,

982
00:45:22,800 --> 00:45:25,980
we are building some EC2 instances.

983
00:45:25,980 --> 00:45:27,450
So now I'm going to do the same

984
00:45:27,450 --> 00:45:30,093
in the rest of the environment.

985
00:45:33,030 --> 00:45:35,193
Yeah. Any questions?

986
00:45:42,000 --> 00:45:42,833
Okay.

987
00:45:57,060 --> 00:45:57,963
Perfect.

988
00:46:00,390 --> 00:46:02,670
Okay, so that's on the spoke account.

989
00:46:02,670 --> 00:46:04,020
I already have everything.

990
00:46:04,020 --> 00:46:05,740
Let's make sure that

991
00:46:07,200 --> 00:46:09,750
I did not mess up something.

992
00:46:09,750 --> 00:46:11,190
- [Audience Member] Hey, is it possible

993
00:46:11,190 --> 00:46:13,622
to set up custom error messages for SCPs?

994
00:46:13,622 --> 00:46:16,647
- [Pablo] Yeah, I did some.

995
00:46:16,647 --> 00:46:19,314
I did... I know... Let me check.

996
00:46:20,650 --> 00:46:22,686
- [Claudia] Like, for the user?

997
00:46:22,686 --> 00:46:24,297
- [Audience Member] Yeah,
because we've avoided

998
00:46:24,297 --> 00:46:27,010
using SCPs for, like, tag enforcement

999
00:46:28,080 --> 00:46:30,180
out of fear that internal customers

1000
00:46:30,180 --> 00:46:31,455
won't understand why they're-

1001
00:46:31,455 --> 00:46:32,288
- [Pablo] I'm just doing a split,

1002
00:46:32,288 --> 00:46:34,620
so I need to take the second item,

1003
00:46:34,620 --> 00:46:36,690
which is the ID from the ARN.

1004
00:46:36,690 --> 00:46:39,690
That's what I'm doing in
this specific section.

1005
00:46:39,690 --> 00:46:43,530
So now it should give me everything.

1006
00:46:43,530 --> 00:46:44,520
What was the question there, Claudia?

1007
00:46:44,520 --> 00:46:47,580
- [Claudia] Yeah, we have the
question that if we can send

1008
00:46:47,580 --> 00:46:51,990
a message to customers that
they're getting blocked

1009
00:46:51,990 --> 00:46:53,430
by service control policy

1010
00:46:53,430 --> 00:46:55,650
because they usually don't understand why

1011
00:46:55,650 --> 00:46:58,920
they're getting blocked when
they try to do something

1012
00:46:58,920 --> 00:47:01,650
that service control
policy is not allowing

1013
00:47:01,650 --> 00:47:03,693
because it was configured that way.

1014
00:47:05,100 --> 00:47:06,150
- [Pablo] I don't know.

1015
00:47:06,150 --> 00:47:08,720
Maybe I will need to...

1016
00:47:10,530 --> 00:47:14,160
I have not, don't know if
that's possible or not.

1017
00:47:14,160 --> 00:47:15,990
Maybe we can take that later

1018
00:47:15,990 --> 00:47:18,780
and then do a little bit of
quick research if it's possible

1019
00:47:18,780 --> 00:47:22,050
or get you to the right
person to answer that.

1020
00:47:22,050 --> 00:47:23,010
But I don't know.

1021
00:47:23,010 --> 00:47:23,843
I don't know.

1022
00:47:26,097 --> 00:47:28,500
And then the last one
is on the on-prem side,

1023
00:47:28,500 --> 00:47:31,200
I have already created the VPN.

1024
00:47:31,200 --> 00:47:34,350
So I have my customer
gateway, my VPN connection,

1025
00:47:34,350 --> 00:47:36,030
and the only thing I'm
going to be creating

1026
00:47:36,030 --> 00:47:39,050
is the site-to-site VPN attachments.

1027
00:47:39,050 --> 00:47:40,983
So now once I create it,

1028
00:47:42,630 --> 00:47:47,630
I can move and show how
everything has been created

1029
00:47:51,428 --> 00:47:53,910
and just see how the different
automation is working

1030
00:47:53,910 --> 00:47:56,100
and how everything is getting
connected to Cloud WAN.

1031
00:47:56,100 --> 00:47:59,940
So let's, it's on the networking side,

1032
00:47:59,940 --> 00:48:02,520
so it's not creating anything?

1033
00:48:02,520 --> 00:48:04,823
Oh no, I need to be in
the on-prem mode, sorry.

1034
00:48:12,690 --> 00:48:15,180
So the on-prem, so the VPN,

1035
00:48:15,180 --> 00:48:17,430
even though I have
another Terraform estate,

1036
00:48:17,430 --> 00:48:20,040
I'm working kind of independently
for the on-prem side,

1037
00:48:20,040 --> 00:48:23,610
it's getting built in the
networking account that...

1038
00:48:23,610 --> 00:48:26,400
And this is why the
site-to-site VPN attachment

1039
00:48:26,400 --> 00:48:28,410
needs to be created,

1040
00:48:28,410 --> 00:48:31,520
the attachment, maybe, on
the VPN needs to be created

1041
00:48:31,520 --> 00:48:35,550
in the same account
where Cloud WAN resides.

1042
00:48:35,550 --> 00:48:40,550
That's kind of the same way it
works on the Transit Gateway.

1043
00:48:42,690 --> 00:48:47,690
So let's go to our console to
see that now we have our VPN

1044
00:48:48,780 --> 00:48:51,360
and the VPN already is getting associated

1045
00:48:51,360 --> 00:48:56,340
to the hybrid segment
thanks to the 300 policy

1046
00:48:56,340 --> 00:48:57,810
attachment policy configuration,

1047
00:48:57,810 --> 00:49:00,900
which is the one we can show
in now from the console.

1048
00:49:00,900 --> 00:49:04,380
So you can see how all
the logic and everything.

1049
00:49:04,380 --> 00:49:05,400
And now the VPCs,

1050
00:49:05,400 --> 00:49:09,210
for now they're just being
created without any segment.

1051
00:49:09,210 --> 00:49:11,040
We will come back to them,

1052
00:49:11,040 --> 00:49:14,310
to the attachments tab in a
moment to see how they moved.

1053
00:49:14,310 --> 00:49:17,130
Look at, for example, the one
in Spain already got created

1054
00:49:17,130 --> 00:49:19,950
and it's moving already
to the dev segment.

1055
00:49:19,950 --> 00:49:22,710
So now it's just pending
the network update

1056
00:49:22,710 --> 00:49:23,760
of the association

1057
00:49:23,760 --> 00:49:26,463
and the propagation in
that specific segment.

1058
00:49:27,690 --> 00:49:30,690
So before that, let's go
and check the policy version

1059
00:49:30,690 --> 00:49:33,270
and then we see kind of
how everything is working.

1060
00:49:33,270 --> 00:49:37,260
So even though we did that data source,

1061
00:49:37,260 --> 00:49:39,480
Cloud WAN works with JSON.

1062
00:49:39,480 --> 00:49:41,070
So what we did

1063
00:49:41,070 --> 00:49:44,670
or what it was already
created was the ASN ranges.

1064
00:49:44,670 --> 00:49:49,650
So (indistinct) in
Cloud WAN is using EBGP,

1065
00:49:49,650 --> 00:49:51,690
so we need to provide the range of ASNs

1066
00:49:51,690 --> 00:49:54,060
that we want in the regions,

1067
00:49:54,060 --> 00:49:55,890
then the edge locations in which regions

1068
00:49:55,890 --> 00:49:57,240
we want to create Cloud WAN.

1069
00:49:57,240 --> 00:49:59,730
So in that case, three regions only.

1070
00:49:59,730 --> 00:50:01,003
And then we have the attachment policies.

1071
00:50:01,003 --> 00:50:03,570
I already explained
this when we were doing

1072
00:50:03,570 --> 00:50:04,590
that part of the code.

1073
00:50:04,590 --> 00:50:08,550
But then the logic for the VPCs was,

1074
00:50:08,550 --> 00:50:13,550
hey, if the attachment type is a VPC

1075
00:50:14,160 --> 00:50:15,750
and also the tag domain exists.

1076
00:50:15,750 --> 00:50:16,590
I did a typo here.

1077
00:50:16,590 --> 00:50:17,670
This should have been an end.

1078
00:50:17,670 --> 00:50:21,330
We can even update it later in a moment.

1079
00:50:21,330 --> 00:50:23,460
If these two conditions are met,

1080
00:50:23,460 --> 00:50:27,090
I want you to put you in the two, like,

1081
00:50:27,090 --> 00:50:32,090
I want to put you in the
segment that has the same name

1082
00:50:32,880 --> 00:50:34,740
as the value of the tag domain.

1083
00:50:34,740 --> 00:50:37,440
So with this attachment policy,

1084
00:50:37,440 --> 00:50:40,950
I'm covering all the possible
use cases for my VPCs

1085
00:50:40,950 --> 00:50:45,150
if I do that logic of OU name segment

1086
00:50:45,150 --> 00:50:48,570
or your own logic that you
want to do in Cloud WAN.

1087
00:50:48,570 --> 00:50:49,680
And then the last one is,

1088
00:50:49,680 --> 00:50:53,190
hey, if any of these
attachments are connected,

1089
00:50:53,190 --> 00:50:56,040
so any site-to-site VPN connect attachment

1090
00:50:56,040 --> 00:50:57,510
or dark connect gateway,

1091
00:50:57,510 --> 00:50:59,370
I want you to put it in the hybrid segment

1092
00:50:59,370 --> 00:51:01,620
so I make sure that
anything that is hybrid

1093
00:51:01,620 --> 00:51:03,753
goes to that routing domain.

1094
00:51:04,740 --> 00:51:07,110
And then I configure my
network function group

1095
00:51:07,110 --> 00:51:09,210
for my inspection VPCs

1096
00:51:09,210 --> 00:51:12,570
and my three segments,
dev, hybrid, and prod.

1097
00:51:12,570 --> 00:51:13,920
We didn't use prod today,

1098
00:51:13,920 --> 00:51:16,950
but it's just to show you
as an example of how you can

1099
00:51:16,950 --> 00:51:20,610
create different
segmentation in Cloud WAN.

1100
00:51:20,610 --> 00:51:24,120
And then lastly, we have
the segment actions,

1101
00:51:24,120 --> 00:51:25,530
as we were mentioning before.

1102
00:51:25,530 --> 00:51:27,000
Now we have routing policies

1103
00:51:27,000 --> 00:51:29,190
to get you to more
advanced routing controls.

1104
00:51:29,190 --> 00:51:31,380
So filtering, summarization,

1105
00:51:31,380 --> 00:51:35,700
advanced BGP capabilities
like changing the as path,

1106
00:51:35,700 --> 00:51:37,170
changing the local pref

1107
00:51:37,170 --> 00:51:39,240
or changing BGP communities.

1108
00:51:39,240 --> 00:51:40,500
But in that case we're showing you

1109
00:51:40,500 --> 00:51:42,633
how you can insert firewalls.

1110
00:51:43,680 --> 00:51:46,860
So basically we have the send to action.

1111
00:51:46,860 --> 00:51:51,860
It creates a static route
pointing to kind of a default

1112
00:51:52,110 --> 00:51:54,420
for egress traffic to the inspection.

1113
00:51:54,420 --> 00:51:57,450
But then we also have the single hop,

1114
00:51:57,450 --> 00:52:02,450
the send via between
the different segments.

1115
00:52:02,460 --> 00:52:06,360
And here you see that even
though in my policy document

1116
00:52:06,360 --> 00:52:09,093
I created the dynamic block,

1117
00:52:10,440 --> 00:52:14,850
when it translated to JSON,
it creates the override.

1118
00:52:14,850 --> 00:52:16,590
So basically between these two regions,

1119
00:52:16,590 --> 00:52:18,330
I want to use the first one

1120
00:52:18,330 --> 00:52:22,950
and then everything that we
define in the local variable.

1121
00:52:22,950 --> 00:52:26,460
And then we have it both
for prod to dev and hybrid

1122
00:52:26,460 --> 00:52:28,560
and then from dev to hybrid

1123
00:52:28,560 --> 00:52:32,010
so we cover all the different use cases.

1124
00:52:32,010 --> 00:52:33,030
Now let's go to attachments.

1125
00:52:33,030 --> 00:52:34,560
How much time do we have?

1126
00:52:34,560 --> 00:52:36,390
Okay, we have some time so we're good.

1127
00:52:36,390 --> 00:52:40,230
So you see now that the three
VPCs already moved to dev,

1128
00:52:40,230 --> 00:52:42,480
so let's go to our state
machine to see how,

1129
00:52:42,480 --> 00:52:44,040
why that happened.

1130
00:52:44,040 --> 00:52:45,690
So we see three executions.

1131
00:52:45,690 --> 00:52:49,020
So it was our three VPCs moving already

1132
00:52:49,020 --> 00:52:51,750
to getting created.

1133
00:52:51,750 --> 00:52:53,580
So getting the notification to even breach

1134
00:52:53,580 --> 00:52:55,320
and coming to step function.

1135
00:52:55,320 --> 00:52:58,620
So let's pick one as an example
to show you what happened.

1136
00:52:58,620 --> 00:53:03,620
So here what I did is
obtaining the VPC attachment,

1137
00:53:03,840 --> 00:53:06,210
and I was obtaining three things,

1138
00:53:06,210 --> 00:53:09,750
three variables in Step Functions.

1139
00:53:09,750 --> 00:53:11,850
First of all, the AWS account,

1140
00:53:11,850 --> 00:53:15,450
basically from the input
getting the attachment ARM

1141
00:53:15,450 --> 00:53:18,990
and I'm getting the account
where the VPC was created,

1142
00:53:18,990 --> 00:53:19,990
the attachment ARM

1143
00:53:21,390 --> 00:53:25,230
and then the attachment ID.

1144
00:53:25,230 --> 00:53:28,140
First choices state that,

1145
00:53:28,140 --> 00:53:32,100
just checking that from here
I'm getting the VPC attachment.

1146
00:53:32,100 --> 00:53:34,440
So I'm also obtaining the status

1147
00:53:34,440 --> 00:53:37,140
of the VPC attachment if it's available.

1148
00:53:37,140 --> 00:53:38,160
So if it's created,

1149
00:53:38,160 --> 00:53:40,890
I just move to the next
state that I'm getting,

1150
00:53:40,890 --> 00:53:42,060
the organizational unit.

1151
00:53:42,060 --> 00:53:45,210
So from the account ID,

1152
00:53:45,210 --> 00:53:47,940
I'm getting the organizational unit,

1153
00:53:47,940 --> 00:53:51,090
and in the other one I'm getting the name

1154
00:53:51,090 --> 00:53:53,220
of the organizational unit.

1155
00:53:53,220 --> 00:53:56,820
And the only thing I'm doing
now is tagging that attachment.

1156
00:53:56,820 --> 00:54:00,420
So doing the cool thing
in Step Functions is

1157
00:54:00,420 --> 00:54:02,460
I don't need to be lambdas, like,

1158
00:54:02,460 --> 00:54:04,920
Step Functions provide native integration

1159
00:54:04,920 --> 00:54:07,890
to majority of the AWS APIs,

1160
00:54:07,890 --> 00:54:11,970
so I'm just directly calling
the APIs for those services.

1161
00:54:11,970 --> 00:54:13,560
I'm tagging the attachment

1162
00:54:13,560 --> 00:54:17,010
with the dev domain equals dev.

1163
00:54:17,010 --> 00:54:18,993
So if I come to my VPCs,

1164
00:54:20,760 --> 00:54:25,760
I see that the type is
already there in domain dev.

1165
00:54:25,920 --> 00:54:29,370
And the cool thing is that if
now I am in the spoke account

1166
00:54:29,370 --> 00:54:33,930
and if I go to Cloud WAN
and I check my attachment

1167
00:54:33,930 --> 00:54:36,960
because that was created
in the spoke account,

1168
00:54:36,960 --> 00:54:39,150
so it is shared with me.

1169
00:54:39,150 --> 00:54:40,890
So here I have it.

1170
00:54:40,890 --> 00:54:42,300
I see my...

1171
00:54:42,300 --> 00:54:43,380
I don't see the coordinator,

1172
00:54:43,380 --> 00:54:44,430
but I see the attachments

1173
00:54:44,430 --> 00:54:48,243
that I created for the coordinator
that they share with me.

1174
00:54:49,140 --> 00:54:50,880
I can also see those tags.

1175
00:54:50,880 --> 00:54:54,030
Something cool because for
the ones you know, like,

1176
00:54:54,030 --> 00:54:55,860
when you do AWS RAM,

1177
00:54:55,860 --> 00:54:58,290
the tags are not shared between accounts,

1178
00:54:58,290 --> 00:55:00,900
but Cloud WAN is sharing those tags

1179
00:55:00,900 --> 00:55:04,350
between accounts so you can
see and potentially control,

1180
00:55:04,350 --> 00:55:06,450
unless we block it as we did it today.

1181
00:55:06,450 --> 00:55:10,080
You can also check the
tags of that attachment

1182
00:55:10,080 --> 00:55:14,020
so you understand better why
my attachment was connected

1183
00:55:15,704 --> 00:55:16,537
to the segment.

1184
00:55:16,537 --> 00:55:18,780
But also, for example, because
it's a shared resource,

1185
00:55:18,780 --> 00:55:20,880
I don't know what I'm connected to.

1186
00:55:20,880 --> 00:55:22,950
I'm just simply connected to Cloud WAN

1187
00:55:22,950 --> 00:55:24,660
and I trust my networking team

1188
00:55:24,660 --> 00:55:29,073
to have built all the routing for me.

1189
00:55:30,858 --> 00:55:32,700
Okay, so I think with that,

1190
00:55:32,700 --> 00:55:35,043
we can start closing it up.

1191
00:55:37,650 --> 00:55:38,910
First, like-

1192
00:55:38,910 --> 00:55:40,050
- [Claudia] Yes.

1193
00:55:40,050 --> 00:55:42,540
So yeah, there is a repo.

1194
00:55:42,540 --> 00:55:45,330
You can start working with AWS Cloud WAN

1195
00:55:45,330 --> 00:55:46,650
Service Control Policy.

1196
00:55:46,650 --> 00:55:50,370
Everything is AWS sample
is the official reposit

1197
00:55:50,370 --> 00:55:53,460
where you can find these
and many other solutions,

1198
00:55:53,460 --> 00:55:56,700
and also you can start
working with AWS Cloud WAN

1199
00:55:56,700 --> 00:56:00,030
specifically with guidance for attachment.

1200
00:56:00,030 --> 00:56:01,440
- [Pablo] Before you move,

1201
00:56:01,440 --> 00:56:02,850
so in the Cloud WAN blueprints,

1202
00:56:02,850 --> 00:56:04,590
we already moved to version one,

1203
00:56:04,590 --> 00:56:06,000
and you have even examples

1204
00:56:06,000 --> 00:56:08,450
for these advanced routing
with routing policies.

1205
00:56:10,230 --> 00:56:12,970
Feel free to check it,
create issues, create PRs.

1206
00:56:12,970 --> 00:56:16,110
We're really happy to get
at least these blueprints

1207
00:56:16,110 --> 00:56:18,413
where we can interact with you

1208
00:56:18,413 --> 00:56:19,650
and you can tell us,

1209
00:56:19,650 --> 00:56:22,230
okay, I want to see
that specific use case.

1210
00:56:22,230 --> 00:56:23,340
The guidance solution,

1211
00:56:23,340 --> 00:56:26,430
it's basically the same idea that we saw

1212
00:56:26,430 --> 00:56:27,510
with the Step Functions,

1213
00:56:27,510 --> 00:56:30,810
but for production real environments

1214
00:56:30,810 --> 00:56:32,760
or thinking on production
real environments.

1215
00:56:32,760 --> 00:56:35,380
So it helps you to create this extra logic

1216
00:56:38,083 --> 00:56:39,660
in the attachment management of Cloud WAN

1217
00:56:39,660 --> 00:56:41,880
if you want to add those extra controls

1218
00:56:41,880 --> 00:56:44,280
aside the attachment policy.

1219
00:56:44,280 --> 00:56:45,113
And then, of course,

1220
00:56:45,113 --> 00:56:46,950
some examples on service control policies.

1221
00:56:46,950 --> 00:56:48,090
Yeah, sorry.

1222
00:56:48,090 --> 00:56:49,320
- [Claudia] Don't worry.

1223
00:56:49,320 --> 00:56:52,080
And then we have also AWS Skill Builder.

1224
00:56:52,080 --> 00:56:53,790
This is the platform where you can find

1225
00:56:53,790 --> 00:56:56,910
many different courses
for free, some of them,

1226
00:56:56,910 --> 00:56:59,190
and other one needs to be paid.

1227
00:56:59,190 --> 00:57:02,760
And yes, we have specifically for network

1228
00:57:02,760 --> 00:57:03,690
and content delivery.

1229
00:57:03,690 --> 00:57:07,590
You can find in here
more about AWS Cloud WAN

1230
00:57:07,590 --> 00:57:09,633
and other networking services.

1231
00:57:10,740 --> 00:57:14,010
- [Pablo] As I said at the
beginning of the session today,

1232
00:57:14,010 --> 00:57:15,150
some key takeaways.

1233
00:57:15,150 --> 00:57:17,730
You can forget everything
that we said so far.

1234
00:57:17,730 --> 00:57:19,173
This is the important piece.

1235
00:57:20,340 --> 00:57:24,420
So the first one is architect
by use case, not by habit.

1236
00:57:24,420 --> 00:57:28,260
So what we have seen so
far in customers is, like,

1237
00:57:28,260 --> 00:57:29,190
as they're growing,

1238
00:57:29,190 --> 00:57:32,190
they are just putting one specific service

1239
00:57:32,190 --> 00:57:35,580
because that's where they
found in the documentation

1240
00:57:35,580 --> 00:57:38,730
or that's where they're comfortable with

1241
00:57:38,730 --> 00:57:40,560
or their partner is comfortable with,

1242
00:57:40,560 --> 00:57:42,390
and then everything needs to operate

1243
00:57:42,390 --> 00:57:44,583
around this architecture decision.

1244
00:57:45,600 --> 00:57:47,850
We see success doing the opposite.

1245
00:57:47,850 --> 00:57:48,720
What's your use case?

1246
00:57:48,720 --> 00:57:50,250
That's why we're here.

1247
00:57:50,250 --> 00:57:51,990
Tell us your use case

1248
00:57:51,990 --> 00:57:55,620
and we can help you define
which is the best service

1249
00:57:55,620 --> 00:57:58,233
for your specific use case.

1250
00:57:59,250 --> 00:58:02,250
And then, of course,
like, the idea is, like,

1251
00:58:02,250 --> 00:58:04,350
you don't have one service for everything.

1252
00:58:05,490 --> 00:58:07,080
I know that it's, of course, like,

1253
00:58:07,080 --> 00:58:08,820
you need to be in the middle, like,

1254
00:58:08,820 --> 00:58:12,180
not like, hey, yeah, let's
use all the portfolio

1255
00:58:12,180 --> 00:58:14,220
of AWS networking to do connectivity.

1256
00:58:14,220 --> 00:58:15,960
But for sure it's not only one.

1257
00:58:15,960 --> 00:58:17,550
Like, we need to get, like,

1258
00:58:17,550 --> 00:58:19,380
define properly the use cases

1259
00:58:19,380 --> 00:58:22,050
and make sure that we
have the right pattern

1260
00:58:22,050 --> 00:58:23,790
for the use case.

1261
00:58:23,790 --> 00:58:26,130
And for that we need to
start with business outcomes

1262
00:58:26,130 --> 00:58:27,570
and then architectural agility.

1263
00:58:27,570 --> 00:58:29,580
So understand where we want to get,

1264
00:58:29,580 --> 00:58:31,580
where we want the business to...

1265
00:58:33,180 --> 00:58:35,940
When and where they
want to reach that goal

1266
00:58:35,940 --> 00:58:38,100
and then architect for agility.

1267
00:58:38,100 --> 00:58:40,440
Infrastructures called modular designs,

1268
00:58:40,440 --> 00:58:42,330
continuous iteration.

1269
00:58:42,330 --> 00:58:45,840
Most likely you have really
well-defined pipelines

1270
00:58:45,840 --> 00:58:47,730
and automation in your applications.

1271
00:58:47,730 --> 00:58:49,170
Take those learnings

1272
00:58:49,170 --> 00:58:51,480
and put it also in your infrastructure

1273
00:58:51,480 --> 00:58:53,880
so you can also have that iteration.

1274
00:58:53,880 --> 00:58:55,380
And services like Cloud WAN helps you

1275
00:58:55,380 --> 00:59:00,360
to not have to control
big infrastructure as code

1276
00:59:00,360 --> 00:59:02,910
files with so many resources.

1277
00:59:02,910 --> 00:59:05,730
You have everything in one single place.

1278
00:59:05,730 --> 00:59:07,710
And then orchestrate beyond networking.

1279
00:59:07,710 --> 00:59:10,680
We see that not only
networking is the key,

1280
00:59:10,680 --> 00:59:14,313
service control policies,
organizational security measures,

1281
00:59:15,420 --> 00:59:20,017
automation, take full control
of the portfolio of AWS also

1282
00:59:21,240 --> 00:59:24,630
to build the infrastructure that you want

1283
00:59:24,630 --> 00:59:27,240
to get your business quick

1284
00:59:27,240 --> 00:59:30,723
and to the goals that
you have been setting up.

1285
00:59:31,620 --> 00:59:33,993
So with that, thank you very much.

