# AWS re:Invent 2025 - Lambda Managed Instances 会议总结

## 会议概述

本次会议由来自澳大利亚新西兰的首席解决方案架构师 Steven Leig 和 AWS Lambda 团队的首席工程师 Archana Shakanta 共同主持，重点介绍了本周早些时候发布的全新功能 —— Lambda Managed Instances（Lambda 托管实例）。这是 AWS 在无服务器领域的又一重大创新，旨在为客户提供更多的控制权和灵活性。

Lambda Managed Instances 允许客户在自己账户中的 EC2 实例上运行 AWS Lambda 函数，同时保持熟悉的 Lambda 编程模型和开发体验。这项功能特别适合高流量、稳定状态的工作负载，以及对计算、内存或网络吞吐量有特定要求的应用程序。客户可以从超过 400 种不同的实例类型中进行选择，包括通用型、计算优化型和内存优化型实例家族，并且可以利用 EC2 定价机制（如 EC2 Savings Plans、Compute Savings Plans 和预留实例）来优化成本。

该功能的核心优势包括：消除冷启动、支持多并发调用、提供对专用计算资源的更多控制，以及通过 EC2 定价模型实现成本可预测性。AWS 仍然负责所有运维工作，包括实例生命周期管理、操作系统和运行时补丁、路由和自动扩展等。会议详细介绍了如何创建容量提供程序（Capacity Provider）、配置函数、发布版本以及管理扩展策略等关键步骤。

## 详细时间线

### 开场介绍 (00:00 - 05:30)
- **00:00** - 会议开始，Steven Leig 介绍自己是来自澳大利亚新西兰无服务器团队的首席解决方案架构师
- **00:30** - 介绍 Archana Shakanta，AWS Lambda 团队的首席工程师
- **01:00** - 宣布本周早些时候发布的新功能：Lambda Managed Instances
- **01:30** - 回顾 AWS 在无服务器领域的创新历程，从早期的 Python、NodeJS、Java 运行时支持，到 VPC 集成、Hyperplane 接口优化
- **02:30** - 介绍 Lambda 生态系统的扩展，包括 Step Functions 和 EventBridge
- **03:00** - 展示客户成功案例：金融机构迁移核心银行应用、医疗保健提供商自动化预约和保险理赔、零售公司采用事件驱动架构
- **04:00** - 提到澳大利亚统计局完全基于无服务器构建了最近一次人口普查系统

### Lambda Managed Instances 的需求背景 (05:30 - 08:00)
- **05:30** - 讨论客户反馈：尽管喜欢 Lambda 编程模型，但某些用例需要其他选项
- **06:00** - 客户需求包括：对函数运行位置和运行环境的更多控制、应用现有的使用承诺和折扣、通过多并发优化价格和性能
- **07:00** - Lambda Managed Instances 的核心价值：保持相同的编程模型、提供对专用计算的更多控制、消除冷启动、通过 EC2 定价机制实现效率和可预测性

### Lambda Managed Instances 核心概念 (08:00 - 12:00)
- **08:00** - 定义：在客户账户中的 EC2 实例上运行 Lambda 函数
- **08:30** - 支持超过 400 种不同的实例类型，涵盖通用型、计算优化型、内存优化型实例家族
- **09:00** - AWS 负责所有运维：实例生命周期管理、操作系统和运行时补丁、路由和自动扩展
- **09:30** - 客户可以应用 EC2 定价工具：EC2 Savings Plans、Compute Savings Plans、预留实例和特殊协议
- **10:30** - 使用场景：高流量稳定状态工作负载、具有特定计算/内存/网络需求的应用
- **11:00** - Lambda Default（传统 Lambda）适用场景：不可预测的流量、短时间和不频繁的调用

### 创建容量提供程序 (12:00 - 22:00)
- **12:00** - Archana 开始技术深入讲解，介绍三步流程：创建容量提供程序、创建函数、发布函数版本
- **13:00** - 容量提供程序是全新的 Lambda 构造，用于配置实例级别的设置
- **14:00** - VPC 配置：需要提供 IAM 角色、子网和安全组
- **15:00** - 建议为生产应用提供三个可用区的子网，以实现高可用性
- **16:00** - 网络说明：实例在 VPC 中有主网络接口，所有出站流量通过该接口传输
- **17:00** - 应用日志也通过实例网络接口传输到 CloudWatch
- **18:00** - 实例类型支持：C（计算优化）、M（通用）、R（内存优化）系列的最新一代，支持 large 及更大尺寸
- **19:00** - 支持 Intel、AMD（x86）和 ARM Graviton 架构
- **20:00** - 实例需求配置：可以指定允许或排除的实例类型
- **21:00** - EBS 卷加密：默认使用服务托管密钥，可提供自己的 KMS 密钥

### 函数创建和配置 (22:00 - 32:00)
- **22:00** - 创建函数流程与传统 Lambda 几乎相同，只需关联容量提供程序
- **23:00** - 支持的功能：OCI 容器和 ZIP 格式、最新版本的 Java、Python、Node 和 .NET 运行时
- **24:00** - 支持 Layers、Extensions、Function URLs、Response Streaming
- **25:00** - 调用超时为 15 分钟，与默认 Lambda 相同
- **26:00** - 支持新发布的 Durable Functions 功能
- **27:00** - 不适用的功能：SnapStart（因为没有冷启动）、预置并发和预留并发
- **28:00** - 内存配置：支持最高 32GB 内存
- **29:00** - 新设置：执行环境内存与 vCPU 比率（2:1、4:1 或 8:1）
- **30:00** - 不允许分数 vCPU，内存必须是比率的倍数
- **31:00** - 实例类型选择基于内存比率：2:1 选择计算优化型，4:1 选择通用型，8:1 选择内存优化型

### 发布版本和部署 (32:00 - 38:00)
- **32:00** - 必须发布函数版本才能触发部署
- **33:00** - 可以使用 Publish Version API 或在 Create/Update Function API 中设置 publish 标志
- **34:00** - 发布版本时的操作：映射函数到适当的实例类型、在账户中启动 EC2 实例、初始化执行环境
- **35:00** - 默认初始化 3 个执行环境，分布在 3 个可用区
- **36:00** - 函数在初始化完成前处于 pending 状态，完成后变为 active
- **37:00** - 函数扩展配置：最小和最大执行环境数量，默认最小值为 3

### 调用体验 (38:00 - 40:00)
- **38:00** - 调用体验与传统 Lambda 完全相同
- **39:00** - 所有事件源集成都开箱即用
- **39:30** - 支持同步调用和事件调用类型

### 并发模型差异 (40:00 - 48:00)
- **40:00** - 开始讲解 Lambda Default 和 LMI 之间的关键差异
- **41:00** - Lambda Default 并发回顾：单并发执行环境，每个执行环境一次只处理一个调用
- **42:00** - 冷启动：当没有可用执行环境时，在调用路径中初始化新的执行环境
- **43:00** - 热调用：重用现有执行环境，避免初始化成本
- **44:00** - LMI 的多并发：单个执行环境可以同时处理多个调用
- **45:00** - LMI 没有冷启动，因为执行环境在函数激活时预先初始化
- **46:00** - 每个执行环境的最大并发数基于语言有默认值，可以覆盖
- **47:00** - LMI Agent 作为代理，监控资源压力（内存和 CPU）

### 保护机制 (48:00 - 52:00)
- **48:00** - 当执行环境达到最大并发或资源压力过高时，LMI Agent 会拒绝新调用
- **49:00** - 调用会被重新路由到其他执行环境
- **50:00** - 如果所有执行环境都过载，调用会被限流
- **51:00** - 这种机制称为"goodput protection"（有效吞吐量保护），防止系统过载

### 扩展机制 (52:00 - 58:00)
- **52:00** - 扩展配置包括实例级别和函数级别
- **53:00** - 最小执行环境数：可以预置容量以应对已知峰值
- **54:00** - 最大执行环境数：可以限制以实现多个函数之间的公平共享
- **55:00** - 将最小和最大都设置为 0 可以停用函数
- **56:00** - 容量提供程序级别的最大 vCPU 计数作为成本控制手段
- **57:00** - 扩展策略的高级配置选项

### 安全边界 (58:00 - 60:00)
- **58:00** - Lambda Default 运行在 AWS 服务账户中，完全多租户设置
- **59:00** - LMI 运行在客户账户中，完全单租户设置
- **59:30** - 安全边界的差异及其影响

### 合作伙伴集成和工具支持 (60:00 - 62:00)
- **60:00** - 讨论合作伙伴集成
- **61:00** - 开发者工具支持
- **61:30** - 定价信息介绍

### 总结 (62:00 - 结束)
- **62:00** - 回顾 Lambda Managed Instances 的核心优势
- **62:30** - 强调保持熟悉的编程模型同时提供更多控制
- **63:00** - 会议结束