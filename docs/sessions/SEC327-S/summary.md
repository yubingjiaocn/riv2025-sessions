# AWS re:Invent 2025 - 大规模检测工程：构建高保真安全运营

## 会议概述

本次会议由DataDog安全倡导和研究团队负责人Andrew Krug和Riot Games高级安全工程师Nathan共同主讲，重点探讨了大规模检测工程的最佳实践。会议深入介绍了"检测即代码"(Detection as Code)的概念，即将软件开发生命周期(SDLC)原则应用于安全检测规则的编写和管理。

演讲者分享了Riot Games如何利用DataDog CloudSIM平台构建检测即代码平台的实际经验，涵盖了从日志优化、规则管理到行为检测的完整解决方案。会议强调了数据管道质量的重要性，以及如何通过标准化流程和开放标准来提高检测精度，减少误报率。

## 详细时间线与关键要点

### 0:00-5:00 - 开场介绍与背景
- Andrew Krug介绍DataDog安全倡导和研究团队职责
- Nathan分享在Riot Games的6年安全经验，专注于蓝队安全运营
- 现场调研：安全角色从业者和DataDog客户比例
- 检测工程定义：编写检测规则以发现威胁和错误配置

### 5:00-10:00 - 检测工程挑战与问题空间
- 日志数据量如"夜空中的繁星"般无限
- AWS环境中的核心日志类型：CloudTrail、工作负载安全日志、VPC流日志、Bedrock AI平台日志
- 检测开发生命周期介绍：需求收集、设计、开发、测试、部署、退役
- 手动检测工程的局限性：缺乏版本控制、开发孤立、质量不一致、难以规模化管理

### 10:00-15:00 - 检测即代码原则与术语
- SDLC原则应用：版本控制、同行评审、测试验证、CI/CD自动化
- 完美召回率(Perfect Recall)：识别100%恶意事件，零漏报
- 完美精确度(Perfect Precision)：仅在真正恶意事件发生时触发警报
- 烟雾探测器vs垃圾邮件过滤器类比：不同场景下对误报的容忍度差异

### 15:00-20:00 - SIM优化挑战与解决方案
- Nathan介绍Riot Games面临的三大挑战
- SIM优化六大标准：早期过滤节省成本、动态适应、标准化清理、保持弹性、可信扩展、强制数据卫生
- 基于AWS原生服务的基础架构设计
- Vector开源日志传输工具的应用

### 20:00-25:00 - 基础架构详解
- 公共/私有收集器架构
- 自动扩展组运行Vector进行日志处理
- Kafka提供背压支持
- ECS容器服务进行数据过滤和标签添加
- GitHub仓库管理Vector配置文件，支持PR流程

### 25:00-30:00 - Vector配置示例
- Windows事件日志处理示例：源、转换、输出三要素
- CloudTrail S3数据处理配置
- 字段删除和标签添加的转换操作
- 灵活的输出配置支持多目标发送

### 30:00-35:00 - 存储与重新激活策略
- 日志存储vs索引的成本考量
- Pan流量日志等噪声数据的处理策略
- S3存储归档机制
- 重新激活功能：5-10分钟快速数据恢复vs传统5-10小时
- 时间范围和查询条件优化重新激活效率

### 35:00-40:00 - 检测即代码实践演示
- DataDog GUI创建规则演示
- CloudTrail停止日志记录检测规则
- JSON导出和IDE管理流程
- Python验证脚本：CICD标签检查、MITRE技术标签验证
- 规则创建、更新、删除的完整生命周期

### 40:00-45:00 - 规则管理自动化与异常处理
- 自动化监控确保CICD状态一致性
- "managed-secops"标签管理
- 紧急情况下的"破玻璃"机制
- 开箱即用规则的评估和激活流程
- 历史数据90天回测验证

### 45:00-47:30 - 行为检测与未来展望
- Okta行为分析和GuardDuty噪声问题
- 信息级别警报的关联分析策略
- AI在检测关联中的应用潜力
- OCSF框架标准化的重要性
- DataDog观察性管道和Bits AI安全分析师介绍
- DataDog初创企业计划推广