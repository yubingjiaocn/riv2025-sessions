# AWS re:Invent 2025 事件驱动架构安全性会议总结

## 会议概述

本次会议由AWS专业服务团队的高级云基础架构师Sergio Bilbao和意大利DevOps架构师Igor Rastolfo主讲，重点讨论了基于Amazon EventBridge的事件驱动架构安全性问题。演讲者通过虚构公司Novalamer.com的案例，展示了从同步架构向异步架构迁移过程中遇到的安全挑战及解决方案。

会议采用实际演示和代码示例的方式，深入分析了EventBridge部署中常见的安全漏洞，包括资源策略配置错误、消息完整性问题以及访问控制不当等。演讲者强调了多账户策略的重要性，并提供了comprehensive的安全最佳实践建议，涵盖组织级控制、账户级权限管理、服务级控制和检测策略等多个层面。

## 详细时间线与关键要点

### 0:00-5:00 开场介绍与异步架构优势
- 演讲者自我介绍：Sergio Bilbao（AWS专业服务高级云基础架构师）和Igor Rastolfo（意大利DevOps架构师）
- 现场调研：了解听众对EventBridge使用情况
- 异步架构五大优势：
  - 松耦合：降低系统间依赖性
  - 可扩展性：无需管理服务器或扩展组
  - 异步处理：改善用户体验
  - 事件溯源：基于事件的状态管理
  - 灵活性：模块独立更新能力

### 5:00-10:00 案例公司介绍与架构演进
- 虚构公司Novalamer.com：奢侈品电商平台
- 业务挑战：流量峰值导致系统性能问题，影响业务收入
- 架构迁移计划：从同步架构转向基于EventBridge的异步架构
- 新架构组件：API Gateway、EventBridge、Lambda函数、SQS队列

### 10:00-15:00 项目代码结构说明
- 基础设施即代码：使用Terraform管理资源
- 模块化设计：EventBridge核心组件、生产者、消费者、监控仪表板
- 多环境支持：开发、QA、生产环境配置
- Python Lambda函数：事件处理逻辑
- 流量模拟脚本：用于测试和演示

### 15:00-25:00 第一个安全问题：外部访问控制
- 问题发现：EventBridge接收到异常消息数量
- 根本原因：资源策略使用通配符（*），允许任何人写入事件
- 解决方案：添加组织条件限制，仅允许组织内账户访问
- 多账户策略说明：不同域使用独立账户的最佳实践
- 演示：策略更新后外部访问被成功阻止

### 25:00-35:00 第二个安全问题：内部访问控制
- 问题识别：组织内其他团队复制配置，发送不相关事件
- 策略改进：
  - 将主体从通配符改为特定IAM角色
  - 添加事件源条件（event source）
- 规则优化：从接受所有事件改为特定事件类型过滤
- 自定义EventBridge vs 默认EventBridge：推荐使用自定义总线实现应用隔离

### 35:00-42:00 消息完整性与Schema注册表
- 消息标准化挑战：不同团队使用不同消息格式
- AWS EventBridge Schema注册表功能：
  - 自动发现事件模式
  - 支持多种编程语言的代码绑定
  - 版本控制和向后兼容性
- JSON Schema验证：确保事件格式一致性
- 演示：Schema自动发现和代码生成功能

### 42:00-48:00 持续监控与合规检查
- AWS Config服务：跟踪资源生命周期变化
- 自定义合规规则：
  - AWS托管规则：检查EventBridge资源策略存在性
  - 自定义Lambda规则：验证策略特定属性
- 策略合规验证：确保使用IAM角色而非通配符，包含事件源条件
- 防御深度概念：多层安全控制的重要性

### 48:00-50:00 安全最佳实践总结
- 组织级控制：使用SCP（服务控制策略）和AWS Organizations
- 账户级控制：最小权限IAM策略和资源策略
- VPC端点：内部网络连接和额外IAM策略控制
- 服务级控制：
  - 明确事件模式规范
  - Schema验证实施
  - 定期规则审计
- 检测策略：CloudWatch指标、CloudTrail日志、基于内容的行为分析
- 学习资源：AWS Skill Builder免费培训和实验室