# AWS re:Invent 2025 会议总结：使用 Amazon SageMaker 构建混合数据网格

## 会议概述

本次会议由 AWS 高级数据策略解决方案架构师 Diego Ortiz 和 ET 公司高级云工程师 Julieta Solas 共同主讲，重点介绍了 ET 公司如何利用 Amazon SageMaker 构建混合数据网格架构。ET 是一家在巴拉圭运营的多行业控股公司，旗下拥有超过 20 家公司，横跨五个垂直领域，每天产生超过 300TB 的数据。面对数据孤岛、治理风险和缺乏统一数据发现机制等挑战，ET 需要在保持企业级治理的同时实现数据产品的自主开发。

ET 采用了混合架构方法，既不是完全中心化也不是完全去中心化。他们将 Dreamcore 自助数据摄取平台作为骨干，使用 EMR on EKS 维护中心化的生产层，并采用 SageMaker Unified Studio 实现去中心化的消费层。通过这种架构转型，ET 成功地将集群利用率从 35% 提升到 80%，实现了 45% 的成本削减，新员工入职时间缩短了 75%，数据访问时间从数周缩短到即时访问。会议强调了三个关键经验：治理必须是声明式而非命令式的、中心化与去中心化的平衡是动态的、以及文化与技术同样重要。

## 详细时间线

开场介绍
- 演讲者介绍：Diego Ortiz（AWS 高级数据策略解决方案架构师）和 Julieta Solas（ET 高级云工程师）介绍会议主题

数据驱动组织面临的挑战
- 讨论全球客户在成为数据驱动型组织过程中遇到的常见挑战
- 问题一：业务部门各自为政导致数据碎片化和数据孤岛，阻碍数据共享和创新
- 问题二：缺乏统一的数据治理策略带来安全和合规风险
- 问题三：复杂数据环境中缺乏统一的数据资产发现机制

数据网格概念介绍
- 解释数据网格架构模式：将数据域视为独立的业务领域，通过网格互联
- 数据网格的优势：
  - 可以整合现有投资
  - 通过将策略下推到业务领域改善数据治理
  - 提供业务数据目录实现集中式数据发现和共享
  - 增强自助式数据共享能力
  - 赋能业务领域使用数据并进行创新

ET 公司背景和挑战
- ET 公司概况：在巴拉圭运营的多行业控股公司，拥有超过 20 家公司，横跨五个垂直领域
- 数据规模：跨不同系统产生超过 300TB 数据
- 核心挑战：如何在保持企业级治理的同时实现自主数据产品开发
- 各公司具有不同的发展速度、合规框架和创新周期
- 需求多样：有的需要流式分析，有的需要符合 ACID 的批处理和完整审计跟踪

架构权衡分析
- 中心化模式的问题：
  - 所有生产者和消费者团队都通过中央数据平台团队路由
  - 虽然创建了安全的数据治理环境，但形成单点故障
  - Sprint 速度经常因数据平台团队依赖而受阻
- 去中心化模式的问题：
  - 跨域共享数据面临挑战
  - 数据重复、模式演进不一致
  - 基础设施开销大

混合架构解决方案
- 采用 Dreamcore 自助数据摄取平台作为基础，完全构建在 AWS 上
- 从中心化平台演进为联邦架构
- 使用 EMR on EKS 维护中心化的生产层
- 采用 SageMaker Unified Studio 实现去中心化的消费层，民主化 ML 和分析能力
- 这种方法使 ET 能够在不影响所有 20 家公司的情况下转型运营模式

数据分类体系
- 创建了编码在 IAM 策略和网络拓扑中的分类图
- 三个主要域：
  - 中央数据域（神经系统）
  - 数字生态系统域
  - 金融生态系统域
- 每个域通过专用 AWS 账户隔离
- 在中央数据湖中拥有各自的 S3 前缀
- 使用 Lake Formation 实现跨账户数据共享
- 示例：支付团队需要中央域数据时，只需在业务域目录中订阅

从传统 EMR 迁移到 EMR on EKS
- 迁移前状态：
  - 运行一个大型持久 EMR 集群用于作业提交
  - 每天仅使用约 4 小时
  - 平均利用率仅 35%
  - 为 100% 的基础设施付费却只使用三分之一
  - 作业隔离仅在进程级别，一个失控的 Spark 作业可能导致整个集群崩溃
  - 扩展时间需要 15-20 分钟
- 迁移后状态：
  - 每个业务域在隔离的 EKS 命名空间中运行
  - 两级隔离：EKS 命名空间提供硬边界，Pod 级安全提供安全工作负载
  - EMR 与这些命名空间一对一映射
  - 实施 Spot 实例降低成本：70% Spot 实例 + 30% 按需实例
  - 部分实例迁移到 Graviton 3 以优化内存密集型工作负载
  - 关键改进：Karpenter 在 60 秒内配置节点，实现所需的弹性

成本和性能改进
- 利用率从 35% 提升到 80%
- 实现 45% 的成本削减
- 使用共享基础设施和优化计算
- 通过 Karpenter 可以近实时处理流量峰值
- 为可预测工作负载预热节点池
- 以一半成本处理相同数据量

Amazon SageMaker 介绍
- SageMaker 是 AWS 上数据分析和 AI 的中心
- 三个主要层次：
  - Unified Studio：访问不同数据功能的界面（SQL 分析、数据处理、机器学习模型开发、GenAI 应用开发）
  - 数据和 AI 治理层
  - 开放 Lakehouse 层

SageMaker Catalog 详解
- 业务目录：技术和业务元数据的中央存储库
- 支持不同类型的数据产品：传统数据集、机器学习模型、GenAI 应用等
- 集成功能：
  - 数据质量可见性
  - 元数据表单和业务词汇表用于分类数据产品
  - 端到端完整数据血缘
  - 持续添加更多功能

SageMaker Unified Studio 实施
- 保留 Dreamcore 作为骨干（数据管道、摄取和转换发生的地方）
- SageMaker Unified Studio 成为混合网格中的缺失部分
- 用户从单一入口点可以：
  - 使用探索性分析工具
  - 运行简单的 AI 查询
  - 启动 SageMaker 笔记本
  - 使用基础模型和知识库构建更强大的应用
  - 在 SageMaker Lakehouse 目录中发布（来自不同域的每个项目）
- SageMaker Lakehouse 目录在正确的治理下组织不同资产

Lake Formation 标签实施
- 用 Lake Formation 标签替换旧的基于工单的审批流程
- 在中央账户的中央数据目录中创建分类体系
- 通过 AWS RAM 等服务共享
- 用户可以从单一入口访问所有 ML、分析和 GenAI 工具

速度提升成果
- 新员工入职速度提升 75%
- 之前：需要为 VPN 访问、软件包安装、安全等开工单
- 现在：5 分钟内通过 SageMaker Unified Studio 中的蓝图启动环境
- 使用 CloudFormation 创建模板，简单点击创建笔记本即可开始编码
- 数据访问从数周缩短到即时：
  - 通过分类体系和 Lake Formation 标签实现即时访问
  - 示例：支付团队成员访问标记为支付的数据可以立即查询，无需等待

经验教训
- 第一：治理不是可选的，但必须是声明式而非命令式的
  - 废除旧的基于工单的审批流程
  - 用 Lake Formation 标签替代
  - 实现了大规模治理与自主性，无人为瓶颈
- 第二：平衡是动态的
  - 中心化与去中心化没有完美公式
  - ET 从完全中心化开始以建立标准
  - 当域证明成熟度后释放控制
- 第三：文化与技术同样重要
  - 可以构建最高效甚至最炫的架构
  - 但如果人们不信任它就会失败
  - 建议：保持简单，首先建立采用度

结束语
- 演讲者开放问答环节
- 提醒观众完成调查问卷