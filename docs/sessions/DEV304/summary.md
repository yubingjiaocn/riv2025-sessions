# AWS 技术会议总结：AI 驱动的可观测性在 CI/CD 中的应用

## 会议概述

本次技术会议由 AWS 开发者倡导者 Elizabeth Fuentes 和 DevOps 内容创作者 Rosanna Suarez 共同主讲，重点探讨了如何利用生成式 AI 技术革新传统的可观测性系统。演讲者强调，在当今快速开发的环境中，仅仅快速编写代码是不够的，更重要的是构建能够在故障影响用户之前进行预测和预防的智能系统。

会议深入分析了传统可观测性的局限性，包括被动响应、告警噪音过多、缺乏关联性分析以及决策缓慢等问题。这些问题不仅造成经济损失（每小时停机成本可达 5 万至 50 万美元），还导致客户信任度下降、工程师告警疲劳（约 70% 的 DevOps 工程师受此困扰），以及大量时间（约 40%）浪费在故障排查上而非创新开发。为解决这些痛点，演讲者展示了一个开源的 AI 驱动可观测性解决方案，该方案集成在 GitHub Actions 中，使用 Agentic AI 在部署前、部署中和部署后三个关键阶段进行智能分析和决策，实现从被动响应到主动预防的转变。

演讲包含两个实际演示：本地可观测性演示和完整的 CI/CD 流水线演示。该解决方案支持多种 AI 模型提供商（Amazon Bedrock、Anthropic Claude、OpenAI），使用 Strand Agent 框架、Kubernetes、Prometheus、Grafana 和 Telegram 通知系统。系统通过分析 CPU、内存、日志、事件等指标，生成 0-100 的健康评分，并根据评分自动批准、警告或阻止部署。演讲者最后邀请观众参加免费的 AI Agent 构建课程，学习如何将这些技术应用到实际生产环境中。

## 详细时间轴

开场介绍
- 演讲者介绍自己：Elizabeth Fuentes（AWS 生成式 AI 开发者倡导者）和 Rosanna Suarez（DevOps 免费内容创作者）
- 强调 Rosanna 致力于打破西班牙语技术学习障碍的贡献

传统可观测性的局限性
- 引用 AWS CTO Werner Vogels 的名言："一切都会失败"（Everything fails all the time）
- 关键不在于是否会失败，而在于何时失败以及我们能多快检测和响应
- 传统可观测性的五大问题：
  1. 被动而非主动（告警通常在用户已在社交媒体投诉后才触发）
  2. 噪音重叠（5 分钟内大量告警，90% 可能是噪音）
  3. 静默信号（多个仪表板但缺乏关联性）
  4. 决策缓慢（需要召开战争室会议，浪费大量时间）
  5. 实际上是在"救火"而非预防

问题的真实影响
- 经济损失：停机成本每小时 5 万至 50 万美元
- 客户信任度下降
- 告警疲劳：70% 的 DevOps 工程师受此困扰，导致工程师倦怠
- 时间浪费：约 40% 的时间用于故障排查，而非创新开发
- 数据过载：日志、指标、追踪数据无处不在但缺乏关联
- 人工决策缓慢：战争室会议可能持续 40 分钟讨论是否回滚

解决方案介绍 - Rosanna Suarez
- 描述典型场景：周五晚上 11 点，"小改动"导致生产环境崩溃
- 提出 AI 驱动可观测性的核心理念：在部署前而非部署后进行智能分析
- AI 驱动可观测性在 CI/CD 中的四大优势：
  1. 早期检测：在生产环境之前捕获问题
  2. 安全防护：自动阻止高风险部署
  3. 快速恢复：减少停机时间，加快交付速度
  4. 更好的开发者体验：反馈直接集成在流水线中

实际效果数据
- 告警数量从每次部署 200 个降至 5 个
- 节省成本：每次 AI 预防事故可节省 5 万美元
- 速度提升：8 倍更快
- 结果：更少噪音、更多洞察、零意外

GitHub Actions 中的工作原理
- 三个关键时刻：
  1. **Pull Request 阶段**：AI 提供建议并在合并前显示风险（仅建议，不阻止）
  2. **部署前阶段**（最重要）：AI 可以批准或阻止部署，如果系统状态不佳则停止部署以保护生产环境
  3. **部署后阶段**：AI 检查一切并发送报告，如有问题立即告警

工作流程说明
- 开发者推送代码时，AI 立即开始分析
- 收集指标、日志、Pod 状态，甚至 Kubernetes 数据
- 使用 Amazon Bedrock、Claude 或 OpenAI 进行分析
- 如果一切正常：绿灯，批准部署
- 如果有问题：红灯，阻止部署并立即发送 Telegram 消息
- 整个过程简单、自动、安全，无需人工批准

技术架构 - Elizabeth Fuentes
- 支持三种 AI 模型提供商：Amazon Bedrock、Anthropic Claude、OpenAI
- 可轻松切换模型提供商（开源解决方案）
- 使用 Strand Agent 作为核心框架（开源 AI Agent 框架）
- Strand Agent 是系统的"大脑"，管理 Agentic 循环并提供答案
- Kubernetes 集成：使用 Prometheus 和 Grafana 捕获所有指标（CPU、内存、重启等）

两个关键部署门控
- **部署前健康检查**：每次推送代码时，Agent 检查一切，如果不批准则阻止部署
- **部署后验证**：Agent 验证一切是否正常运行
- 通过 Telegram 发送通知，包含所有进度和信息
- 整个流程由 GitHub Actions 触发

决策流程
- 从 Kubernetes 拉取所有数据（状态、CPU 等）
- 发送数据到 AI Agent 引擎
- Agent 生成 0-100 的健康评分
- 使用专业化提示词（类似 DevOps 专家）理解系统状态
- Agent 做出建议：
  - 批准：继续部署
  - 中等（Más o menos）：带警告部署
  - 不批准：停止一切
- 通过 Telegram 发送通知

评分系统和模式识别
- Agent 不仅检查 CPU，还分析重启、错误日志等
- 使用经典部署失败模式：CrashLoopBackOff、ImagePullBackOff 等
- 评分标准：
  - 90-100：优秀，批准部署
  - 75-89：良好，批准但需监控
  - 70-74：一般，批准但带警告并加强监控
  - 低于 60：危险，建议不要部署

演示 1：本地可观测性（使用 Claude）
- 要求：本地环境（Docker、终端）、配置文件（AI 模型选择）、Kubernetes 环境（本地或 AWS EKS）、Prometheus、示例应用
- 代码库结构：
  - analyzer 文件夹：包含 Kubernetes 和 Prometheus 逻辑
  - models 文件夹：管理不同 AI 提供商
  - notifications 文件夹：发送 Telegram 通知
  - tools 文件夹：辅助脚本
- 运行命令：python main.py
- Agent 连接集群、检索指标、计算健康评分（0-100）、决定系统是健康、风险还是危险

数据来源说明
- Prometheus：指标收集系统
- Grafana：可视化工具
- Telegram：通知系统（也可使用 Teams、Slack、WhatsApp）

本地演示场景
- 健康系统场景：100% 评分，无异常，AI 自动批准部署
- 故障场景：运行本地脚本模拟故障，主应用开始失败、崩溃、重启，指标快速下降
- AI Agent 连接 Claude 模型，从 Prometheus 拉取实时数据
- 分析 CPU、内存、事件，检测错误并建议修复步骤
- Grafana 显示红色警报
- 发送详细的 Telegram 通知

演示 2：GitHub Actions 中的 AI 驱动流水线
- 使用 Amazon Bedrock 或任何选择的模型
- 配置参数：集群名称、命名空间、模型提供商、Prometheus、Telegram bot
- Docker 构建过程：
  - 使用 Python 3.11（小而快）
  - 复制 requirements 文件
  - 安装 Python 包
  - 复制应用代码
  - 设置工作目录
  - 创建非 root 用户（安全性）
  - 设置入口点脚本

部署脚本逻辑
- 运行 Python 分析器
- 退出码 0：部署批准
- 退出码 1：部署阻止
- 退出码 2：错误，显示友好消息

GitHub Action 配置
- 定义输入参数：AI 模型提供商、Kubernetes 命名空间、应用名称、集群名称、Telegram token
- 使用 Docker 运行，设置自动传递（流水线 ID、代码版本、环境等）
- Action 已公开发布：开发者只需在工作流文件中添加一行代码即可使用

GitHub Actions 演示流程
- 推送新提交，流水线自动运行
- AI 门控任务：下载 Action、连接集群、开始分析
- 分析所有 Blackjack 应用
- 发送 Telegram 通知（包含环境、提交、模型、健康分析详情）
- 继续执行构建、安全检查、部署后验证
- 再次发送详细的 Telegram 通知

Pull Request 演示
- 创建从 feature 分支到 deployment 分支的 PR
- PR 创建后自动触发 AI 可观测性流水线
- Agent 在工作流中运行，连接集群并开始分析
- 显示集群健康审查：指标、事件、日志（CPU、内存、应用状态）
- 结果：100% 评分，无关键事件，无警告
- AI 自动批准部署，标记 PR 为可合并

故障场景演示
- 在集群中模拟故障
- 创建 PR 启动验证
- 工作流启动，AI Agent 连接集群并分析
- 这次发现问题：应用中有错误，Pod 有问题
- AI 立即阻止部署
- 创建提交消息说明阻止原因、健康评分和主要问题
- 发送包含相同报告和 AI 建议的通知

Telegram 通知对比
- 成功部署：Amazon Bedrock 报告，100 分健康评分，AI 确认系统健康，批准部署
- 危险场景：AI 检测到 Pod 故障，健康评分 60/100，立即阻止部署
- 实时可见性、AI 决策、分析和后续步骤直接交付

三大要点总结
1. AI 在故障发生前而非发生后进行预防
2. 可以选择 AI 模型：更多灵活性、更多信心
3. 清晰的解释建立信任：团队在理解原因后能更快交付

未来展望
- CI/CD 的未来是 AI 驱动的
- 不再只是观察系统，而是 AI 保护系统
- 预测问题、预防故障、自动确保每次部署安全
- 这是下一代 DevOps

两家公司对比
- 公司 1（传统可观测性）：部署、等待故障、修复、凌晨 3 点接电话、团队压力大
- 公司 2（AI 驱动可观测性）：分析、预测、阻止不良部署、批准良好部署、无意外、团队愉快
- 问题：你想成为哪家公司？凌晨 3 点救火还是让 AI 保护部署？

行动号召
- 技术已经存在
- 代码开源
- 演示可立即运行
- 获取代码库、尝试演示、将团队从被动转变为主动
- 未来是 AI 驱动的，今天就开始构建

结束语
- AI 不会取代工程师，但使用 AI 的工程师可能会取代不使用的工程师
- AI 是工具，让你更强大、更快速、更优秀
- 可以预防问题
- 不要害怕 AI，使用它就会成功

学习资源
- 提供有用资源链接，了解更多关于使用的工具
- 探索 AI DevOps 和 CI/CD

免费课程推广 - Elizabeth Fuentes
- 与同事 Lars 和 Alina 共同提供的完全免费课程
- 四门课程内容：
  1. Strand Agent 入门（几行代码即可部署 Agent 到生产环境）
  2. 使用 MCP 创建高级 Agent
  3. 多 Agent 系统
  4. 使用 Kubernetes 将 Agent 投入生产
- 完全免费，扫描二维码注册