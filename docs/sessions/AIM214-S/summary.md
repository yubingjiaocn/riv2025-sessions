# AWS re:Invent 2025 技术分享会总结

## 会议概述

本次分享会的主题是"RAG已死,智能检索增强生成(Agentic RAG)万岁"。演讲者通过一个真实的餐厅推荐场景,深入探讨了传统RAG系统的局限性以及Agentic RAG如何解决复杂查询问题。演讲者以自己6年前第一次约会时寻找合适餐厅的亲身经历作为案例,生动地展示了在面对多重限制条件(如饮食限制、预算、氛围偏好等)时,传统推荐系统难以满足用户需求的困境。

演讲的核心观点是:当用户查询变得复杂且包含多个约束条件时,传统的RAG系统会失效。Agentic RAG通过引入智能代理(Agent)机制,能够理解复杂查询、优化检索模式、并进行迭代生成,从而显著提升推荐质量。演讲者详细介绍了工具使用工作流架构,展示了如何通过查询理解、检索优化和迭代生成三个维度来构建高质量的推荐系统。整个演讲强调了在高风险、高回报场景下(如首次约会),系统必须在首次交互中就提供准确推荐的重要性。

## 详细时间线

### 开场与问题引入 (0:00-3:30)
- **0:00** - 演讲开始,介绍主题"RAG已死,智能检索增强生成万岁"
- **0:30** - 提出核心讨论内容:推荐系统、Agentic RAG的定义,以及如何解决复杂查询问题
- **1:00** - 引入场景:构建一个餐厅和菜品推荐的科技创业公司
- **1:30** - 发现特定用户群体:首次约会的情侣,他们有复杂的需求但满意度不高
- **2:00** - 展示真实案例:两个人的约会场景,一方避免乳制品、只吃鸡肉、喜欢辣食;另一方喜欢鱼和牛肉、重视浪漫氛围、有多种食物过敏
- **2:45** - 用户研究发现:情侣们的对话最终形成复杂的查询语句,包含预算、位置、饮食限制、氛围等多重条件

### 真实案例分享 (3:30-5:00)
- **3:30** - 演讲者质疑这个场景是否过于具体
- **4:00** - 揭示真相:这是演讲者6年前第一次约会时的真实经历
- **4:30** - 分享结果:推荐系统成功帮助他找到合适餐厅,今年早些时候他向女友求婚
- **4:45** - 强调这是真实存在的问题,在餐厅推荐等特定场景中,错误推荐的后果严重,只有一次机会

### 问题分析 (5:00-7:30)
- **5:00** - 分析问题的四个核心难点
- **5:15** - 难点一:需要协调多个不同的数据源(餐厅评论、描述、菜品、图片、位置、饮食限制等)
- **5:45** - 难点二:高风险高回报场景,首次用户交互必须提供优质推荐
- **6:15** - 三重后果:获取用户终身价值、餐厅获得双倍客户、情侣关心食物质量
- **6:30** - 难点三:处理复杂的自然语言查询,传统RAG系统会完全失败
- **6:50** - 查询特点:长、需要推理能力理解动机、需要规划和协调
- **7:10** - 难点四:传统RAG方法会失败,需要更多工程工作

### Agentic RAG解决方案 (7:30-9:30)
- **7:30** - 提出解决方案:如果有一组"魔法盒子"能够解析和理解查询该多好
- **7:50** - 引入Agentic RAG:通过灵活性解决复杂查询的复杂性
- **8:10** - Agentic RAG的三大贡献
- **8:20** - 贡献一:查询理解 - 解释用户真正需要什么,在该上下文中提供推荐
- **8:40** - 贡献二:优化检索模式 - 在知道需求后,如何检索最佳上下文
- **9:00** - 贡献三:迭代生成 - 不止步于首次检索,持续优化生成结果
- **9:20** - 介绍主要架构:工具使用工作流架构,易于实现且灵活

### 工具使用工作流示例 (9:30-11:00)
- **9:30** - 展示查询示例:需要在酒店附近、预算内用餐,避免乳制品和肉类但接受鸡蛋,喜欢辣食,约会之夜需要可分享的菜品
- **9:50** - Agent可以访问的工具:查询转换程序、标准评估、多个数据库(菜品、餐厅、过敏原、评论)
- **10:20** - 关键特点:Agent决定何时使用哪些工具,对查询类型特别灵活
- **10:45** - 最终输出推荐模式

### 查询理解技术 (11:00-14:00)
- **11:00** - 深入探讨查询理解:Agent能够规划查询以实现最优检索
- **11:20** - 传统RAG直接查询数据库,而Agent可以修改查询或添加额外查询
- **11:40** - 三种实现方式
- **11:50** - 方式一:子查询生成 - 基于用户查询,用户还可能需要什么
- **12:10** - 方式二:查询路由 - 被低估但很重要,决定将查询发送到哪些数据库
- **12:30** - 方式三:查询扩展 - 需要包含哪些其他术语或概念,需要注意哪些约束
- **12:50** - 实践示例:展示如何在工具使用上下文中进行查询规划
- **13:20** - 示例工具:解析菜品限制的工具(如辣味食物)
- **13:35** - 解析过敏信息的工具
- **13:50** - 提取灵活的自然语言偏好(如无乳制品、肉类或鸡蛋,家庭式服务)

### 检索优化 (14:00-17:30)
- **14:00** - 讨论检索优化:让数据库对Agent更友好
- **14:20** - 三个关键方面
- **14:30** - 方面一:为数据源提供上下文 - 开发者最常犯的错误是不向Agent提供适当的schema信息
- **14:50** - 需要明确:Agent可以访问什么数据、如何使用、应该如何使用
- **15:10** - 方面二:实现强大的搜索技术 - 如何交互、如何存储、如何最大化相关性
- **15:30** - 方面三:尽可能使用过滤器减少搜索空间并降低延迟
- **15:50** - 展示数据库表格示例
- **16:00** - 餐厅索引:包含名称、描述、元数据(位置),预处理(跨评论总结),过滤器(价格、氛围、位置),使用混合搜索
- **16:40** - 菜品索引:多模态(人们拍摄食物照片),包含描述和链接评论,生成潜在缺失成分以警告交叉污染,过敏原级别过滤器,实现重排序优化相关性
- **17:10** - 评论索引:多模态(文字描述和图片),实现图像到图像或图像到文本搜索

### 生成优化 (17:30-20:30)
- **17:30** - 讨论如何改进底层生成
- **17:50** - 传统RAG的问题:直接将数据库结果通过LLM返回给用户,失去了很多优化机会
- **18:10** - 应该花更多时间理解结果是否与特定用户在特定上下文中相关
- **18:30** - 三种有用技术
- **18:40** - 技术一:循环检索 - 用户还可能需要什么,是否值得用延迟换取更多相关信息
- **19:00** - 技术二:识别隐含偏好 - 用户在首次交互中不善于描述需求,需要构建架构来理解需要跟进的信息
- **19:30** - 技术三:使用结构化生成 - 约束返回给用户的内容,以易于理解和分析的格式呈现
- **19:50** - 实践示例:检查清单设计模式

### 检查清单评估模式 (20:30-23:00)
- **20:30** - 详细介绍检查清单评估模式
- **20:50** - 流程:初始查询 → 检索上下文(餐厅、菜品、评论)→ 生成初始推荐
- **21:20** - 并行操作:动态创建评估检查清单,列出需要满足的标准
- **21:40** - 目的:作为手动双重检查,因为初始查询和检索上下文之间有大量查询操作
- **22:00** - 示例:严格遵守过敏原信息,确保餐厅有约会氛围等
- **22:30** - 在工作流结束时实施额外检查,确保结果质量
- **22:50** - 权衡:愿意牺牲一些延迟成本以提高结果相关性

### 总结与要点 (23:00-25:00)
- **23:00** - 总结架构的主要收获
- **23:15** - 在传统RAG失败的领域使用Agentic检索
- **23:30** - 三大具体优势
- **23:40** - 优势一:查询理解 - 允许深度规划和推理能力分解复杂查询,服务有复杂偏好的用户
- **24:00** - 优势二:优化检索 - Agentic RAG允许动态访问所有数据源(前提是对Agent友好且可访问),优化生成步骤的上下文
- **24:30** - 优势三:迭代生成 - 允许循环并提高生成结果的感知质量,愿意牺牲延迟成本以提高质量
- **24:50** - 强调:非常关心确保情侣有一个美好的第一次约会

### 结束与资源 (25:00-26:00)
- **25:00** - 如果想学习如何构建Agentic RAG,扫描QR码
- **25:15** - 可以了解Pine Cone客户如何实现Agentic RAG:Deli、Aquant、Terminal X、Custom GPT
- **25:30** - QR码直接链接到网站案例研究部分,可以学习真实客户的真实架构实现
- **25:45** - 感谢参与,邀请在后面提问
- **25:55** - 团队在534号展位,欢迎深入交流
- **26:00** - 演讲结束