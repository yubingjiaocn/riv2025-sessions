# AWS re:Invent 2025 DynamoDB 技术会议总结

## 会议概述

本次技术会议由 AWS DynamoDB 团队的两位工程师 Amrith 和 Craig 主讲，深入探讨了 DynamoDB 的架构设计决策和扩展挑战。会议重点阐述了 DynamoDB 团队如何基于四大核心原则（安全性、持久性、可用性、可预测的低延迟）来指导所有技术决策。

演讲者通过实际案例和技术细节，展示了在构建大规模分布式数据库时面临的复杂挑战，包括状态管理、请求路由、元数据缓存等关键问题。会议强调了分布式系统中状态管理的复杂性，以及如何通过合理的架构设计来平衡性能、可用性和成本。

## 详细时间线与关键要点

### 0:00-5:00 开场介绍与核心原则
- 介绍演讲者 Amrith 和 Craig，两人均为 DynamoDB 团队成员
- 阐述会议目标：分享 DynamoDB 团队的决策过程而非具体决策内容
- 强调分布式团队决策的重要性，避免集中式决策瓶颈
- 提出 DynamoDB 四大核心原则：
  - 安全性（不可妥协）
  - 持久性（不可妥协）
  - 可用性（不可妥协）
  - 可预测的低延迟（DynamoDB 特色）

### 5:00-10:00 DynamoDB 规模展示
- 展示 DynamoDB 的巨大规模：数百个表每秒处理 50 万请求
- Amazon 商店业务在 Prime Day 峰值达到每秒 1.51 亿请求
- 强调有状态分布式系统比无状态系统复杂度更高
- 介绍分布式状态管理的基本挑战

### 10:00-20:00 分布式系统架构演进
- 从单实例应用开始，逐步演进到分布式架构
- 讨论主从架构的挑战：主节点失效 vs 从节点失效
- 分析不同节点数量的权衡：
  - 两个节点：无法处理单点故障
  - 三个节点：最小可行方案
  - 四个节点：偶数节点导致脑裂问题
  - 五个节点：可容忍两个故障，但成本增加
- 提出"多个三节点组"的解决方案

### 20:00-30:00 请求路由与负载均衡
- 介绍请求路由的复杂性：如何将请求发送到正确的节点组
- 讨论负载均衡器的作用和局限性
- 引入元数据层的概念：存储数据位置信息
- 分析双重查找的性能开销问题
- 提出缓存解决方案及其潜在风险

### 30:00-40:00 DynamoDB 架构深入
- 详细介绍 DynamoDB 的实际架构：
  - 请求路由器集群
  - 存储节点集群
  - 负载均衡器和 DNS 层
- 解释跨可用区部署的重要性：
  - 每个分区的三个副本分布在三个可用区
  - 保证单个可用区故障时的可用性和持久性
- 讨论网络延迟优化：
  - 可用区内 vs 跨可用区的网络距离差异
  - 使用分割视界 DNS 实现就近路由

### 40:00-50:00 元数据管理与缓存策略
- Amrith 接管讲解，重点讨论请求处理流程
- 每个请求需要回答三个问题：
  - 身份验证（SigV4 签名验证）
  - 权限检查
  - 限流检查
- 介绍分区和哈希的概念：
  - 基于主键计算哈希值
  - 连续哈希范围构成分区
  - 数十微秒内完成分区定位
- 详细分析缓存策略的演进：
  - 单层缓存的问题：缓存失效时的雪崩效应
  - 双层缓存系统：MEMDS + 请求路由器缓存
  - 版本控制机制处理最终一致性

### 50:00-59:30 性能优化与限制说明
- 介绍对冲请求（Hedging）技术：
  - 缓存未命中时发送两个并行请求
  - 缓存命中时后台仍发送请求维持恒定负载
- 解释 DynamoDB 各种限制的设计原因：
  - 分区级别限制：1000 WCU，3000 RCU
  - 事务大小限制：从 25 项增加到 100 项
  - 项目大小限制：400KB
  - GSI 数量限制：从 5 个增加到 20 个
- 强调所有限制都是为了保证可预测的低延迟
- 总结四大原则在所有决策中的指导作用
- 鼓励听众在自己的项目中建立类似的指导原则