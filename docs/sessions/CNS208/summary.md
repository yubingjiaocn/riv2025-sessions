# AWS re:Invent 2025 - CNS208 会议总结

## 会议概述

本次会议主题为"使用 Amazon Elastic Container Registry 增强容器安全性"（CNS 208），由 AWS 容器领域首席专家架构师 Liz Duke 主讲。会议深入探讨了在容器化工作负载中面临的安全挑战，以及如何通过 AWS 服务构建完整的容器供应链来应对这些挑战。

演讲者强调，随着容器镜像数量从几个增长到数百甚至数千个，安全检查变得越来越复杂。容器镜像由多个层组成，包括基础操作系统、应用程序代码、依赖库和开源组件，每一层都需要进行安全检查。会议重点介绍了 Amazon ECR 作为容器安全的核心工具，不仅可以安全地存储和分发容器镜像，还能提供漏洞扫描、镜像签名等关键安全功能。

通过自动化的 CI/CD 流水线、持续的漏洞扫描、镜像签名验证以及运行时监控，企业可以在容器生命周期的每个阶段都嵌入安全机制，将安全从"检查点"转变为"加速器"，在保证安全的同时提高开发和部署效率。

## 详细时间线

00:00 - 开场介绍
- 会议开始，Liz Duke 介绍自己是 AWS 容器领域首席专家架构师
- 工作范围覆盖英国、爱尔兰及更广泛的 EMEA 地区
- 会议主题：如何让容器安全成为加速器而非障碍

01:30 - 容器安全挑战
- 容器镜像数量快速增长，从少数增长到数百甚至数千个
- 每个镜像需要在整个生命周期中持续进行安全检查
- 容器镜像由多层构成（基础 OS、应用程序、库、依赖项、开源组件）
- 快速变化的特性容易导致安全问题

03:00 - 容器供应链介绍
- 代码仓库：存储应用程序代码
- 镜像构建：从多个层构建容器镜像
- 容器注册表：存储构建好的镜像
- 容器编排器：部署镜像到运行环境
- 运行时监控：监控镜像的实际运行行为

04:30 - 自动化容器供应链
- 使用 AWS CodePipeline 实现从代码提交到部署的全流程自动化
- 与 IAM 集成，使用临时访问令牌
- 使用 AWS CodeBuild 构建容器镜像
- 使用 AWS Signer 对镜像进行签名
- 自动化可以减少人为错误，提升安全性

06:00 - Amazon ECR 核心功能介绍
- 完全托管的 Docker 注册表服务
- 每个 AWS 账户都有私有 ECR 注册表
- 支持 Docker 镜像、OCI 镜像及其他 OCI 兼容制品
- 通过 HTTPS 传输镜像，静态加密存储
- 高可用架构，每天处理数十亿次镜像拉取

07:30 - ECR 生命周期策略
- 自动清理旧的容器镜像
- 解决"大海捞针"问题，减少需要管理的镜像数量

08:00 - ECR 漏洞扫描功能
- 镜像推送到 ECR 时自动扫描
- 支持上游仓库连接和 Pull Through Cache 功能

08:30 - ECR 内置安全特性
- 与 IAM 集成，控制推送和拉取权限
- 控制拉取权限保护公司知识产权
- 控制推送权限确保镜像符合安全标准
- 使用 AWS S3 存储镜像，默认使用 AWS 拥有的密钥进行 AES-256 加密
- 支持客户自己的 KMS 密钥进行加密

10:00 - VPC 端点支持
- 支持私有 VPC 端点
- 数据传输不离开 Amazon 网络
- 无需 NAT 网关或互联网网关

10:45 - 基础扫描功能
- 2019 年发布基础扫描选项
- 基于开源漏洞扫描器 Clair
- 仅扫描操作系统漏洞
- 最近更新为 Amazon 自有专有技术
- 支持更多操作系统，所有新注册表默认启用

12:00 - 基础扫描工作流程
- 推送镜像后自动触发扫描
- 扫描操作系统漏洞
- 将发现的 CVE 漏洞结果返回到 ECR 界面

12:30 - 增强型容器扫描
- ECR 与 Amazon Inspector 集成
- 不仅扫描操作系统漏洞，还扫描应用程序包漏洞
- 支持从头构建的镜像、Distroless 镜像和 Chainguard 镜像

13:30 - 增强扫描工作流程
- 推送镜像后 Amazon Inspector 自动扫描
- 扫描应用程序和操作系统漏洞
- 对发现结果进行优先级排序
- 将结果发送到 Security Hub，提供审计跟踪
- 显示是否存在可利用的漏洞
- 提供修复建议
- 检测生命周期结束的软件

15:00 - 持续扫描功能
- 当漏洞数据库更新时，自动重新扫描已有镜像
- 识别正在运行的受影响镜像
- 与 ECS 和 EKS 集成，定位到任务和 Pod 级别
- 精确知道受影响镜像的运行位置

16:30 - 镜像签名的重要性
- 代码签名是行业标准技术
- 确保检查的代码与运行的代码一致
- 可以在构建流水线中集成 AWS Signer

17:30 - ECR 完全托管的镜像签名（新功能）
- 上周发布的新功能
- 与 AWS Signer 完全集成
- 通过控制台几次点击或单个 CLI 命令即可启用
- 集中式镜像签名工具，无需在每个流水线中单独集成
- ECR 将签名与镜像一起存储在注册表中

18:30 - 签名验证机制
- EKS：使用 Gatekeeper 和 Ratify 或 Kyverno 检测签名不匹配
- ECS：使用生命周期钩子结合 Lambda 进行验证
- 可以选择仅通知或阻止未签名/签名不匹配的镜像

19:30 - 运行时监控 - Amazon GuardDuty
- 支持 ECS 和 EKS 的运行时检测
- 检测异常或可疑行为
- 识别连接到已知命令和控制服务器的容器（僵尸网络）
- 检测比特币挖矿活动
- 监控数据外泄行为
- 可以为所有集群或部分集群启用

21:00 - 关键要点总结
- Amazon ECR 安全地存储和传输容器镜像
- 支持漏洞扫描和镜像签名
- 安全态势需要持续演进以应对不断变化的攻击
- 应考虑将签名集成到容器工作负载中
- 确保运行的镜像是经过安全验证的版本

22:00 - 相关会议和学习资源
- 推荐其他安全、EKS 和 ECS 相关会议
- 包括研讨会、构建者会议和技术讨论
- 提供 ECS 和 EKS 数字徽章培训计划
- 自定进度学习，完成评估后获得数字徽章
- 所有培训资源免费

23:00 - 会议资源
- 提供 QR 码链接到 Git 仓库
- 包含所有容器会议的额外资源
- 包括本次会议的补充材料

23:30 - 结束语
- 感谢参会者参加当天剧场的最后一场会议
- 请求填写应用程序中的会议调查