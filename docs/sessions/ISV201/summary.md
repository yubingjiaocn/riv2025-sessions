# AWS re:Invent 2025 会议总结：Adobe Marketo 迁移至 AWS 的实践之旅

## 一、会议概述

本次会议由 Adobe Marketo 团队的 Gorav 和 David 主讲，分享了 Marketo 这一 B2B 营销自动化解决方案迁移至 AWS 的完整历程。Marketo 拥有超过 5,000 家客户，分布在五个数据中心和三大洲。这次迁移的特殊性在于 Marketo 本身是 Adobe 在 2018 年以 47.5 亿美元收购的公司，而 Marketo 在被收购前又收购了七家其他公司，因此这不仅仅是迁移一个应用程序，而是迁移多个不同技术栈的集合体。

会议重点传达了两个核心信息：第一，如何以最佳实践方式处理大型复杂迁移项目；第二，迁移到 AWS 不仅对 AI 工作负载至关重要，而且对业务成功几乎是必不可少的。整个迁移历程从 2022 年的技术可行性研究开始，2023 年后端服务开始迁移，2024 年首个客户完全运行在 AWS 上，2025 年关闭了第一个数据中心，计划在未来 2-3 年内关闭其余数据中心。

## 二、详细时间线与关键要点

### **开场介绍 (00:00 - 02:30)**
- 演讲者通过现场调查了解观众背景，包括使用 Adobe 产品、进行大型迁移项目和 AI 项目的情况
- 介绍 Marketo 作为 Adobe 的 B2B 营销自动化解决方案，服务超过 5,000 家客户
- 强调迁移的复杂性：Marketo 是多家公司收购整合的结果，涉及多个技术栈

### **迁移历程概览 (02:30 - 04:00)**
- **2022 年**：技术可行性研究阶段
- **2023 年**：后端服务开始迁移
- **2024 年**：首个客户（AWS 自己）完全迁移到 AWS
- **2025 年**：关闭第一个数据中心
- **未来 2-3 年**：计划关闭所有剩余数据中心
- 特别说明：Adobe 收购 Marketo 后首先建立了第五个本地数据中心，当时没有公有云计划

### **迁移驱动因素 (04:00 - 06:00)**
- **传统基础设施挑战**：建立第五个数据中心非常困难，特别是 Hadoop 集群的部署是噩梦
- **全球规模和容量需求**：数据中心资源固定，无法灵活应对工作负载变化，而 AWS 可以动态调整
- **接近零停机时间**：2023 年一个数据中心发生灾难性故障，促使客户欢迎迁移到 AWS
- **面向未来的能力**：AWS 提供的广泛服务和创新能力

### **第一阶段：后端服务迁移 (06:00 - 08:30)**
- **Hadoop 替代方案**：五个笨重的 Hadoop 集群无法升级，供应商建议重建
- **Spark Streaming 迁移**：2022 年概念验证在 EKS（Adobe 定制版本 Ethos）上运行 Spark Streaming
- 成功迁移 20 种不同的 Spark Streaming 作业到 AWS
- **MongoDB 整合**：将 13 种不同版本的 MongoDB（由 2 人团队管理）迁移到 MongoDB Atlas
- 此阶段约 40% 的应用程序已在云上运行，但用户几乎没有察觉

### **第二阶段：首个完整客户迁移 (08:30 - 11:30)**
- **2023 年底**：最大客户（AWS 自己）要求在其公有云平台上运行 Marketo
- **数据规模**：AWS 拥有 40TB 数据（从最初的 90TB 精简而来）
- **迁移挑战**：
  - 数据库精简工作需要说服客户，但最终提升了应用性能
  - 使用 Pure Storage 设备将数据从本地迁移到 AWS，然后重新注入 RDS
  - 数据同步耗时数月，因为 AWS 每天的活动量巨大
- **迁移结果**：性能提升，营销活动运行更快，AWS 在 AWS 上稳定运行数月

### **第三阶段：规模化迁移 (11:30 - 13:30)**
- **APAC 数据中心关闭**：该数据中心租约将于 2026 年 2 月到期，从 2024 年底开始规划
- **完全 AWS 原生架构**：不再依赖本地数据中心的负载均衡器等组件
- **Pod 批量迁移**：Marketo 的核心单元是 Pod（包含前端、后端、数据库集群），每个 Pod 服务 100-200 个客户
- 从单个实例迁移转变为批量 Pod 迁移，提高效率

### **AWS 区域配对策略 (13:30 - 14:00)**
- 展示了本地数据中心与 AWS 区域的配对关系
- 澳大利亚的红点（数据中心）已经或即将消失
- 混合架构方法对迁移至关重要

### **托管服务优势 (14:00 - 16:00)**
- **Aurora MySQL**：57 个 MySQL 5.7 集群（约 170 个实例，总计 20PB 数据）迁移到 Aurora
  - 性能显著提升
  - 可根据需求动态扩展（如 re:Invent 期间扩容，活动后缩容）
- **Spark on EKS**：替代 Hadoop，性能更好
- **Solr**：5,000 个物理虚拟机运行 Solr 8，迁移到 EKS 上的 Solr 9，搜索速度更快
- **ElastiCache**：替代自管理 Redis，减轻团队负担
- **MongoDB Atlas**：提供迁移工具和专业知识，成为宝贵合作伙伴

### **AWS 合作伙伴支持 (16:00 - 17:30)**
- **MAP 资金**：迁移加速计划提供资金支持
- **成熟的迁移方法论**：AWS 提供经验丰富的迁移指导
- **AWS 专业服务**：
  - 自动化 Solr 8 到 Solr 9 的迁移
  - 开发软件负载均衡器替代 F5
  - 解决瓶颈问题
- **联合销售优势**：能够向客户承诺在 AWS 上运行，显著提升销售能力

### **架构层次与未来展望 (17:30 - 19:00)**
- **三层架构**：
  - 应用层（Marketo 核心）
  - 基础层（AWS 基础设施服务）
  - 智能层（AWS 增值服务：Bedrock AI、EKS 等）
- 强调 AWS 带来的附加价值和创新能力

### **如何开始迁移 (19:00 - 20:00)**
- **关键信息**：正确的开始至关重要，错误的开始可能导致时间延长 3 倍（类似地球到火星任务）
- **可用资源**：
  - 迁移沉浸日（Migration Immersion Days）
  - Aurora 数据库迁移研讨会
  - 迁移加速计划（MAP）指导
- 演讲者表示会后可回答问题

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


总结要点：这是一个历时多年的复杂迁移项目，采用分阶段、渐进式方法，从后端服务开始，逐步过渡到完整的客户迁移和数据中心关闭。关键成功因素包括：选择合适的托管服务、与 AWS 和第三方合作伙伴紧密合作、采用混合架构过渡策略，以及始终关注性能提升和业务价值。