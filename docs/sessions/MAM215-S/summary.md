# AWS re:Invent 2025 技术会议总结：大规模构建零 CVE 容器镜像

## 会议概述

本次技术会议由 Chainguard 公司的高级解决方案工程师 Dale Rodriguez 主讲，主题聚焦于如何大规模构建零 CVE（通用漏洞披露）容器镜像。Chainguard 致力于成为开源软件的安全来源，通过保护容器、库和虚拟机来增强开源社区的安全性，使企业能够在生产环境中安全运行开源软件，同时满足合规和安全要求。

该公司目前维护超过 1,818 个镜像，拥有 134,000 多个版本。Chainguard 使用一系列自研工具构建软件，包括 Milange（包管理器）、APKO（构建 APKO 包）、Octo STS（GitHub 安全令牌工具）、SIG store（签名工具）、Terraform providers 以及 Malcontent（恶意软件检测工具）。实现零 CVE 并非魔法，而是依靠大量自动化、调试、云计算成本投入、测试和持续优化。

Chainguard 的核心理念是从源代码构建，通过提供深度防御来扩展可见性，从而减少不确定性并建立信任。他们使用更安全的编译器选项重新编译所有包和二进制文件，以减少技术栈中的漏洞。整个工厂化流程包括下载开源项目、生成包构建、进行 CVE 修复、存储到包仓库、构建和测试镜像，最后推送到镜像仓库。

## 详细时间线与关键要点

00:00:00 - 会议开场与讲师介绍
- Dale Rodriguez 自我介绍，称自己为"认证漏洞猎手"
- 拥有 10 年产品管理、安全和解决方案工程经验
- 7 年云原生安全专注经验

00:01:00 - Chainguard 公司介绍
- 目标：成为开源软件的安全来源
- 维护 1,818 个镜像，134,000+ 版本
- 支持开源社区，同时增强容器、库和虚拟机的安全性

00:02:00 - 工具链介绍
- Milange：包管理器
- APKO：构建 APKO 包
- Octo STS：GitHub 安全令牌工具
- SIG store：签名工具
- Malcontent：恶意软件检测工具

00:03:00 - 零 CVE 的实现方法
- 强调没有魔法，依靠自动化、调试、云计算成本
- 需要大量测试和持续质疑自身决策

00:04:00 - 从源代码构建的哲学
- 信任源代码，提供深度防御
- 扩展可见性，从文件系统层面构建
- 深度可以减少不确定性，建立信任

00:05:00 - 更安全的编译器选项
- 许多上游项目未使用安全编译器
- Chainguard 使用更安全的编译器选项重新编译所有包和二进制文件
- 目标是减少技术栈中的漏洞

00:06:00 - Chainguard 工厂流程概览
- 下载开源项目
- 后台自动化生成包构建
- 必要时生成 CVE 修复
- 存储到包仓库
- 构建和测试镜像
- 推送到镜像仓库

00:07:00 - 装配线系统
- 工厂装配线贯穿整个流程
- 所有 1,818 个项目每日重建
- 覆盖零日 CVE 并自动维护更新

00:08:00 - GitHub PR 管理
- 大量 GitHub PR：65,000 个已关闭，407 个开放
- 自动化匹配版本差异
- 对每个 PR 进行构建和测试，执行两次以确保功能性和性能

00:09:00 - 规模展示
- 从源代码重建每个包
- 构建过程中启动约 1,000 个 CPU
- 构建完成后缩减资源

00:10:00 - 自动化策略
- 监控上游项目并摄取新版本
- 监控多个版本流，不仅提供最新版本
- 支持所有项目支持的标签
- 上游项目 EOL 后继续支持 6 个月

00:11:00 - CVE 监控与修复
- 扫描 CVE 并主动解决
- 关键漏洞 7 天内解决
- 高、中、低级别漏洞 14 天内解决
- 机器人完成大部分工作

00:12:00 - AI 应用
- 使用 AI 诊断和修复构建错误
- 改进测试流程
- 简化 PR 提交
- 从构建、扫描、测试日志生成遥测数据
- 帮助改进工厂决策

00:13:00 - AI 工作流程
- AI 生成的 PR 会分配给工程团队
- 人工验证 AI 的工作
- 强调"我们还不完全信任 AI，不想成为天网"
- 突出显示错误和构建日志
- 提供修复建议
- 人工进行分类和修复

00:14:00 - 测试重要性
- 镜像通过测试后才会打标签
- 不仅仅是打包，还要确保完全功能性
- 启动实际 Kubernetes 集群进行真实世界测试
- 测试超越简单的"hello world"

00:15:00 - 测试流程
- 镜像进入 PR 系统或工厂后启动测试工具
- 部署并通过探针提供功能测试
- 使用 Helm、Docker 或其他部署工具
- 认证后发布镜像

00:16:00 - 工厂即规模
- 工厂是构建功能性可扩展工厂的方式
- 所有镜像使用 SIG store 签名
- 推送到客户私有仓库

00:17:00 - 客户仓库功能
- 客户获得带有自己域名的专属仓库
- 通常在一小时内发布
- 可以从 Chainguard 仓库克隆镜像
- 支持 LDAP 和其他自定义功能
- 可以创建自己的黄金镜像程序

00:18:00 - 免费镜像
- 提供约 54 个免费镜像（仅最新版本）
- 基础镜像：Python、JRE、Ruby、Node、PHP
- 应用镜像：Postgres、MariaDB、MongoDB、Redis、Valkey
- 所有免费镜像始终保持零 CVE
- 包含 SBOM（软件物料清单）
- 本质上是企业产品的免费版本

00:19:00 - 自定义装配
- 企业不是一刀切的
- 允许客户自定义黄金镜像
- 可以添加自己的包和入口点
- 使 Chainguard 工作流适应客户现有流程
- 所有自定义镜像都使用 SIG store 签名，包含 SBOM 和来源证明

00:20:00 - Chainguard 产品栈
- 底层：Chainguard 工厂
- Chainguard OS：自研操作系统，实现 7 天关键 SLA、14 天高中低级别 SLA
- 最小化操作系统，受 Alpine 启发
- 几年前放弃了 musl 支持

00:21:00 - Chainguard 虚拟机
- 与加固容器镜像相同，但以 VM 形式提供
- 例如：Nginx VM 而非 Nginx 容器，零 CVE
- 所有镜像和 VM 都有合规版本
- 超过 700 个 FIPS 镜像
- FIPS 镜像也可以制作成 Chainguard VM

00:22:00 - Chainguard 容器和工具链
- 保护工具链运行时
- Chainguard 镜像保护图表（Helm charts）
- 当 Bitnami 将产品放在付费墙后，Chainguard 介入服务社区
- 提供约 40-50 个图表

00:23:00 - Chainguard 库
- 较新且令人兴奋的功能
- 例如：使用 Chainguard 而非 pip 获取 Python 包
- 包含恶意软件保护、来源证明和 CVE 修复
- 目前支持 Python 和 Java
- JavaScript 处于早期访问阶段
- 目标：保护所有可能的开源库
- 路线图：Go 和 Rust，随后是其他语言

00:24:00 - 库的特点
- 仍可使用第三方库提供商
- 不锁定客户到特定产品
- Python：约 20,000-30,000 个包（目标 700,000+）
- Java：超过 50,000 个包
- JavaScript：数量保密（需要 NDA）

00:25:00 - 工厂关键要点总结
- 包从源代码构建
- 默认由专家人工加固
- 快速更新和修补（主要自动化）
- 最小化容器镜像
- 可重现、安全
- 在真实集群上测试
- 持续重建以获取包更新
- 像披萨一样新鲜热送到客户手中

00:26:00 - VM 和库的特点
- VM 镜像与容器镜像完全相同
- 库从经过验证的上游源构建
- 进行恶意软件扫描
- 具有 CVE 回溯功能
- 回溯约 3 年（与镜像和 VM 不同）
- 支持开发团队使用旧版本包（如 1995 年的 Java 包）
- 帮助客户迁移到安全的包版本

00:27:00 - 会议结束
- 讲师感谢听众参加