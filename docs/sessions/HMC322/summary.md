# AWS re:Invent 2025 - 大规模管理多云 Kubernetes 会议总结

## 会议概述

本次会议由 AWS 首席解决方案架构师 Goro Damija 和 Adobe 平台工程团队的 John 共同主讲,主题聚焦于大规模多云 Kubernetes 集群管理。会议首先介绍了 AWS 对多云战略的观点,强调客户通常出于业务战略、并购整合或特定云服务商的差异化能力等原因采用多云架构。AWS 推出了 CANOE(云原生卓越运营)计划,与包括 Adobe 在内的大型客户合作,为内部开发者平台提供可组合的能力指标、工具指导和参考实现。

Adobe 分享了其超过 15 年的多云实践经验。Adobe 构建了名为 Ethos 的内部平台,管理着约 450 个独立的 Kubernetes 集群,分布在 30 个区域、多个公有云提供商和私有数据中心。该平台每天编排约 400 万个容器,支撑 Adobe 90% 的容器化工作负载和约 4000 个不同的服务。会议重点展示了基于 GitOps 的声明式基础设施管理方法,使用 Argo CD、Helm、ACK(AWS Controllers for Kubernetes)和 Cluster API 等工具实现集群生命周期的自动化管理。

## 详细时间线

### 开场与 AWS 多云视角 (0:00 - 8:30)

0:00 - 0:45 - Goro Damija 开场介绍,欢迎参会者参加多云 Kubernetes 大规模管理主题演讲,介绍自己是 AWS 首席解决方案架构师,并介绍来自 Adobe 的 John

0:45 - 1:30 - 现场调查:询问有多少参会者在组织中跨多个云服务提供商使用 Kubernetes,少数参会者举手表示正在实践多云

1:30 - 2:15 - 会议议程介绍:首先分享 AWS 对多云的观点,然后讨论多云 Kubernetes 集群管理的考虑因素,最后由 John 分享 Adobe 的实践经验和最佳实践

2:15 - 3:45 - AWS 多云定义:客户在至少两个云服务提供商上运行 IT 解决方案或工作负载;客户采用多云的原因包括业务战略、并购整合或使用特定云服务商的差异化能力

3:45 - 5:00 - AWS 多云支持策略:与客户合作确保成功,帮助构建跨流程和技术支柱的技术和非技术能力;许多大型多云客户(包括 Adobe)投资于平台工程,构建内部开发者平台以简化跨多个云服务提供商的体验

5:00 - 6:15 - CANOE 计划介绍:AWS 与 Adobe 等客户合作推出云原生卓越运营(CANOE)计划,定义了内部开发者平台的可组合能力指标,并提供工具、指导和参考实现

6:15 - 7:00 - Kubernetes 作为核心抽象:在 CANOE 计划和客户讨论中,Kubernetes 和容器已成为多云客户用于简化体验的基本抽象层

7:00 - 8:30 - 集群管理考虑因素:除了多租户和开发者体验外,集群管理需要考虑集群生命周期管理、插件生命周期管理(网络、安全、可观测性等),以及基于工作负载的不同集群配置(如 ML 工作负载需要特定 GPU 驱动)和多个 Kubernetes 发行版的支持

### GitOps 方法与 Adobe Ethos 平台介绍 (8:30 - 18:00)

8:30 - 9:15 - GitOps 最佳实践:推荐使用基于 GitOps 的集群管理方法,将集群和插件配置以及安全审计和合规策略存储在 Git 中作为真实来源,利用 Argo CD 等 GitOps 操作器和云提供商特定的控制器持续配置和协调多云 Kubernetes 集群状态

9:15 - 10:00 - 过渡到 Adobe 案例:Goro 将演讲交给 John,分享 Adobe 如何在组织中大规模实施这些模式

10:00 - 11:00 - John 自我介绍:来自 Adobe 开发者平台团队,团队使命是帮助开发者更快地编写更好的软件;面对 Adobe 复杂的技术环境,需要通过抽象和平台简化开发者体验

11:00 - 12:30 - Adobe 多云策略:Adobe 的多云之旅已超过 15 年;强调"适合目的"的重要性 - 在多云环境中部署应用必须是有意识的选择(数据驻留要求、安全认证或与战略合作伙伴的集成)

12:30 - 13:30 - 多云现实考量:不要将多云作为高可用性(HA)架构本身,仍需处理物理限制(如光速延迟);在一个云提供商内复制状态已经很困难,跨两个云提供商更加复杂

13:30 - 14:30 - 平台工程重点:Adobe 将所有云提供商(包括自有数据中心)视为一等公民,以满足多样化的业务需求和特定技术挑战,使开发者能够尽快交付代码

14:30 - 16:00 - Ethos 平台介绍:Adobe 构建的 Ethos 平台旨在简化开发者体验,提供一致的界面,无论底层云提供商如何;开发者使用统一的 CI/CD 管道管理云原生基础设施,而不是 SDK 或专有 API;开发者专注于交付业务价值,而不是处理特定区域或云提供商的安全和合规认证

16:00 - 18:00 - Ethos 规模数据:Ethos 是 Adobe 整个公司的"拨号音";每天编排约 400 万个容器;90% 的 Adobe 容器化工作负载运行在 Ethos 上;支持约 4000 个不同的服务,跨越三个云(数字体验、创意和文档);450 个独立的 Ethos 集群分布在全球约 30 个区域、多个公有云提供商和多个私有数据中心

### Adobe 技术实现与运营原则 (18:00 - 28:00)

18:00 - 19:30 - 运营原则:Adobe 的方法根植于声明式基础设施;使用声明式基础设施定义集群配置、网络策略、版本和资源定义,所有这些都作为代码管理,通常是存储在 Git 中的 YAML 清单

19:30 - 21:00 - GitOps 工作流:Adobe 全面采用 GitOps,整个工作流由 GitOps 驱动;使用 Argo CD 和 Helm 等工具,对应用状态和基础设施的所有更改都通过拉取请求(Pull Request)提交到特定的 Git 仓库;这提供了单一真实来源,支持自动回滚、持续管道和自动化测试,最终实现生产环境与源代码的一致性

21:00 - 22:15 - 模块化代码库:Ethos 构建为模块化代码库;使用 Helm 作为包管理器部署每个组件和安全配置,支持快速更新、更轻松的维护以及针对不同业务需求或多云等技术挑战的定制

22:15 - 23:30 - 开源工具采用:全面采用开源工具,包括 Cert Manager(证书管理)、Cluster API(管理集群上的 Kubernetes 组件)、OpenTelemetry(可观测性堆栈);使用开源还使 Adobe 内部团队(如 Adobe Firefly)能够为平台贡献,Firefly 贡献了自定义 Pod 自动扩缩器以满足其业务需求

23:30 - 25:00 - 实现架构:两个重要方面 - 人工操作者填充清单文件,包含关键属性(集群名称、区域、组织、云提供商);机器执行层面是运行 Argo 的 Kubernetes 集群,Argo 监听 Git 信号并将配置从 Git 同步到生产环境

25:00 - 26:30 - 关键组件:ACK(AWS Controllers for Kubernetes)管理特定 AWS 原语(如 EKS);Cluster API(Cappy)管理特定 Kubernetes 组件(如集群自动扩缩器,可能是 Karpenter);该设置不特定于 AWS,可以使用任何云提供商,只要采用其 Kubernetes 控制器

26:30 - 28:00 - 演示预告:准备展示从零到在 AWS 中创建完全功能的可部署目标的过程;演示将展示 GitOps 驱动的工作流,包括标准软件开发实践(测试、自动化、审批机制);清单将包含非重叠 IP 范围、特定安全配置、可观测性和部署管道

### 实时演示 (28:00 - 38:00)

28:00 - 29:00 - 演示开始:John 开玩笑说多云很容易,但播放视频很难;演示将展示从零到完全功能的可部署目标,包括为开发者和集群本身提供的部署管道

29:00 - 31:00 - 声明式基础设施演示:每个集群都有自己的配置,Argo CD 负责将配置同步到生产环境;Argo UI 中显示降级状态是正常的,GitOps 的优势在于最终一致性;在 Argo UI、kubectl 和 AWS 控制台之间切换,展示准实时构建系统的过程

31:00 - 33:00 - 基础设施组件创建:展示 VPC、EKS、Pod 和集群组件的分层创建;检查两个重要组件的健康状况:Cilium 操作器和 CoreDNS;这些组件无需与专有云供应商控制台交互即可启动

33:00 - 36:00 - 集群更新演示:展示生命周期管理;Adobe 更新了标签策略,以确保将所有资源正确归属于特定的 Ethos 集群;强调演示中没有显示的内容:不使用 AWS CLI、不获取 IAM 角色或访问密钥、不更新 CloudFormation 模板(因为其他云提供商不存在这些);需要在多云世界中提供抽象层来驱动环境管理

36:00 - 38:00 - 标签应用:在 Argo、kubectl 和 AWS 控制台之间切换,展示如何将标签应用到特定集群;Argo 获取配置并实现最终一致性,将"reinvent demo"标签应用到 AWS 中的集群;在 AWS 控制台中显示带有特定 AWS 标签的 VPC ID

### 集群退役与业务影响 (38:00 - 45:00)

38:00 - 40:30 - 退役演示:讨论通过拉取请求删除基础设施的能力;强调 Adobe 花了多个季度才达到这种成熟度水平;像管理任何软件生命周期一样,需要通过基于 Git 的工作流设置保障措施,防止硬删除和意外或易错的步骤

40:30 - 42:00 - 安全措施:运行测试进行软件检查和输入验证;确保集群上没有强制执行的 PDB(Pod Disruption Budgets);检查入口控制器确保没有路由;所有这些都通过软件和可观测性驱动,而不是人工点击控制台;许多组织忘记了生命周期中最重要的部分 - 删除;如果不删除,将导致蔓延、浪费和安全问题

42:00 - 43:00 - 演示总结:再次强调没有使用控制台,所有操作都通过 Git 驱动

43:00 - 45:00 - 业务影响指标:这不仅仅是数字,而是关于工作如何转变开发文化并带来积极的业务成果;在 Adobe 的巨大规模下(450 个集群),需要自动化;通过该系统,能够在整个集群中部署更改的速度提高 3 倍,完整 Kubernetes 集群升级速度提高 2 倍;配置时间减少 25%;开发者对集群管理系统的反馈非常积极

### 经验教训与总结 (45:00 - 结束)

45:00 - 46:00 - 核心经验分享:John 分享经验教训,帮助其他人避免 Adobe 经历的痛苦和试验

46:00 - 47:00 - Kubernetes 投资:Kubernetes 是你的朋友,但任何友谊都需要投资;如果不投资,可能就不再有朋友;投资方式是培养团队对 Kubernetes 的知识,使他们在平台工程方面达到所需水平

47:00 - 48:00 - 自动化必要性:在大规模环境下,不可能让人工在事件之间发出信号;需要基于 GitOps 的工作负载来减少人工错误并加速交付

48:00 - 49:30 - 社区参与:有一个充满活力的文化和社区可以采用,不必从头开始构建所有内容;Adobe 全面拥抱云原生计算基金会(CNCF);2024 年,Adobe 因对社区的贡献获得了最高终端用户奖

49:30 - 50:30 - 平台即产品:终端用户不应该直接使用或暴露于这样的系统;应该像对待产品一样对待平台,不仅要进行常规维护和保持更新,还应该与开发者交流,询问他们是否喜欢该系统,是否达到预期,如何迭代改进

50:30 - 51:30 - 可重复性与灵活性:Cookie cutter(模板化)方法可以扩展,但就像面包店有各种不同的饼干一样,每个系统都有自己独特的挑战和业务需求;需要准备好可重复的标准化设置,无论部署目标或云提供商如何

51:30 - 52:30 - 最终目标:这种系统使开发者更快乐;更快乐的开发者带来更快乐、更高效的团队;更高效的团队带来更好的业务成果和更快乐的客户,这是最终目标

52:30 - 54:00 - Goro 总结发言:感谢 John;推荐参加其他 re:Invent 多云主题会议;提到 AWS Village 有多云展台,可以观看现场演示并与云专家讨论用例;提供 QR 码链接到多云旅程的精选资源

54:00 - 结束 - 会议结束:请求参会者完成会议调查并提供反馈;Goro 和 John 在会后可回答问题