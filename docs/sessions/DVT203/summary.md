# AWS re:invent 2025 基础设施即代码年度回顾会议总结

## 会议概述

本次会议是AWS re:invent 2025大会第一天的基础设施即代码(Infrastructure as Code, IaC)年度回顾专场。两位演讲者Akash(AWS基础设施即代码团队高级产品经理)和Prrenita Prakash(开发者工具组织高级产品经理,负责CDK和Amplify)向与会者介绍了AWS在IaC领域的最新创新和发展方向。

会议强调,到2025年,基础设施即代码已不再是云开发的可选项,而是构建和管理云端严肃应用的首选机制。演讲者们分享了多项新功能和创新,旨在提升云部署速度,同时加强安全性和合规性。会议内容涵盖了从开发者体验改进、应用安全演进,到平台团队标准化管理,以及AI时代IaC的未来趋势等多个维度。

会议特别关注三大主题:让IaC构建更快速、管理更简单、治理更安全。通过一系列实际案例和产品演示,展示了AWS如何帮助组织在扩展云使用规模的同时,保持开发敏捷性和安全合规性。

## 详细时间线与关键要点

### 开场与背景介绍 (00:00 - 05:30)

00:00 - 会议开始,欢迎参会者参加re:invent 2025第一天的活动

01:15 - Akash自我介绍,说明其负责AWS基础设施即代码团队的核心产品,专注于帮助客户安全地扩展AWS使用

01:45 - Prrenita自我介绍,介绍其负责CDK和Amplify等开发者工具产品

02:30 - 互动环节:询问参会者关注的重点
- 扩展云使用而不造成合规问题
- 默认安全而非事后补救
- 加快基础设施即代码应用构建速度

03:45 - 会议议程说明:
1. IaC基础概念回顾
2. 开发者体验改进的最新发布
3. 应用安全演进
4. 平台和安全团队的标准化
5. AI趋势下IaC的变化

### IaC基础概念回顾 (05:30 - 12:00)

05:45 - IaC定义:通过配置文件或模板对基础设施建模的实践

06:30 - AWS在2011年推出CloudFormation,开创IaC先河,解决三大关键需求:
- 在新账户和区域复制基础设施
- 对运行中的应用进行安全可预测的更新
- 版本化基础设施状态并审计变更

07:45 - AWS IaC产品组合介绍:
- CloudFormation作为核心IaC服务
- Resource Registry连接数百个AWS功能
- AWS Cloud Control API支持第三方工具
- CDK和Amplify等高级工具

09:00 - CDK(Cloud Development Kit)详细介绍:
- 支持TypeScript、JavaScript、Python、C#、Golang等多种编程语言
- 提供三层构造(Constructs):L1、L2、L3
- L1最接近CloudFormation资源类型
- L2组合多个资源形成功能组件
- L3组合多个资源形成完整架构

11:00 - IaC民主化趋势:
- 平台团队希望分散基础设施管理责任
- 构建开发者平台帮助应用团队自信运行IaC工作流
- GenAI工具使生成IaC代码变得更容易

### 开发者体验改进 (12:00 - 20:30)

12:30 - 典型开发者工作流程介绍:
- CDK开发者:寻找模式 → 使用CDK CLI转换为CloudFormation模板 → 部署
- CloudFormation开发者:编写模板 → 调用CloudFormation服务部署

13:45 - 新功能发布:AWS Toolkit插件改进
- 支持Visual Studio、VS Code和IntelliJ IDEA
- 提供自动完成和悬停文档功能
- 自动运行语法验证工具
- 捕获安全最佳实践缺失

16:00 - 新功能发布:部署前错误验证
- 在变更集创建时检测错误,而非部署时
- 支持三种错误类型:资源命名冲突、无效属性值、删除非空存储桶
- 控制台提供验证结果标签页,显示详细错误描述和代码行号

18:30 - 传统部署流程问题:创建变更集 → 执行 → 发现错误 → 回滚,反馈循环过长

19:45 - 新验证功能将错误检测左移至变更集创建阶段,大幅缩短反馈时间

### 应用安全演进 (20:30 - 32:00)

21:00 - IaC作为大规模混乱的防护盾:
- 支持代码审查
- 版本化基础设施变更
- 通过CI/CD管道和测试环境部署

22:15 - 漂移(Drift)问题介绍:
- 场景:开发者A通过IaC部署,开发者B通过控制台手动修改
- 后果:实际状态与模板定义不一致,导致意外变更、难以复现、合规违规

24:30 - 重大发布:Drift-aware Change Sets(漂移感知变更集)
- 三方比较:实际资源状态、新模板定义、上次部署的模板定义
- 检测漂移覆盖,修复意外覆盖
- 执行变更集使资源与新模板定义同步

26:00 - 实际案例演示:
- 应用故障:Lambda函数从S3读取,对象每天过期,CloudWatch告警监控
- 故障排查:控制台将过期时间改为100天,删除告警,发现Lambda超时问题
- 解决方案:将Lambda超时改为20秒

28:45 - 使用漂移感知变更集恢复:
- 更新模板中Lambda超时设置
- 创建漂移感知变更集
- CloudFormation自动检测:告警需重建、Lambda已更新、S3需重置
- 属性级视图显示详细变更

31:00 - 执行变更集后,应用恢复健康状态并与模板同步

### 应用持续演进 (32:00 - 38:30)

32:30 - 应用持续变化的现实:新需求、安全指导、产品经理要求

33:15 - CDK应用重构挑战案例:
- 初始状态:单体Lambda函数连接三个表
- 重构需求:拆分为三个独立Lambda函数,从L1升级到L2构造
- 传统问题:CloudFormation会删除并重建资源,导致数据丢失

35:00 - 新功能发布:CDK Refactor和CloudFormation Refactor
- 使IaC开发更接近软件开发
- 支持重命名构造、在堆栈间移动资源、升级L1到L2或L3
- 使用cdk refactor命令(带--unstable-fact标志,当前为预览版)

36:45 - 工作原理:
- 映射已部署应用的构造到本地应用
- 识别资源移动而非替换操作
- 通知CloudFormation重新映射逻辑ID到物理ID,无需重新部署

### 简化和治理IaC工作流 (38:30 - 48:00)

38:45 - 简化与治理的定义:
- 简化:开发者使用模式或护栏快速行动,减少决策
- 治理:平台团队保持控制、设定标准、分享最佳实践,不阻碍开发者

40:00 - CDK构造系统的挑战:
- L2构造覆盖不足
- L2是完全构建的不透明抽象,包含大量逻辑但不可组合
- 每个新服务或功能需要等待AWS CDK团队构建L2

42:15 - L2构造的"围墙花园"问题:
- 功能无法独立使用
- 跨服务重复实现(如加密)
- 通过继承而非组合工作

44:00 - 新功能发布:CDK Mixins库(预览版)
- 可组合、可重用的抽象
- 适用于任何级别的构造
- 不再局限于L2,可与L1混合使用
- 支持加密、日志、自动删除、授权、指标、标签等跨领域功能

46:30 - 示例:使用encryptionAtRest mixin与L1 S3存储桶

### 主动控制与治理 (48:00 - 58:00)

48:15 - 平台工程师的挑战:
- 赋能应用团队独立行动
- 避免成为每次变更的瓶颈
- 防止配置错误造成安全风险

49:30 - 传统安全工具的局限:
- 反应式:资源配置后才检查
- 生成告警需要平台/安全团队响应
- 反馈循环长,需要重新部署

50:45 - CloudFormation Hooks功能:
- 在部署前检测配置错误
- 支持多个调用点:资源配置前、部署开始时、变更集创建时
- 支持Cloud Control API操作,跨IaC工具一致执行控制

52:30 - 新功能发布:Hooks与AWS Controls Catalog集成
- 预定义安全最佳实践
- 直接在CloudFormation控制台可用
- 显示控制目标和安全框架映射
- 三次点击即可为账户所有CloudFormation部署启用控制

54:15 - 多账户架构与Stack Sets:
- 用于账户基线配置
- 将IaC模板复制到多个账户或区域
- 与AWS Organizations集成,自动部署到新账户

56:00 - 新功能发布:Stack Sets依赖关系
- 支持将基础设施拆分为多个组件(网络、身份、应用)
- 定义Stack Set间的依赖关系
- CloudFormation自动处理部署顺序
- 示例:网络依赖身份,应用依赖网络和身份

57:30 - 主动控制与着陆区的组合提供纵深防御策略,在保持开发者创新空间的同时确保云环境安全

### 会议总结 (58:00 - 结束)

58:00 - 回顾会议要点:
- 创作和验证功能帮助更快构建
- 漂移管理和重构功能帮助安全演进应用
- Mixins和主动控制帮助简化和治理工作流

会议展示了AWS IaC工具链的全面升级,从开发者日常工作效率到企业级治理能力,都有显著提升。