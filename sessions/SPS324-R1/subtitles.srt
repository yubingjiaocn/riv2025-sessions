1
00:00:00,257 --> 00:00:01,090
- [Kris] Great.

2
00:00:01,090 --> 00:00:02,540
Great that you're all here.

3
00:00:02,540 --> 00:00:05,010
So, I hope you're all excited to be here.

4
00:00:05,010 --> 00:00:06,750
And I hope you're excited to learn

5
00:00:06,750 --> 00:00:08,710
about all the new products
and services and features

6
00:00:08,710 --> 00:00:10,580
and all that here at reInvent.

7
00:00:10,580 --> 00:00:12,939
Is anyone excited?

8
00:00:12,939 --> 00:00:13,450
I saw you could raise your hands.

9
00:00:13,450 --> 00:00:15,550
I saw that earlier.

10
00:00:15,550 --> 00:00:17,609
Yeah, there you go.

11
00:00:17,609 --> 00:00:18,250
That's one.

12
00:00:18,250 --> 00:00:18,620
And tell me again.

13
00:00:18,620 --> 00:00:20,910
Just, no, indeed, raise those arms.

14
00:00:20,910 --> 00:00:23,210
You're going to be doing this
a lot of times this week.

15
00:00:24,240 --> 00:00:26,520
But who here is excited
to use those new services,

16
00:00:26,520 --> 00:00:28,910
and features when they get back home

17
00:00:28,910 --> 00:00:30,279
or back at the office, of course?

18
00:00:32,170 --> 00:00:35,730
But who of you also has some
rework that needs to get done?

19
00:00:37,739 --> 00:00:39,230
So, who here has a backlog,

20
00:00:39,230 --> 00:00:41,050
who'd like to use those
services, but still,

21
00:00:41,050 --> 00:00:43,179
there's something to do?

22
00:00:43,179 --> 00:00:44,040
There you go.

23
00:00:44,040 --> 00:00:44,040
All right.

24
00:00:44,040 --> 00:00:46,030
This is Matteo Palazzi,
and I'm Kris Nielander.

25
00:00:46,030 --> 00:00:48,640
No, I'm sorry about that.

26
00:00:48,640 --> 00:00:49,370
We're professional services consultants

27
00:00:49,370 --> 00:00:51,940
for AWS Professional Services.

28
00:00:51,940 --> 00:00:54,950
And as consultants, we're
working on the clock.

29
00:00:54,950 --> 00:00:57,040
And we need to get things
right the first time,

30
00:00:57,040 --> 00:00:59,480
every time, quality, security.

31
00:00:59,480 --> 00:01:01,670
But it's not only us.

32
00:01:01,670 --> 00:01:02,030
It's the team as well.

33
00:01:02,030 --> 00:01:03,389
So, it's partners.

34
00:01:03,389 --> 00:01:04,779
It's customers.

35
00:01:04,779 --> 00:01:05,550
It's you.

36
00:01:05,550 --> 00:01:08,559
And today, we're going
to show you how we do

37
00:01:08,559 --> 00:01:11,090
and how you can accelerate
your code delivery

38
00:01:11,090 --> 00:01:13,410
by using development containers

39
00:01:13,410 --> 00:01:15,850
with Amazon AI Code Assistant.

40
00:01:17,310 --> 00:01:19,430
But before we get into
that, I just want to know.

41
00:01:19,430 --> 00:01:22,020
So, are there any other
consultants here as well?

42
00:01:23,059 --> 00:01:24,719
No?

43
00:01:24,719 --> 00:01:24,719
Engineers?

44
00:01:24,719 --> 00:01:25,630
- One.
- Oh, one.

45
00:01:25,630 --> 00:01:27,529
Okay.

46
00:01:27,529 --> 00:01:27,760
We've got some engineers as well.

47
00:01:27,760 --> 00:01:28,979
Have we got my security people as well?

48
00:01:30,330 --> 00:01:32,110
Ah, yeah.

49
00:01:32,110 --> 00:01:34,429
Wonderful, wonderful.

50
00:01:34,429 --> 00:01:34,940
But actually, a more important question.

51
00:01:34,940 --> 00:01:37,410
Is there anyone here already
using development containers?

52
00:01:39,639 --> 00:01:41,710
Ah, good, good, good.

53
00:01:41,710 --> 00:01:44,419
Well, no worries.

54
00:01:44,419 --> 00:01:44,419
We'll go through the basics as well.

55
00:01:44,419 --> 00:01:47,440
So, everyone's on the same page.

56
00:01:47,440 --> 00:01:48,470
One final remark.

57
00:01:48,470 --> 00:01:50,509
This is a code talk.

58
00:01:50,509 --> 00:01:50,800
And I don't know if you've
done a code talk before,

59
00:01:50,800 --> 00:01:52,460
if you've attended one.

60
00:01:52,460 --> 00:01:54,580
But it's like a long live demo.

61
00:01:54,580 --> 00:01:57,170
So, we'll be doing coding
and stuff like that.

62
00:01:57,170 --> 00:01:58,710
And hopefully, you'll enjoy it.

63
00:01:58,710 --> 00:02:01,400
But it's also interactive.

64
00:02:01,400 --> 00:02:01,610
So, if you do have a question,

65
00:02:01,610 --> 00:02:05,901
we'll try to pause every now
and then so you can pop one in.

66
00:02:05,901 --> 00:02:07,340
And if we can't answer it,

67
00:02:07,340 --> 00:02:09,539
then you can approach us afterwards.

68
00:02:09,539 --> 00:02:11,509
That's also fine.

69
00:02:11,509 --> 00:02:13,499
Cool.

70
00:02:13,499 --> 00:02:14,900
All right.

71
00:02:14,900 --> 00:02:14,900
First thing, I really want to make sure

72
00:02:14,900 --> 00:02:17,850
we're all on the same page here.

73
00:02:17,850 --> 00:02:17,850
So let me set the stage.

74
00:02:17,850 --> 00:02:19,780
So, I want you to imagine
that it's Monday morning,

75
00:02:19,780 --> 00:02:22,309
maybe the Monday after reInvent.

76
00:02:22,309 --> 00:02:23,959
And indeed, you're excited to get to work

77
00:02:23,959 --> 00:02:26,330
to try those new services and features.

78
00:02:26,330 --> 00:02:29,050
But remember that pull request
you had from last week?

79
00:02:29,050 --> 00:02:31,780
Yeah, it got rejected.

80
00:02:31,780 --> 00:02:34,389
And as you're getting ready
to fix it, to mend it,

81
00:02:34,389 --> 00:02:36,750
now you have security
reaching out over Slack

82
00:02:36,750 --> 00:02:38,480
that they found an
overly permissive bucket.

83
00:02:38,480 --> 00:02:40,500
And you need to drop
everything and fix it?

84
00:02:40,500 --> 00:02:42,240
All right.

85
00:02:42,240 --> 00:02:44,659
Now it's Thursday.

86
00:02:44,659 --> 00:02:46,260
And you're everyone's hero.

87
00:02:46,260 --> 00:02:47,380
You mended your PR.

88
00:02:47,380 --> 00:02:49,940
You fixed the bucket.

89
00:02:49,940 --> 00:02:50,290
But it is Thursday already.

90
00:02:50,290 --> 00:02:52,280
And your sprint commitments
are in serious jeopardy.

91
00:02:53,540 --> 00:02:55,860
Does that sound plausible?

92
00:02:55,860 --> 00:02:57,559
I see some nodding heads.

93
00:02:57,559 --> 00:02:59,949
That's good.

94
00:02:59,949 --> 00:03:03,770
And it should, because 45%

95
00:03:03,770 --> 00:03:05,920
of production deployments
actually require rework.

96
00:03:07,370 --> 00:03:09,890
It's even higher.

97
00:03:09,890 --> 00:03:09,890
But I'll get to that in a little bit.

98
00:03:09,890 --> 00:03:11,679
Or rollbacks.

99
00:03:11,679 --> 00:03:14,450
And about that open S3 bucket,

100
00:03:14,450 --> 00:03:16,750
so we still have the
broken access controls

101
00:03:16,750 --> 00:03:19,360
on the OAuth top 10 at number one.

102
00:03:20,760 --> 00:03:23,470
Mind you, security
misconfigurations is at two.

103
00:03:23,470 --> 00:03:25,250
So, we're doing exceptionally well.

104
00:03:25,250 --> 00:03:28,620
But if you think you've
got everything tied down,

105
00:03:28,620 --> 00:03:31,990
your buckets are all
locked up, collectively,

106
00:03:31,990 --> 00:03:33,880
we pushed over 23 million secrets

107
00:03:33,880 --> 00:03:38,297
onto public GitHub repositories
over last year alone.

108
00:03:39,139 --> 00:03:40,923
We're not doing that well

109
00:03:40,923 --> 00:03:44,506
with private repositories
as well, so yeah.

110
00:03:47,040 --> 00:03:47,873
All right.

111
00:03:47,873 --> 00:03:50,219
Now, where do we want to be?

112
00:03:50,219 --> 00:03:52,500
So, imagine again that it's
that same Monday morning.

113
00:03:52,500 --> 00:03:54,910
But this time, you're
starting on a new project.

114
00:03:56,040 --> 00:03:58,220
And you're already delivering

115
00:03:58,220 --> 00:04:00,840
your first meaningful commit
that very same morning.

116
00:04:02,070 --> 00:04:03,780
No extensive rework.

117
00:04:03,780 --> 00:04:06,130
No security people knocking on your door.

118
00:04:06,130 --> 00:04:07,650
No onboarding issues.

119
00:04:07,650 --> 00:04:09,160
No runtime issues.

120
00:04:09,160 --> 00:04:10,180
That's where we want to be, right?

121
00:04:11,100 --> 00:04:12,809
Sounds ideal.

122
00:04:12,809 --> 00:04:13,880
We want to be one of those
elite engineering teams.

123
00:04:16,089 --> 00:04:17,410
All right.

124
00:04:17,410 --> 00:04:17,610
But what does that actually mean?

125
00:04:18,839 --> 00:04:21,480
So, I've got some numbers for you.

126
00:04:21,480 --> 00:04:23,090
Is anyone here familiar with Dora?

127
00:04:24,920 --> 00:04:26,330
I'm not talking about the little girl

128
00:04:26,330 --> 00:04:29,020
with the monkey in the boots, right?

129
00:04:29,020 --> 00:04:32,100
I'm also not talking about some
European legislative piece,

130
00:04:32,100 --> 00:04:33,390
right, for you security people.

131
00:04:34,420 --> 00:04:37,840
Now, this is a long-running
research program from Google

132
00:04:37,840 --> 00:04:41,080
about operational excellence
in software delivery.

133
00:04:42,040 --> 00:04:43,190
And so, this is a survey.

134
00:04:43,190 --> 00:04:45,389
It's been running for 10 years already.

135
00:04:45,389 --> 00:04:48,000
And since I have you all here,

136
00:04:48,000 --> 00:04:50,210
we can kind of repeat the survey.

137
00:04:50,210 --> 00:04:51,850
So, I'll ask you about the first category.

138
00:04:51,850 --> 00:04:53,440
That's a change lead time.

139
00:04:53,440 --> 00:04:55,120
That's how long it takes

140
00:04:55,120 --> 00:04:57,710
for a commit to go all
the way into production.

141
00:04:58,650 --> 00:05:00,310
So, I want to ask you to
raise your hands again

142
00:05:02,139 --> 00:05:05,119
and tell me, how long
does it take your teams?

143
00:05:05,119 --> 00:05:06,799
Months?

144
00:05:06,799 --> 00:05:08,600
From a commit all the way to production?

145
00:05:08,600 --> 00:05:10,230
No?

146
00:05:10,230 --> 00:05:10,727
Are you all good?

147
00:05:10,727 --> 00:05:12,310
- Sometimes.
- Sometimes.

148
00:05:12,310 --> 00:05:14,450
There you go.

149
00:05:14,450 --> 00:05:14,830
All right.

150
00:05:14,830 --> 00:05:16,389
Weeks?

151
00:05:16,389 --> 00:05:17,849
Yeah, that's more realistic, right?

152
00:05:18,869 --> 00:05:23,869
Is there anyone who can just
pull this off within a day?

153
00:05:24,240 --> 00:05:25,073
- [Member] Sometimes.

154
00:05:25,073 --> 00:05:26,140
- [Kris] Oh, you're elite, mate.

155
00:05:26,140 --> 00:05:28,600
You should be up there.

156
00:05:28,600 --> 00:05:29,610
We should be there.

157
00:05:29,610 --> 00:05:31,260
Right.

158
00:05:31,260 --> 00:05:31,720
No, but that is indeed how it is.

159
00:05:31,720 --> 00:05:36,209
We have the elite teams
taking under a day to do this,

160
00:05:37,250 --> 00:05:38,799
then moving towards the low performance,

161
00:05:38,799 --> 00:05:40,830
taking weeks up to months.

162
00:05:40,830 --> 00:05:42,930
I'm sorry, mate.

163
00:05:44,060 --> 00:05:46,640
But we get to improve.

164
00:05:46,640 --> 00:05:47,409
That's why you're here, right?

165
00:05:47,409 --> 00:05:48,750
All right, second thing
is deployment frequency.

166
00:05:48,750 --> 00:05:52,070
This is how often you would
actually deploy to production.

167
00:05:53,860 --> 00:05:58,849
So, are we talking about
once every few months again?

168
00:06:01,279 --> 00:06:02,690
I would expect the same hands.

169
00:06:02,690 --> 00:06:04,800
There you go.

170
00:06:04,800 --> 00:06:05,840
Once every few weeks?

171
00:06:07,440 --> 00:06:09,720
Yeah.

172
00:06:09,720 --> 00:06:10,130
All right.

173
00:06:10,130 --> 00:06:11,809
So, we got the elite teams
here just doing it on demand.

174
00:06:11,809 --> 00:06:13,770
Whenever you need it,
push there to production.

175
00:06:15,190 --> 00:06:17,459
And by the way, why is
this metric important?

176
00:06:17,459 --> 00:06:21,570
And this is one which is
important also with regards to AI.

177
00:06:21,570 --> 00:06:24,020
This is talking about how small
your commits actually are.

178
00:06:25,360 --> 00:06:28,910
Like, the smaller the
commit, the lower the risk,

179
00:06:28,910 --> 00:06:31,410
the less impact on production.

180
00:06:31,410 --> 00:06:32,780
And the funny thing is, with AI,

181
00:06:32,780 --> 00:06:34,000
you usually make very large commits.

182
00:06:35,760 --> 00:06:37,720
Cool.

183
00:06:37,720 --> 00:06:39,150
I'll spare you the other
metrics for the survey.

184
00:06:39,150 --> 00:06:41,650
But I'll tell you the
field deployment recovery.

185
00:06:41,650 --> 00:06:44,280
So, this is how long it
will actually take you to go

186
00:06:44,280 --> 00:06:48,680
from that bad situation onto
a normal operation again.

187
00:06:48,680 --> 00:06:52,260
And you have the elites typically
taking upwards of a day,

188
00:06:53,330 --> 00:06:58,040
where the low performers
taking maybe days to weeks

189
00:06:58,040 --> 00:07:00,460
to months just to restore a service.

190
00:07:00,460 --> 00:07:03,389
And this is, of course, impacting
your customer experience.

191
00:07:04,280 --> 00:07:06,389
And the last bit, the change fail rate,

192
00:07:06,389 --> 00:07:08,420
that's actually the metric
I had on the other slide.

193
00:07:08,420 --> 00:07:13,050
So, it's 45% to 60% of all
those production deployments

194
00:07:13,050 --> 00:07:16,480
either require rework or rollbacks.

195
00:07:16,480 --> 00:07:18,520
That's pretty significant.

196
00:07:18,520 --> 00:07:20,220
And you have the elite
teams typically around 15%.

197
00:07:21,309 --> 00:07:23,530
So, all right.

198
00:07:23,530 --> 00:07:25,899
That's nice numbers, right?

199
00:07:25,899 --> 00:07:26,990
So how do we get there?

200
00:07:28,330 --> 00:07:32,130
So, this is where dev containers
help remove the potholes

201
00:07:32,130 --> 00:07:33,560
to actually make you go fast.

202
00:07:37,100 --> 00:07:40,049
They enable you to create

203
00:07:42,690 --> 00:07:44,730
a consistent development environment

204
00:07:44,730 --> 00:07:48,199
with embedded quality
controls, with security checks,

205
00:07:49,189 --> 00:07:52,940
like having your static analysis tools.

206
00:07:52,940 --> 00:07:54,740
You've got your linters
that you can integrate.

207
00:07:54,740 --> 00:07:56,940
You've got your code
formatters, your scanners.

208
00:07:56,940 --> 00:08:00,040
All that can be integrated
within your dev container.

209
00:08:02,599 --> 00:08:07,410
But it's also the tool
to quickly help you adopt

210
00:08:07,410 --> 00:08:09,770
other tools, like Amazon Q Developer.

211
00:08:09,770 --> 00:08:11,580
And that helps accelerate your teams.

212
00:08:11,580 --> 00:08:15,070
It accelerates your onboarding.

213
00:08:15,070 --> 00:08:16,950
One final note on this, though,

214
00:08:16,950 --> 00:08:18,790
and if you read the Dora reports,

215
00:08:18,790 --> 00:08:20,640
they'll tell you there
is no silver bullet,

216
00:08:21,740 --> 00:08:23,160
which will improve everything.

217
00:08:23,160 --> 00:08:27,050
But dev containers will
definitely help you

218
00:08:27,050 --> 00:08:29,350
unlock those elite practices.

219
00:08:29,350 --> 00:08:33,139
So, that's how you should view this.

220
00:08:33,139 --> 00:08:35,900
All right, and that's what
we're going to talk about today.

221
00:08:35,900 --> 00:08:38,009
We're going to talk

222
00:08:38,009 --> 00:08:39,080
about how we can use those dev containers

223
00:08:39,080 --> 00:08:42,549
to actually make our AWS
projects, our deployments,

224
00:08:42,549 --> 00:08:45,360
all the better, and just
accelerate those deployments.

225
00:08:46,870 --> 00:08:49,060
And on the first bit,

226
00:08:49,060 --> 00:08:50,900
Matteo is going to explain a little bit

227
00:08:50,900 --> 00:08:53,150
about the anatomy of a dev container.

228
00:08:53,150 --> 00:08:54,700
So, what are the key components there?

229
00:08:54,700 --> 00:08:56,240
How is the configuration built up?

230
00:08:58,570 --> 00:09:00,590
In the second bit, he's going to talk

231
00:09:00,590 --> 00:09:04,670
about how you can integrate
Amazon Q, Q Developer,

232
00:09:04,670 --> 00:09:07,030
inside a dev container configuration

233
00:09:07,030 --> 00:09:09,099
and enable these complex workflows,

234
00:09:09,099 --> 00:09:11,130
which go over the rule-based stuff,

235
00:09:11,130 --> 00:09:13,099
which is usually in your
static analysis tools.

236
00:09:15,370 --> 00:09:18,890
The third bit is, because
we also want to scale,

237
00:09:18,890 --> 00:09:21,140
we want to enable some
kind of modular system

238
00:09:21,140 --> 00:09:22,370
within those development containers.

239
00:09:22,370 --> 00:09:25,770
And luckily, there's
development container features,

240
00:09:25,770 --> 00:09:27,660
which are like these
repeatable building blocks.

241
00:09:27,660 --> 00:09:30,529
So instead of adopting
it just for one image,

242
00:09:30,529 --> 00:09:31,810
you can use it for the
other, and for the other,

243
00:09:31,810 --> 00:09:33,893
and for the other, right?

244
00:09:35,160 --> 00:09:39,440
Now, to scale even
further, we'll also talk

245
00:09:39,440 --> 00:09:43,080
about creating a pipeline for
these development containers.

246
00:09:43,080 --> 00:09:44,650
So, it's no longer just you building it

247
00:09:44,650 --> 00:09:47,319
on your local laptop.

248
00:09:47,319 --> 00:09:48,290
It's building it inside a pipeline

249
00:09:48,290 --> 00:09:50,440
and to make sure these
images are available,

250
00:09:50,440 --> 00:09:53,440
images and features, for
anyone who needs them.

251
00:09:55,170 --> 00:09:58,270
And before I hand over the
floor to Matteo, again,

252
00:09:58,270 --> 00:10:00,060
I'd like to remind you,
it's an interactive session.

253
00:10:00,060 --> 00:10:04,842
So, if you do have a
question for us, pop one in.

254
00:10:04,842 --> 00:10:05,675
Matteo?

255
00:10:07,360 --> 00:10:08,679
- [Matteo] Thank you, Kris.

256
00:10:08,679 --> 00:10:13,410
So, as you very well said,
we as consultants need

257
00:10:13,410 --> 00:10:16,770
to be right the first time, all the times.

258
00:10:16,770 --> 00:10:21,000
And this means that we
need to take care about

259
00:10:21,000 --> 00:10:25,380
all the little problems,
all the little bits,

260
00:10:25,380 --> 00:10:30,380
before creating an artifact
for our customers, right?

261
00:10:30,449 --> 00:10:34,720
This means that we might
want to discover all

262
00:10:34,720 --> 00:10:38,360
of the problems before
a CICD pipeline starts

263
00:10:38,360 --> 00:10:40,770
and find that, right?

264
00:10:40,770 --> 00:10:45,230
So, it means that we want
to shift left all the checks

265
00:10:45,230 --> 00:10:47,410
into our development environment.

266
00:10:48,939 --> 00:10:52,540
So, what do we have here today?

267
00:10:52,540 --> 00:10:56,220
So here I have Visual Studio Code, right?

268
00:10:56,220 --> 00:10:57,469
Are you familiar with that?

269
00:10:57,469 --> 00:10:59,270
I think so.

270
00:11:00,770 --> 00:11:04,820
But how do we do shift left these checks?

271
00:11:04,820 --> 00:11:09,820
So, we use, it's pretty easy, right?

272
00:11:10,190 --> 00:11:11,890
Use dev containers.

273
00:11:11,890 --> 00:11:14,820
So, we create dev containers

274
00:11:14,820 --> 00:11:19,410
to standardize our development
environment across developers

275
00:11:19,410 --> 00:11:22,190
in the team, across teams,

276
00:11:22,190 --> 00:11:27,107
so we all get the same environment, okay?

277
00:11:28,350 --> 00:11:29,410
What is a dev container?

278
00:11:30,680 --> 00:11:32,650
You can guess it.

279
00:11:32,650 --> 00:11:34,639
It's a container, right?

280
00:11:34,639 --> 00:11:38,280
So as a container, we need
two main things to use it.

281
00:11:39,360 --> 00:11:41,380
One is the container runtime.

282
00:11:42,719 --> 00:11:43,790
You can use Docker.

283
00:11:43,790 --> 00:11:46,070
You can use Phinch.

284
00:11:46,070 --> 00:11:46,780
You can use Rancher.

285
00:11:46,780 --> 00:11:51,019
You can use whatever
container runtime you prefer.

286
00:11:52,650 --> 00:11:57,330
And the second thing is
an IDE that is compatible

287
00:11:57,330 --> 00:12:02,250
with dev containers,
like VS Code, IntelliJ,

288
00:12:02,250 --> 00:12:04,870
and many others.

289
00:12:04,870 --> 00:12:07,690
So, let's get into the demo.

290
00:12:09,420 --> 00:12:12,679
We have here a CDK application, right?

291
00:12:12,679 --> 00:12:14,450
You might be familiar with that.

292
00:12:14,450 --> 00:12:16,590
It doesn't matter, right?

293
00:12:16,590 --> 00:12:18,559
It's not the scope of the session today.

294
00:12:18,559 --> 00:12:22,450
We're not going to say how CDK works,

295
00:12:22,450 --> 00:12:24,790
how to deploy a stack with CDK.

296
00:12:24,790 --> 00:12:26,770
Doesn't matter.

297
00:12:26,770 --> 00:12:29,060
Just let's take it as a Python code.

298
00:12:30,380 --> 00:12:32,440
We want to create the environment

299
00:12:32,440 --> 00:12:37,440
to be effective developing
Python code, right, in this case.

300
00:12:37,650 --> 00:12:40,040
To do that, we need to
create a dev container.

301
00:12:40,040 --> 00:12:43,200
And the dev container needs to be inside.

302
00:12:43,200 --> 00:12:44,690
The dev container configuration needs

303
00:12:44,690 --> 00:12:46,840
to be inside a specific path.

304
00:12:48,110 --> 00:12:49,853
It needs to be inside

305
00:12:49,853 --> 00:12:54,180
.devcontainer/devcontainer.json, right?

306
00:12:54,180 --> 00:12:55,400
That's the config file.

307
00:12:56,360 --> 00:12:58,530
And the config file could be very easy

308
00:12:59,490 --> 00:13:01,880
or a bit more complex.

309
00:13:01,880 --> 00:13:05,509
In this case, you see that
there is only one line.

310
00:13:05,509 --> 00:13:07,440
It's quite easy, right?

311
00:13:07,440 --> 00:13:11,270
So, this is the image that
the container runtime will use

312
00:13:11,270 --> 00:13:16,069
to create a container that
the IDE will be connecting to.

313
00:13:19,040 --> 00:13:21,139
As you see on the screen,

314
00:13:21,139 --> 00:13:24,250
there are also other lines commented out.

315
00:13:24,250 --> 00:13:27,870
And let's go through them quickly.

316
00:13:28,940 --> 00:13:33,439
So, the first one is one
example of a lifecycle command.

317
00:13:34,860 --> 00:13:38,520
With dev containers, we
can use lifecycle events.

318
00:13:38,520 --> 00:13:42,360
It means that we can
run commands, scripts,

319
00:13:42,360 --> 00:13:46,469
based on the lifecycle event,
which means, for example,

320
00:13:46,469 --> 00:13:50,380
when you create a container,
after the creation,

321
00:13:50,380 --> 00:13:52,460
it's run a command.

322
00:13:52,460 --> 00:13:54,660
When you attach to the container,

323
00:13:54,660 --> 00:13:58,230
which is similar to
when you open the laptop

324
00:13:58,230 --> 00:14:00,099
in the morning and you start developing,

325
00:14:00,099 --> 00:14:03,070
so you attach to the
development environment,

326
00:14:03,070 --> 00:14:06,079
it might run another set of commands.

327
00:14:07,100 --> 00:14:11,460
Then you can also configure
your IDE setting, for example,

328
00:14:13,670 --> 00:14:16,270
the tab size in this example,

329
00:14:17,110 --> 00:14:19,400
or maybe installing some extensions.

330
00:14:21,490 --> 00:14:23,689
Lastly, we can add features.

331
00:14:25,480 --> 00:14:29,250
We will talk about features
in more details later

332
00:14:29,250 --> 00:14:31,600
during the session.

333
00:14:31,600 --> 00:14:32,230
But in this case,

334
00:14:32,230 --> 00:14:33,685
I want to show you

335
00:14:33,685 --> 00:14:38,250
how easy it is to create the container.

336
00:14:38,250 --> 00:14:41,369
So, we have this configuration file.

337
00:14:41,369 --> 00:14:46,369
And then we just reopen in container.

338
00:14:46,750 --> 00:14:50,210
And it will detect that

339
00:14:51,510 --> 00:14:53,679
the dev container JSON file is there.

340
00:14:53,679 --> 00:14:54,870
It will read it.

341
00:14:54,870 --> 00:14:57,353
And it will create a
container that the IDE

342
00:14:57,353 --> 00:14:59,139
will be connecting to.

343
00:14:59,139 --> 00:15:03,410
As you see here, I'm running on a Mac.

344
00:15:03,410 --> 00:15:04,880
And if I run here

345
00:15:07,340 --> 00:15:09,740
at uname-a, I'm in Linux.

346
00:15:09,740 --> 00:15:14,157
This is because I'm running
inside the dev container.

347
00:15:17,122 --> 00:15:18,289
But, you know,

348
00:15:21,070 --> 00:15:23,530
this is a very basic image.

349
00:15:23,530 --> 00:15:27,980
We want to have an effective
environment to develop.

350
00:15:27,980 --> 00:15:31,380
So, I've prepared another example.

351
00:15:32,559 --> 00:15:35,039
As I said before, the
dev container JSON file

352
00:15:35,039 --> 00:15:37,250
might be a bit complex.

353
00:15:37,250 --> 00:15:40,743
So, in this example,

354
00:15:40,743 --> 00:15:42,210
it is a bit more complex.

355
00:15:42,210 --> 00:15:43,830
Instead of using a single image,

356
00:15:43,830 --> 00:15:48,370
I'm referring to a Docker file inside

357
00:15:48,370 --> 00:15:49,670
the dev container directory.

358
00:15:49,670 --> 00:15:51,679
It's important.

359
00:15:51,679 --> 00:15:56,509
That Docker file is going to
build an image locally, okay.

360
00:15:56,509 --> 00:15:59,200
As we are talking about
a Python application,

361
00:15:59,200 --> 00:16:01,490
we need the Python VM.

362
00:16:01,490 --> 00:16:06,219
And the Python VM is based on the host

363
00:16:06,219 --> 00:16:08,889
that you are running on.

364
00:16:08,889 --> 00:16:11,490
So, for example, if I create
the Python VM on Mac OS,

365
00:16:11,490 --> 00:16:13,060
it's going to be different from the one

366
00:16:13,060 --> 00:16:15,790
that is going to be created on Linux.

367
00:16:16,830 --> 00:16:19,780
So, we want to create a VM all the times

368
00:16:19,780 --> 00:16:21,630
that we create the new container.

369
00:16:21,630 --> 00:16:25,719
Because otherwise, when
you clone the repo inside

370
00:16:25,719 --> 00:16:28,219
the container,

371
00:16:28,219 --> 00:16:30,480
it might have a different
virtual environment.

372
00:16:30,480 --> 00:16:31,820
And it could not work.

373
00:16:33,050 --> 00:16:37,420
The other things that we are
adding here are pip audit

374
00:16:38,489 --> 00:16:42,400
and pip licenses as part
of our security guidelines.

375
00:16:42,400 --> 00:16:46,799
And we run those commands
when we open our laptop,

376
00:16:46,799 --> 00:16:48,670
so when we connect to the container.

377
00:16:50,500 --> 00:16:53,990
I'm also adding some
configurations for the IDE.

378
00:16:53,990 --> 00:16:58,310
So, for example, I'm defining
the Python default formatter

379
00:17:00,080 --> 00:17:02,559
to black formatter that
is going to be installed

380
00:17:04,270 --> 00:17:08,569
as an extension together
with pylint and flakate.

381
00:17:08,569 --> 00:17:11,970
Of course, you can add all
the extensions you want.

382
00:17:11,970 --> 00:17:13,930
You can add formatters, linters,

383
00:17:13,930 --> 00:17:15,500
all the security tools you prefer.

384
00:17:16,609 --> 00:17:20,679
I'm also adding some features.

385
00:17:20,679 --> 00:17:23,869
In this case, I'm adding
the common utility features

386
00:17:23,869 --> 00:17:25,960
and the Python feature.

387
00:17:25,960 --> 00:17:28,900
All of them are going to
install other tools as part

388
00:17:28,900 --> 00:17:31,110
of the feature itself.

389
00:17:31,110 --> 00:17:36,110
And remote user is the user
that is inside the container.

390
00:17:36,150 --> 00:17:39,983
And it's connected to
the user on your laptop.

391
00:17:43,127 --> 00:17:43,960
Okay.

392
00:17:43,960 --> 00:17:47,310
So, as you see here, I'm starting from,

393
00:17:48,230 --> 00:17:51,940
let's say, a vanilla VS code.

394
00:17:51,940 --> 00:17:55,559
There's nothing in it except
the dev container extension.

395
00:17:55,559 --> 00:17:57,149
Of course, otherwise it doesn't work.

396
00:17:58,600 --> 00:18:03,469
And if we connect to the container now,

397
00:18:05,240 --> 00:18:07,960
it will load this configuration

398
00:18:07,960 --> 00:18:12,960
that has quite a big amount of settings.

399
00:18:13,009 --> 00:18:14,389
And you will see popping up

400
00:18:14,389 --> 00:18:16,959
on the left-hand side
some extension icons.

401
00:18:16,959 --> 00:18:18,459
You see Python now

402
00:18:20,730 --> 00:18:22,730
and also testing, right?

403
00:18:25,555 --> 00:18:28,809
So, it's also running the commands

404
00:18:28,809 --> 00:18:31,520
that you have seen before.

405
00:18:31,520 --> 00:18:35,919
The post attach commands
and the on create commands,

406
00:18:37,250 --> 00:18:39,100
just to be sure that, for example,

407
00:18:39,100 --> 00:18:41,830
the licenses are up to
date with the packages

408
00:18:41,830 --> 00:18:45,913
that we are using inside
this project, right.

409
00:18:49,400 --> 00:18:54,339
As I have added the Python feature,

410
00:18:57,520 --> 00:19:00,830
we are going to see that
the virtual environment

411
00:19:00,830 --> 00:19:03,110
is loaded automatically.

412
00:19:03,990 --> 00:19:05,729
And we should see now,

413
00:19:08,370 --> 00:19:10,640
yeah, they are.

414
00:19:10,640 --> 00:19:12,440
Here they are.

415
00:19:12,440 --> 00:19:12,870
Some problems in this file.

416
00:19:12,870 --> 00:19:15,850
So, I thought to have written a good file.

417
00:19:16,830 --> 00:19:18,480
No, I hadn't.

418
00:19:20,179 --> 00:19:23,090
So, we need to refactor this file.

419
00:19:23,090 --> 00:19:24,860
Otherwise, the CICD pipeline would fail.

420
00:19:26,429 --> 00:19:30,289
Because in the CICD pipeline,
we will have all the checks.

421
00:19:31,179 --> 00:19:33,926
So, let's go and refactor this.

422
00:19:33,926 --> 00:19:37,426
To refactor this, we need to add Amazon Q.

423
00:19:39,980 --> 00:19:42,429
To add Amazon Q, we need
to add the extension.

424
00:19:42,429 --> 00:19:47,429
So, if you don't remember the
extension ID, I don't, okay.

425
00:19:48,049 --> 00:19:51,430
So, I just search Amazon Q.

426
00:19:52,970 --> 00:19:57,680
And then you can simply do
add to devcontainer.json.

427
00:20:00,250 --> 00:20:05,250
What it does is you will see down here.

428
00:20:05,369 --> 00:20:07,269
Right?

429
00:20:07,269 --> 00:20:10,120
So, you can dynamically
update the JSON file.

430
00:20:11,170 --> 00:20:15,320
Then, do we want to use Amazon Q as it is?

431
00:20:15,320 --> 00:20:17,789
No, we don't.

432
00:20:17,789 --> 00:20:21,870
We want to add some context
to Amazon Q in order

433
00:20:21,870 --> 00:20:23,100
to perform better.

434
00:20:24,400 --> 00:20:29,350
To do that, we create an MD
file that is going to be used

435
00:20:31,130 --> 00:20:35,679
as a rule for Amazon Q developer.

436
00:20:35,679 --> 00:20:40,179
And we want to make it inside
the devcontainer, right?

437
00:20:41,580 --> 00:20:46,580
So, we need to add it to
the .devcontainer directory.

438
00:20:49,050 --> 00:20:52,458
And we also need,

439
00:20:52,458 --> 00:20:55,280
I don't want to write it down.

440
00:20:55,280 --> 00:20:56,890
So, I'm going to copy it.

441
00:20:58,550 --> 00:21:00,740
Where is it?

442
00:21:00,740 --> 00:21:00,859
Here.

443
00:21:00,859 --> 00:21:04,442
So, we add this command
to the post create.

444
00:21:06,940 --> 00:21:11,479
It does create the
.amazonq rules at the root

445
00:21:12,480 --> 00:21:14,380
of the project.

446
00:21:14,380 --> 00:21:17,789
It's a mandatory path, okay?

447
00:21:17,789 --> 00:21:22,550
And then it copies the MD
file into that directory.

448
00:21:25,090 --> 00:21:27,639
What do we have in the MD file?

449
00:21:27,639 --> 00:21:30,950
So, we are setting just general rules.

450
00:21:30,950 --> 00:21:35,950
We want to have all the
Python files with the header,

451
00:21:36,389 --> 00:21:38,780
with the copyright and the license.

452
00:21:39,920 --> 00:21:44,410
We want to have all the
functions with the doc string.

453
00:21:44,410 --> 00:21:47,610
We want to have all the Python files

454
00:21:47,610 --> 00:21:51,380
to be compliant with that page, right.

455
00:21:51,380 --> 00:21:53,460
It's just an example.

456
00:21:53,460 --> 00:21:54,720
You can add whatever you want.

457
00:21:54,720 --> 00:21:58,640
Okay, so now we need to
rebuild the container in order

458
00:21:58,640 --> 00:22:03,640
to have this inside the container.

459
00:22:04,000 --> 00:22:06,209
So, we do rebuild container.

460
00:22:10,440 --> 00:22:13,360
It's going to, let's
say, start from scratch

461
00:22:14,240 --> 00:22:19,240
and rebuild the Docker image,
most probably cached, right?

462
00:22:19,860 --> 00:22:22,500
And then install all the features,

463
00:22:22,500 --> 00:22:25,429
run all the post create commands,

464
00:22:25,429 --> 00:22:27,880
including the amazonq command.

465
00:22:28,910 --> 00:22:30,940
And you see here,

466
00:22:30,940 --> 00:22:35,330
it's going to rebuild
the Python environment.

467
00:22:35,330 --> 00:22:37,030
It might take a while.

468
00:22:37,030 --> 00:22:39,250
Did you save it?

469
00:22:39,250 --> 00:22:39,843
Oh, damn it.

470
00:22:39,843 --> 00:22:42,176
(Kris laughing)

471
00:22:42,176 --> 00:22:43,009
- [Kris] That's a classic.

472
00:22:43,009 --> 00:22:45,230
- [Matteo] It's not going
to solve all the problems.

473
00:22:45,230 --> 00:22:50,179
Some problems are between the
chair and the laptop, right?

474
00:22:50,179 --> 00:22:53,229
- [Kris] You're going
to need some help there.

475
00:22:53,229 --> 00:22:54,420
- [Matteo] Yeah, right.

476
00:22:54,420 --> 00:22:56,180
We'll just enable auto saving.

477
00:22:57,290 --> 00:23:01,660
So conscious of time, I'm
going to comment this out.

478
00:23:03,179 --> 00:23:05,289
Because as I said before,

479
00:23:05,289 --> 00:23:08,620
it's important to create VM, right?

480
00:23:09,540 --> 00:23:12,750
Or in this case, as we are starting

481
00:23:12,750 --> 00:23:14,960
from the container already,

482
00:23:14,960 --> 00:23:17,230
it's not mandatory to rebuild it.

483
00:23:17,230 --> 00:23:20,969
So, I'm gonna-
- Save that one as well.

484
00:23:20,969 --> 00:23:25,359
- [Matteo] I'm going to
rebuild the container.

485
00:23:25,359 --> 00:23:28,280
It should take

486
00:23:28,280 --> 00:23:29,113
less time.

487
00:23:30,660 --> 00:23:31,493
Okay.

488
00:23:32,809 --> 00:23:33,976
Thanks, Chris.

489
00:23:36,080 --> 00:23:36,913
Okay.

490
00:23:38,410 --> 00:23:40,660
It's building.

491
00:23:40,660 --> 00:23:42,270
Fantastic.

492
00:23:42,270 --> 00:23:44,230
We will see that now it's going to run,

493
00:23:47,270 --> 00:23:49,740
you see here,

494
00:23:49,740 --> 00:23:53,550
the amazonq, the copy of amazonq
rules inside the directory.

495
00:23:53,550 --> 00:23:58,100
And if we refresh, we
see amazonq here, right?

496
00:23:59,010 --> 00:24:00,529
With the best practices file.

497
00:24:03,380 --> 00:24:06,860
And also, we should see amazonq.

498
00:24:06,860 --> 00:24:09,430
Fantastic.

499
00:24:09,430 --> 00:24:10,079
We have amazonq.

500
00:24:10,079 --> 00:24:11,530
We need to log in.

501
00:24:12,469 --> 00:24:14,710
Let's log in.

502
00:24:14,710 --> 00:24:15,759
Proceed to browser.

503
00:24:15,759 --> 00:24:16,829
- [Kris] The key thing here

504
00:24:16,829 --> 00:24:18,370
is that the dev container is kind

505
00:24:18,370 --> 00:24:19,540
of independent from the repository.

506
00:24:20,850 --> 00:24:23,580
So, you tie them two together,
and then the repository

507
00:24:23,580 --> 00:24:25,920
gets whatever context
for amazonq you define

508
00:24:25,920 --> 00:24:29,270
in that dev container inside the repo.

509
00:24:29,270 --> 00:24:31,650
So, you can essentially define a context

510
00:24:31,650 --> 00:24:32,650
and manage that context.

511
00:24:34,209 --> 00:24:36,137
And that's really powerful.

512
00:24:36,137 --> 00:24:36,970
- [Matteo] Okay.

513
00:24:36,970 --> 00:24:40,280
So now we can refactor the|Python file.

514
00:24:40,280 --> 00:24:43,100
So, let's ask amazonq to do that.

515
00:24:43,100 --> 00:24:43,933
Refactor.

516
00:24:47,469 --> 00:24:49,920
It's going to take the entire file.

517
00:24:49,920 --> 00:24:51,540
And as a context,

518
00:24:51,540 --> 00:24:54,310
we see that we have also
the best practices MD file.

519
00:24:56,220 --> 00:25:01,010
And as you see here, I'm
having the new comments

520
00:25:01,010 --> 00:25:03,490
at the top of the file, the new header.

521
00:25:03,490 --> 00:25:05,309
And it's well formatted.

522
00:25:05,309 --> 00:25:07,179
We have all the module doc strings.

523
00:25:08,210 --> 00:25:09,929
Ready to go.

524
00:25:09,929 --> 00:25:13,450
Most probably, the CICD
pipeline won't fail.

525
00:25:15,440 --> 00:25:17,850
But

526
00:25:17,850 --> 00:25:20,300
we have done it here, locally.

527
00:25:20,300 --> 00:25:24,050
Inside this only container, right,

528
00:25:25,091 --> 00:25:26,660
it doesn't scale.

529
00:25:26,660 --> 00:25:29,889
We need to create this building block

530
00:25:29,889 --> 00:25:33,440
that could be shared between people.

531
00:25:34,670 --> 00:25:39,139
And to do that, we switch to features.

532
00:25:40,059 --> 00:25:44,820
So, features are the building
blocks that can be packaged

533
00:25:46,020 --> 00:25:51,020
and be shareable between
developers and teams,

534
00:25:51,430 --> 00:25:53,940
between other dev containers at the end.

535
00:25:55,300 --> 00:25:58,120
So, to do that,

536
00:25:58,120 --> 00:26:02,710
we need to create a folder
inside dev container named

537
00:26:04,230 --> 00:26:06,209
as the feature.

538
00:26:06,209 --> 00:26:08,490
So that is going to be the feature name.

539
00:26:10,090 --> 00:26:14,660
And as this is going to
take a while to build,

540
00:26:15,820 --> 00:26:17,469
I'm going to do that.

541
00:26:17,469 --> 00:26:20,020
One thing I want to highlight is that,

542
00:26:20,020 --> 00:26:23,580
as you see here in the config file,

543
00:26:23,580 --> 00:26:25,780
I've commented out the copy amazonq rules

544
00:26:25,780 --> 00:26:28,260
that we used before.

545
00:26:28,260 --> 00:26:30,200
So, we don't need that anymore.

546
00:26:30,200 --> 00:26:32,720
As we don't need amazonq anymore,

547
00:26:32,720 --> 00:26:36,889
because it's going to
be part of the feature.

548
00:26:36,889 --> 00:26:41,147
So, I'm going to rebuild it,

549
00:26:41,147 --> 00:26:44,760
including the local feature.

550
00:26:44,760 --> 00:26:47,650
So, you can reference
local features this way.

551
00:26:47,650 --> 00:26:49,169
You just provide a path.

552
00:26:50,439 --> 00:26:54,890
And it's going to be included
inside the dev container.

553
00:26:56,870 --> 00:27:00,530
So, let's switch here on the terminal.

554
00:27:00,530 --> 00:27:03,440
I'm going to show you what files we need

555
00:27:03,440 --> 00:27:05,540
to create a feature.

556
00:27:06,790 --> 00:27:10,290
Essentially, we need two
files, at least two files.

557
00:27:11,320 --> 00:27:13,719
One, it's named install.sh.

558
00:27:15,450 --> 00:27:20,030
And by the way, these two files
need to be named this way.

559
00:27:20,030 --> 00:27:21,760
Okay, it's important.

560
00:27:21,760 --> 00:27:26,320
And the install.sh is just
an installation script

561
00:27:26,320 --> 00:27:29,139
that will install the tool
you need, essentially.

562
00:27:29,139 --> 00:27:33,556
In this case, it's going to
create the amazonq rules.

563
00:27:35,469 --> 00:27:37,344
The other important file

564
00:27:37,344 --> 00:27:41,518
is the dev container feature JSON, right.

565
00:27:41,518 --> 00:27:46,230
This is the configuration
file for the feature.

566
00:27:46,230 --> 00:27:48,340
It requires a semantic versioning.

567
00:27:49,280 --> 00:27:53,920
You can use the same
blocks as you used inside

568
00:27:55,420 --> 00:27:59,100
the devcontainer.json file
for the dev container itself.

569
00:27:59,100 --> 00:28:02,399
So, for example, here I'm
installing the extension amazonq,

570
00:28:03,450 --> 00:28:07,549
as we were doing before
inside the dev container.

571
00:28:07,549 --> 00:28:10,100
And also, I'm moving

572
00:28:10,100 --> 00:28:14,670
the amazonq rules inside the repository.

573
00:28:16,220 --> 00:28:18,790
That's an important
thing, because otherwise,

574
00:28:18,790 --> 00:28:23,300
when you create the container,
you create the rules.

575
00:28:23,300 --> 00:28:28,300
But the repository is not mounted
inside the repository yet.

576
00:28:28,539 --> 00:28:32,720
So, when it mounts inside,
it will override everything.

577
00:28:32,720 --> 00:28:35,050
When you mount a file
system over a mount point,

578
00:28:35,050 --> 00:28:36,780
if you have something in that mount point,

579
00:28:38,340 --> 00:28:40,922
it won't be accessible anymore.

580
00:28:40,922 --> 00:28:45,000
So, these are the two important things.

581
00:28:45,000 --> 00:28:46,990
The two important files.

582
00:28:46,990 --> 00:28:49,940
Let's see if it's built.

583
00:28:49,940 --> 00:28:51,560
Oh yeah, it's built.

584
00:28:51,560 --> 00:28:53,210
Perfect.

585
00:28:53,210 --> 00:28:57,559
So now we see that we have
amazonq now here as part

586
00:28:58,969 --> 00:29:00,139
of the repository.

587
00:29:01,559 --> 00:29:05,289
And it's the new one.

588
00:29:05,289 --> 00:29:09,870
I've added the label inside
the file of the feature.

589
00:29:11,940 --> 00:29:15,740
You see here, this is
actually the same file

590
00:29:15,740 --> 00:29:20,120
we have in the actual .amazonq rules file.

591
00:29:21,520 --> 00:29:25,440
So, we have created finally the feature,

592
00:29:27,870 --> 00:29:30,120
but it's still local.

593
00:29:30,120 --> 00:29:32,970
So, this is the development
process to create a feature

594
00:29:32,970 --> 00:29:36,303
that is going to be reusable afterwards.

595
00:29:37,147 --> 00:29:39,730
To create the reusable feature,

596
00:29:40,730 --> 00:29:45,310
we need to package and
create an image for that.

597
00:29:46,850 --> 00:29:50,100
So, we have created a factory for that.

598
00:29:51,330 --> 00:29:54,650
Kris will tell you more about it later.

599
00:29:54,650 --> 00:29:59,233
And I want to show you one
thing that is, the last one,

600
00:30:00,840 --> 00:30:04,706
and that is, let's say,

601
00:30:04,706 --> 00:30:08,120
the outcome of that factory.

602
00:30:08,120 --> 00:30:13,120
So, we have seen the dev
container config file,

603
00:30:13,137 --> 00:30:14,540
the feature,

604
00:30:14,540 --> 00:30:17,170
and if we condense everything together,

605
00:30:17,170 --> 00:30:19,140
we create one image, right.

606
00:30:19,140 --> 00:30:21,840
And that one image is this one.

607
00:30:21,840 --> 00:30:25,590
So, you can think, I mentioned before,

608
00:30:25,590 --> 00:30:27,070
about building blocks.

609
00:30:27,070 --> 00:30:30,429
You can have dev containers, features,

610
00:30:30,429 --> 00:30:33,500
you can put different things together,

611
00:30:33,500 --> 00:30:36,020
and you can create one single image.

612
00:30:36,020 --> 00:30:39,720
It's quite easy for a developer
to create an environment,

613
00:30:39,720 --> 00:30:43,960
just creating the configuration
file with one line, right.

614
00:30:43,960 --> 00:30:47,320
So, you can provide developers this thing.

615
00:30:49,460 --> 00:30:51,330
As you see here, I'm starting again

616
00:30:51,330 --> 00:30:56,210
from a plain VS Code project.

617
00:30:56,210 --> 00:31:00,670
But I have this image
that is actually the union

618
00:31:02,330 --> 00:31:05,610
of everything that we have seen today.

619
00:31:05,610 --> 00:31:08,460
So, if we reopen that in the container,

620
00:31:10,000 --> 00:31:14,580
it will check the config
file that has only the image,

621
00:31:14,580 --> 00:31:17,540
only the image, right.

622
00:31:17,540 --> 00:31:21,150
But it's going to create
everything for us.

623
00:31:21,150 --> 00:31:23,900
We will see extensions.

624
00:31:23,900 --> 00:31:28,660
We will see post create
commands, post attach commands,

625
00:31:29,510 --> 00:31:32,870
Amazon Q, Amazon Q context, everything,

626
00:31:32,870 --> 00:31:34,740
just with one line config.

627
00:31:35,950 --> 00:31:40,820
So essentially, this is what
we usually do when we develop.

628
00:31:40,820 --> 00:31:43,929
And Kris, over to you again.

629
00:31:43,929 --> 00:31:45,309
- [Kris] Thank you, Matteo.

630
00:31:45,309 --> 00:31:49,809
Before we do, please switch
the screen for me, okay.

631
00:31:52,390 --> 00:31:55,090
So yeah, we're kind of approaching the end

632
00:31:55,090 --> 00:31:56,150
of the session already.

633
00:31:56,150 --> 00:32:00,050
But we want to leave you
with something more tangible.

634
00:32:00,050 --> 00:32:03,070
Indeed, that container
that Matteo just pulled

635
00:32:03,070 --> 00:32:04,969
in that was built remotely
with CodePipeline.

636
00:32:06,100 --> 00:32:11,040
And this is a very high-level diagram.

637
00:32:11,040 --> 00:32:15,969
So, we built a CDK pattern for a pipeline,

638
00:32:15,969 --> 00:32:19,599
which is essentially a warehouse
with stateful resources,

639
00:32:19,599 --> 00:32:23,690
and all these different
pipeline stacks per image

640
00:32:23,690 --> 00:32:26,240
and per feature.

641
00:32:26,240 --> 00:32:30,170
And the way this works is we
just copy a configuration,

642
00:32:30,170 --> 00:32:31,830
or you copy a configuration onto S3.

643
00:32:33,020 --> 00:32:36,980
That will trigger EventBridge,
kickstart the pipeline

644
00:32:36,980 --> 00:32:39,890
for each image or feature
that you actually push to S3.

645
00:32:40,920 --> 00:32:42,710
And that will deliver it to ECR.

646
00:32:43,790 --> 00:32:46,470
And from that point on,
you can either then pull it

647
00:32:46,470 --> 00:32:47,920
into your project like Matteo did,

648
00:32:49,240 --> 00:32:52,550
or you can use Crane to bring
it over to your repository,

649
00:32:52,550 --> 00:32:55,690
which is available to your
employees or your teammates.

650
00:32:56,710 --> 00:32:59,150
Or you create this modular landscape

651
00:32:59,150 --> 00:33:03,840
of a base container with
an extended container,

652
00:33:03,840 --> 00:33:05,830
which uses that and
which brings in features

653
00:33:05,830 --> 00:33:08,930
that you also have managed
by other teams or whatnot.

654
00:33:10,360 --> 00:33:12,070
And that's a little bit how that is.

655
00:33:12,070 --> 00:33:13,580
It's published on AWS Samples.

656
00:33:13,580 --> 00:33:17,279
The QR code is on the other slide.

657
00:33:17,279 --> 00:33:18,930
Is there any questions on this?

658
00:33:19,940 --> 00:33:21,830
So, this is also a
multi-architecture image.

659
00:33:21,830 --> 00:33:25,840
So, it builds it for
Mac and for PC, again,

660
00:33:25,840 --> 00:33:28,673
using AMD64 and ARM with Graviton.

661
00:33:30,370 --> 00:33:33,287
So, it'll run on all the machines.

662
00:33:37,690 --> 00:33:42,440
- [Matteo] Maybe we can also
show how to create a feature

663
00:33:44,903 --> 00:33:46,647
with that pipeline.

664
00:33:46,647 --> 00:33:47,480
- [Kris] Oh, yeah.

665
00:33:47,480 --> 00:33:48,709
Well, let's do that.

666
00:33:50,739 --> 00:33:53,757
Do we use a recent package?

667
00:33:53,757 --> 00:33:54,590
- Yeah.
- Okay.

668
00:33:54,590 --> 00:33:57,180
So, as Kris mentioned,

669
00:33:57,180 --> 00:34:02,180
we have created a repository
that is public on AWS Samples.

670
00:34:02,230 --> 00:34:07,210
And there is an example for Kero CLI.

671
00:34:07,210 --> 00:34:11,289
So, we have created the Kero CLI feature

672
00:34:11,289 --> 00:34:14,900
that can be added to the dev container.

673
00:34:14,900 --> 00:34:17,909
And let's do it together.

674
00:34:17,909 --> 00:34:22,242
So, to do that, we need to
create a new folder here,

675
00:34:23,090 --> 00:34:28,090
Kero CLI, and then

676
00:34:29,715 --> 00:34:32,989
install SH.

677
00:34:32,989 --> 00:34:37,780
Here we are going to put the
code to install Kero CLI.

678
00:34:38,809 --> 00:34:41,060
So, what we usually do
when we develop features,

679
00:34:41,060 --> 00:34:43,530
we understand how to install that package

680
00:34:43,530 --> 00:34:45,650
that we want to do.

681
00:34:45,650 --> 00:34:46,543
So, we go and check Kero.

682
00:34:48,250 --> 00:34:50,537
We do it here.

683
00:34:50,537 --> 00:34:52,110
CLI.

684
00:34:52,110 --> 00:34:53,989
Oh, it's pretty easy.

685
00:34:53,989 --> 00:34:57,420
So, we copy that single line.

686
00:34:57,420 --> 00:35:00,080
But that single line is going to install

687
00:35:00,080 --> 00:35:02,380
that with the root user.

688
00:35:02,380 --> 00:35:05,049
We want to install that

689
00:35:05,049 --> 00:35:08,160
with the remote user inside the container.

690
00:35:08,160 --> 00:35:12,180
So, I'm not going to write
everything from scratch.

691
00:35:12,180 --> 00:35:13,750
So, we have it already.

692
00:35:13,750 --> 00:35:16,146
You have it already.

693
00:35:16,146 --> 00:35:16,830
It's public.

694
00:35:16,830 --> 00:35:19,870
So, we are going to add this code here.

695
00:35:20,870 --> 00:35:21,960
Okay.

696
00:35:21,960 --> 00:35:25,460
Let's create the other file,

697
00:35:26,635 --> 00:35:31,635
dev container.feature.json.

698
00:35:36,260 --> 00:35:39,420
And in here, we need
to put the config file.

699
00:35:39,420 --> 00:35:41,866
So, this one, essentially.

700
00:35:41,866 --> 00:35:42,699
Okay.

701
00:35:42,699 --> 00:35:45,369
It's more readable here.

702
00:35:45,369 --> 00:35:48,040
So, we define the name, the
ID, the semantic versioning,

703
00:35:48,040 --> 00:35:52,000
the description, and
let's say a constraint.

704
00:35:52,000 --> 00:35:55,270
So, it's going to be installed
after the other feature.

705
00:35:55,270 --> 00:35:57,580
That if you remember well,

706
00:35:57,580 --> 00:36:02,580
it's part of the dev
container config file.

707
00:36:04,720 --> 00:36:06,500
So, we do this.

708
00:36:06,500 --> 00:36:10,210
And to package everything up, we need to,

709
00:36:10,210 --> 00:36:14,127
so here we are inside
the dev container folder.

710
00:36:16,010 --> 00:36:19,330
We see the kiro-cli directory.

711
00:36:19,330 --> 00:36:21,580
We go into there.

712
00:36:21,580 --> 00:36:23,460
And we have those two files.

713
00:36:23,460 --> 00:36:28,443
So, we need to zip this content

714
00:36:28,443 --> 00:36:30,469
into a zip file.

715
00:36:30,469 --> 00:36:32,535
And then we are going

716
00:36:32,535 --> 00:36:37,280
to upload S3 API.

717
00:36:37,280 --> 00:36:41,940
We are going to upload this
zip file into the S3 bucket

718
00:36:41,940 --> 00:36:44,490
that Kris mentioned before that was part

719
00:36:44,490 --> 00:36:46,320
of the architecture as an entry point.

720
00:36:47,500 --> 00:36:52,169
So, this one is going to
be pushed to the S3 bucket.

721
00:36:53,979 --> 00:36:56,180
This is the version ID.

722
00:36:57,520 --> 00:36:59,210
And if we wait a bit,

723
00:36:59,210 --> 00:37:01,960
it's going to be built by the pipeline.

724
00:37:02,800 --> 00:37:04,419
We have created it already.

725
00:37:06,380 --> 00:37:10,629
So, what we can do is
just add the feature,

726
00:37:13,539 --> 00:37:16,669
features, and

727
00:37:19,559 --> 00:37:21,490
I'm going to take this repository.

728
00:37:21,490 --> 00:37:24,573
It's the same without the dictionary.

729
00:37:27,570 --> 00:37:31,979
It's pretty difficult doing that here.

730
00:37:31,979 --> 00:37:32,812
Okay.

731
00:37:37,662 --> 00:37:38,495
Okay.

732
00:37:41,437 --> 00:37:42,270
Perfect.

733
00:37:44,210 --> 00:37:46,250
What am I missing?

734
00:37:46,250 --> 00:37:46,250
The comment.

735
00:37:46,250 --> 00:37:46,746
- [Kris] You've got to change the name.

736
00:37:46,746 --> 00:37:47,600
- [Matteo] Yes.

737
00:37:47,600 --> 00:37:49,766
- [Kris] It's not a base image.

738
00:37:49,766 --> 00:37:50,810
- Where.
- Saved.

739
00:37:50,810 --> 00:37:52,330
- [Kris] Yes, saved.

740
00:37:52,330 --> 00:37:55,910
Thank you, okay.

741
00:37:55,910 --> 00:38:00,910
I need to change features and Kiro-CLI.

742
00:38:02,929 --> 00:38:06,459
We name it this way, right.

743
00:38:06,459 --> 00:38:08,370
So, we save again.

744
00:38:09,730 --> 00:38:10,980
And we rebuild.

745
00:38:15,550 --> 00:38:20,269
Okay, it might take a while.

746
00:38:20,269 --> 00:38:23,820
But at the end, we are going
to have the same environment

747
00:38:23,820 --> 00:38:27,730
as before with Kiro CLI installed.

748
00:38:27,730 --> 00:38:32,010
So, we are going to check
that from the terminal

749
00:38:32,010 --> 00:38:34,093
if it didn't do any typo.

750
00:38:36,742 --> 00:38:37,575
Okay.

751
00:38:37,575 --> 00:38:41,959
It's running the pip licenses
because we are building again.

752
00:38:41,959 --> 00:38:45,876
And we are not just
attaching to the container.

753
00:38:47,440 --> 00:38:48,607
Okay, come on.

754
00:38:53,219 --> 00:38:55,344
In the meantime,

755
00:38:55,344 --> 00:38:56,990
(speaker indistinct chattering)

756
00:38:56,990 --> 00:39:00,073
if you have any questions, let's see.

757
00:39:03,700 --> 00:39:07,920
Kiro CLI, we have it, right?

758
00:39:07,920 --> 00:39:12,700
Loading the VM, Kiro-CLI, help.

759
00:39:12,700 --> 00:39:14,883
Yeah, we have it.

760
00:39:14,883 --> 00:39:19,330
Okay, so this is online on ECR.

761
00:39:19,330 --> 00:39:21,920
And it can be shared with everyone.

762
00:39:21,920 --> 00:39:24,140
Yeah, so this is really easy, right?

763
00:39:27,120 --> 00:39:28,900
This does give you a
rather large container.

764
00:39:28,900 --> 00:39:31,700
And you do need to look at
how Kiro actually looks.

765
00:39:31,700 --> 00:39:33,940
I did this with Amazon
QDeveloper at first.

766
00:39:33,940 --> 00:39:37,250
But it was an unstripped binary.

767
00:39:37,250 --> 00:39:39,170
So, it was massive.

768
00:39:39,170 --> 00:39:44,170
So yeah, this unlocks
really powerful patterns.

769
00:39:44,340 --> 00:39:46,809
If you want to have pre-commit
hooks using Kiro as well,

770
00:39:46,809 --> 00:39:49,870
or you want to use Kiro
to give you some insights

771
00:39:49,870 --> 00:39:53,039
on just your commit messages,
you're doing changes

772
00:39:53,039 --> 00:39:57,050
in a certain format, that's
how you can use this as well.

773
00:39:57,050 --> 00:39:58,980
So yeah, thank you.

774
00:40:03,030 --> 00:40:04,470
Awesome.

775
00:40:04,470 --> 00:40:06,400
And then I promised the
last slide is also featuring

776
00:40:06,400 --> 00:40:08,120
the QR code for that repo.

777
00:40:09,889 --> 00:40:12,500
And yeah, I mean, you've got
a full week ahead of you.

778
00:40:12,500 --> 00:40:13,960
So, make good use of it.

779
00:40:13,960 --> 00:40:16,689
Enjoy your time here at reInvent.

780
00:40:16,689 --> 00:40:19,886
(audience applauding)

