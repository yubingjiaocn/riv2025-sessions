# AWS re:Invent 2025 COP340 会议总结：构建可靠运维 - Fannie Mae 案例

## 会议概述

本次会议由 AWS 解决方案架构师 Bobby Howland 主讲，Fannie Mae 运维工程副总裁 Moyes Colani 分享客户实践经验。会议重点探讨了可靠运维（Reliable Operations）的重要性及实施方法。

核心观点指出，42% 的系统故障源于运维问题，而非硬件或软件架构缺陷。因此，可靠性不仅仅是多区域部署和高可用架构的问题，更关键的是建立可靠的运维机制。AWS 通过"机制而非意图"（mechanisms, not intentions）的理念，强调必须建立具体的运维机制来保障系统可靠性。

Fannie Mae 作为美国最大的住房抵押贷款机构之一，管理着超过 4 万亿美元资产，其系统稳定性直接影响美国四分之一的房屋贷款业务。通过采用 AWS 云运维最佳实践，Fannie Mae 在六年云迁移过程中取得了显著成效：关键事故减少 71%，变更失败率降低 75%，平均恢复时间缩短 80%，AWS 平台导致的事故每年仅约 3 起。

## 详细时间线与关键要点

### 00:00 - 会议开场与议程介绍
- **演讲者**：Bobby Howland（AWS 解决方案架构师）
- **会议主题**：COP 340 - 构建可靠运维，以 Fannie Mae 为案例
- **议程安排**：AWS 云运维理念、工具演示、Fannie Mae 实践案例、五个高级可靠性技巧

### 02:30 - 可靠性与运维的关系
- **核心数据**：42% 的系统故障由运维问题引起
- **传统认知误区**：可靠性通常被理解为高可用架构、灾难恢复、多区域部署
- **新视角**：运维质量是可靠性的关键组成部分

### 04:45 - AWS 云运维核心理念
- **关键原则**："好的意图不起作用，机制才有效"（Good intentions don't work, mechanisms do）
- **两个披萨团队**：团队规模应控制在两个披萨能喂饱的人数，确保所有权和运维责任明确
- **团队特点**：自主管理运维环境、首要告警响应者、最大化自动化

### 07:20 - COE（纠错机制）
- **定义**：无责备的事后分析学习机制
- **核心要素**：透明度、数据支撑、行动项、防止特定错误再次发生
- **关键原则**：绝不用于指责或惩罚，否则会破坏透明度

### 09:15 - SLO（服务级别目标）
- **定义**：基于用户视角的可衡量服务质量目标
- **示例**：支付处理平台延迟 SLO - 99% 的支付应在特定时间内完成（P99）
- **监控方式**：使用 APM 工具监控达成率和燃烧率（burn rate）
- **价值**：在违反 SLO 之前通过燃烧率预警采取行动

### 11:40 - 自动化事故修复
- **目标**：减少平均恢复时间（MTTR）同时保持安全性
- **机制**：告警触发后先尝试自动修复，失败后再通知人工介入
- **增强功能**：为运维人员提供丰富的上下文信息（如具体服务、错误类型、相关仪表板）

### 13:00 - 主动事故准备
- **方法**：桌面演练、游戏日（Game Days）、故障注入测试
- **建议**：在实际故障注入前先进行桌面演练
- **价值**：建立肌肉记忆，明确告警升级机制、运维手册位置、仪表板访问路径

### 14:30 - 云运维基础服务
- **核心服务**：CloudWatch、Systems Manager、Config、CloudTrail
- **三层架构**：
  - **观察层**（Observe）：Config、CloudTrail、CloudWatch
  - **决策层**（Decide）：EventBridge、Step Functions、Systems Manager
  - **行动层**（Act）：Systems Manager 自动化

### 16:00 - Systems Manager 深度解析
- **两大核心组件**：
  - **代理（Agent）**：安装在实例上，支持远程管理、补丁管理、会话管理
  - **自动化（Automations）**：类似 Step Functions 的工作流，响应事件执行 API、脚本等操作
- **节点管理**：跨多个实例执行操作

### 18:20 - Automation Runbook Builder 演示开始
- **发布时间**：约一年前推出，持续改进中
- **特点**：低代码可视化设计器，安全高效地创建自动化运维手册

### 19:00 - 控制台演示
- **访问路径**：SSM 控制台 → Automations
- **可见信息**：运行中的自动化、等待状态、失败和成功状态

### 20:15 - 创建新 Runbook 演示
- **左侧面板功能**：
  - **流程控制**：分支、循环、睡眠、暂停、审批状态
  - **脚本执行**：在自动化内直接运行脚本，无需调用 Lambda
  - **资源管理**：管理 AWS 资源
  - **AWS API**：几乎可调用任何 AWS API
  - **嵌套自动化**：可执行其他自动化，实现组件复用

### 22:00 - Hello World 示例分析
- **流程**：分支决策 → 审批状态 → 延迟 → 执行循环 → 脚本执行 → 重复 → 结束
- **优化建议**：告警自动化场景下移除手动审批步骤以加快响应

### 23:30 - 添加 SNS 通知
- **场景**：自动化成功或失败后发送通知
- **实现**：添加两个 SNS 发布步骤（"good" 和 "bad"）
- **配置**：设置消息内容和目标 Topic ARN

### 25:00 - 优化循环逻辑
- **问题**：即使首次修复成功，仍会重复执行三次
- **解决方案**：添加分支判断，根据脚本输出决定下一步
- **条件设置**：如果告警状态为 "OK"，跳出循环直接进入成功通知
- **默认行为**：其他情况继续循环重试

### 27:30 - 与 CloudWatch Alarms 集成
- **集成方式**：创建 EventBridge 规则
- **触发条件**：可针对所有告警或特定告警
- **目标设置**：指向 Systems Manager 自动化，配置 IAM 角色

### 29:00 - 实际执行结果展示
- **可见性**：每个步骤的执行状态（成功/错误）
- **调试能力**：失败时可查看详细日志
- **逐步执行**：支持步进式调试

### 30:45 - AWS Config 介绍
- **功能**：资源变更时或定期创建配置项
- **配置记录器**：创建合规性规则评估期望/非期望状态
- **修复机制**：不合规时通过 Systems Manager 自动化进行修复
- **关键点**：Config 的所有修复操作都是 Systems Manager 自动化

### 32:00 - Fannie Mae 案例分享开始
- **演讲者**：Moyes Colani（Fannie Mae 运维工程副总裁）
- **公司背景**：
  - 1938 年由美国国会特许成立
  - 管理美国四分之一的房屋抵押贷款
  - 资产超过 4 万亿美元
  - 美国最大、全球第五大资产负债表

### 34:30 - 业务影响与重要性
- **行业地位**："Fannie Mae 打喷嚏，抵押贷款行业就感冒"
- **系统依赖**：众多大型贷款机构围绕 Fannie Mae 系统构建应用
- **可靠性要求**：系统稳定性、可靠性和性能至关重要

### 36:00 - 云迁移目标（六年前）
- 防止财务影响
- 提高监管合规性
- 加快上市时间
- 提升客户满意度
- 最小化运维中断
- 提高生产力

### 37:30 - 关键绩效指标（KPI）成果
- **关键事故减少 71%**：从 10 起降至 3 起
- **变更失败率降低 75%**：10,000 次变更中仅 2-3 次导致业务影响
- **平均恢复时间缩短 80%**：从 2.5 小时降至 30 分钟
- **AWS 平台事故**：每年约 3 起

### 39:45 - 策略一：集成可观测性与事故管理
- **自研工具**：Sentinus - 提供实时告警、监控和事件关联
- **数据源整合**：
  - CloudWatch、EventBridge、AWS 个性化仪表板
  - OpenTelemetry → Splunk → Sentinus（通过 API）
  - Dynatrace（应用监控）
  - Catchpoint（合成事务监控）
- **告警系统**：xMatters 用于团队呼叫

### 42:00 - 可观测性成果
- **端到端追踪**：完整的事务跟踪能力
- **全面可见性**：可按 VPC、账户等维度切片分析
- **主动发现**：在 AWS 通知前已知晓事故及原因

### 43:30 - 运维手册自动化
- **生成方式**：使用生成式 AI 构建运维手册
- **增强方式**：通过自动化增强标准操作流程
- **应用场景**：联系支持团队、联系 AWS TAM 等

### 44:45 - 监控即代码（Monitoring as Code）
- **实现方式**：跨所有应用统一应用一致的告警和监控
- **价值**：标准化、可复制、易维护

### 45:30 - 混沌工程实施
- **工具**：AWS Fault Injection Simulator 及其他工具
- **价值**：从演练中学习，提升系统可靠性
- **应用范围**：已在多个应用中实施

### 46:45 - 策略一总结成果
- 更快的检测和恢复
- 更快的事故解决
- 改善的运维韧性
- 团队自主性增强

### 47:30 - 策略二：事故期间的自主运维
- **理念引用**：Werner Vogels（AWS CTO）- "一切都会失败，一直如此"
- **关键问题**：系统如何从故障中恢复？容错机制？防御机制？

### 48:30 - 区域故障转移自动化
- **现场调查**：少数观众使用自动化进行区域故障转移
- **历史事件**：2021 年 12 月 AWS 中断（Route 53 控制平面问题）
- **经验教训**：构建自动化模式，消除对 Route 53 控制平面的依赖

### 50:00 - 自动化架构设计
- **独立性**：与 CI/CD 管道独立（避免单点故障）
- **原生服务**：使用 CloudWatch、Step Functions、Lambda 等 AWS 原生服务
- **定期演练**：团队定期演练故障转移，建立肌肉记忆

### 51:30 - 实战验证
- **2024 年 10 月 20 日事件**：成功使用自动化模式故障转移大部分关键应用

### 52:15 - 策略二成果
- 更快的恢复速度
- 增强的业务连续性
- 团队赋能（可独立更新自动化模式以支持新 AWS 服务）

### 53:00 - 策略三：纠错（COE）流程
- **原有基础**：几年前已有成熟的事后分析流程
- **改进方向**：采用 AWS COE 框架并加入 Fannie Mae 特色调整

### 54:30 - COE 核心要素
- **标准内容**：事故摘要、影响、时间线
- **关键部分**：
  - **五个 W**（Who, What, When, Where, Why）
  - **经验教训**
  - **行动项**

### 55:30 - 每周 COE 评审会议
- **参与者**：关键利益相关者、根因 CI 所有者、受影响 CI 所有者、业务利益相关者、风险利益相关者等
- **流程**：
  - 5-7 分钟静默阅读 COE 文档
  - 参与者记录自己的笔记
  - 开放提问环节

### 57:00 - 独特做法：初级成员优先提问
- **原因**：避免高级管理者（如副总裁）先提问导致讨论方向被影响
- **目的**：鼓励初级成员充分表达意见和问题

### 58:00 - 每月 COE 论坛
- **参与者**：相同利益相关者群体及更多人员
- **内容**：回顾上月关键事故，重点关注模式而非细节
- **重点**：
  - 从事故中提取的模式
  - 模式如何应用于其他应用
  - 工作流的成果

### 59:30 - 跨组织影响
- **扩散效应**：业务团队主动要求培训，希望在业务流程故障中实施 COE 流程
- **价值认可**：COE 机制的价值得到广泛认可

### 1:00:30 - 策略三成果
- 加速学习
- 跨企业应用模式和最佳实践
- 将经验教训转化为工作流
- 其他团队能够实施行动项

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


会议总结：本次会议系统展示了 AWS 云运维最佳实践，并通过 Fannie Mae 的真实案例验证了这些实践的有效性。核心要点包括建立机制化的运维体系、利用自动化减少人工干预、通过 COE 流程持续学习改进，最终实现系统可靠性的显著提升。