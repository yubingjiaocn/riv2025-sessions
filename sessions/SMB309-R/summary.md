# AWS re:Invent 2025 - 构建AI代理工厂 (Agent Factory) 会议总结

## 会议概述

本次技术会议由AWS高级解决方案架构师Girish和Justin主讲,重点介绍了如何构建一个"代理工厂"(Agent Factory)系统。这个系统能够根据用户需求自动创建和部署AI代理(AI Agents)或多代理系统。会议展示了如何利用开源Strands SDK、模型上下文协议(MCP)、代理间通信协议(A2A)以及AWS Agent Core服务,将AI代理从原型开发环境快速部署到生产环境。

演讲者通过实际编码演示,展示了从创建简单聊天机器人到构建复杂多代理系统的完整过程。核心理念是利用"构建者代理"(Builder Agent)作为代理工厂的核心,它能够理解自然语言请求,自动生成代码、创建工具、部署Lambda函数、配置网关,并将代理部署到Agent Core运行时环境。这种方法大大简化了企业级AI代理的开发和部署流程,使开发者能够专注于业务逻辑而非基础设施管理。

整个会议强调了模块化、可扩展性和安全性,展示了如何通过几行代码就能创建功能强大的AI代理,以及如何通过代理工厂实现代理的按需自动化创建和部署。

## 详细时间线

### 开场介绍 (0:00-2:00)
- **0:00** - Girish和Justin自我介绍,说明他们是AWS高级解决方案架构师,专注于帮助客户将AI/ML项目从构思阶段推进到生产环境
- **0:30** - 会议议程说明:将在16分钟内学习四个关键概念、进行编码演示、与代理工厂交互,并现场根据观众需求创建代理
- **1:00** - 鼓励观众思考对自己组织有价值的业务代理,会议将尝试现场创建这些代理
- **1:30** - 说明会后将分享代码库,建议观众关注背后的"为什么"而非具体实现细节

### 核心概念讲解 (2:00-5:30)
- **2:00** - 介绍代理工厂的核心组件:构建者代理(Builder Agent),它能根据用户请求创建单个代理或多代理系统
- **2:20** - 定义AI代理:运行循环的模型,配合一组工具来执行特定操作以实现特定目标
- **2:40** - 介绍Strands SDK的三大优势:
  - 用几行代码即可创建代理,依赖前沿模型的智能
  - 自带原生工具集,也支持自定义工具
  - 原生支持MCP和A2A等新兴协议
- **3:20** - 解释MCP(模型上下文协议):为代理、工具和数据源提供通用语言的"通用翻译器"
- **4:00** - 介绍A2A(代理间通信协议)的三大功能:
  - 允许代理发现其他代理
  - 了解其他代理的能力
  - 提供代理间通信的通用语言
- **4:40** - 总结三个关键点:使用Strands SDK构建代理、使用MCP连接工具和数据源、使用A2A实现代理间通信

### Agent Core服务介绍 (5:30-7:30)
- **5:30** - 介绍Agent Core:专为大规模、安全、高效运行代理系统而设计的服务
- **5:50** - Agent Core Runtime:提供无服务器环境,支持短期任务(3分钟)和长期任务(5小时)
- **6:20** - Identity功能:确保只有授权用户可以访问代理,代理只能访问授权的工具和其他代理
- **6:40** - Memory功能:提供短期和长期记忆能力
- **6:50** - Code Interpreter:允许代理编写和执行代码
- **7:00** - Browser Tool:提供安全的大规模互联网访问环境
- **7:10** - Agent Core Gateway:将Lambda函数或API暴露为MCP工具,无需手动管理MCP服务器
- **7:30** - Observability功能:用于理解代理行为和故障排查

### 代理工厂架构说明 (7:30-8:30)
- **7:30** - 展示代理工厂完整架构图
- **7:50** - 构建者代理使用Strands构建,部署在Agent Core上
- **8:00** - 构建者代理拥有三个工具:创建Lambda函数、创建网关、创建和部署代理
- **8:20** - 部署的代理通过网关访问Slack、Salesforce等工具或自定义工具

### 编码演示:基础聊天机器人 (8:30-9:30)
- **8:30** - 切换到编码终端,确认屏幕可见性
- **8:50** - 演示用三行代码创建聊天机器人:导入Agent类、创建代理函数、触发函数
- **9:10** - 询问"什么是re:Invent",成功获得回答
- **9:20** - 强调Strands的强大之处:只需几行代码即可创建和部署代理

### 编码演示:模型选择 (9:30-11:00)
- **9:30** - 演示如何选择特定模型
- **9:40** - 导入Bedrock模型,指定模型ID(Nova Premiere)
- **10:00** - 说明可以轻松切换到其他模型(如Meta的Llama),只需更改模型ID
- **10:20** - 展示可以控制temperature和top_p参数,以及启用流式传输
- **10:40** - 强调模型灵活性:未来新模型出现时,只需切换模型ID,其他代码保持不变
- **10:50** - 提到支持直接从Anthropic、OpenAI消费模型,以及使用OLAM运行本地模型

### 编码演示:带工具的代理 (11:00-13:30)
- **11:00** - 演示真正的代理:模型+工具集
- **11:20** - 场景:创建能浏览互联网、查找AWS上周发布内容、创建新闻简报并上传到S3的代理
- **11:40** - 导入工具:HTTP请求(访问互联网)、Use AWS(使用boto3库)、Current Time(获取当前时间)
- **12:00** - 使用Anthropic作为模型,设置系统提示词:新闻主播专门查找AWS新闻
- **12:20** - 将导入的工具传递给代理
- **12:40** - 代理执行过程:使用当前时间工具→使用HTTP请求查找AWS公告→使用AWS工具上传到S3
- **13:00** - 请求用户权限执行put object操作
- **13:10** - 刷新S3存储桶,看到新创建的新闻简报文件
- **13:20** - 强调代理的能力:代表用户采取行动,可应用于更多业务逻辑场景

### 编码演示:动态创建工具 (13:30-16:00)
- **13:30** - 演示代理工厂如何根据用户请求动态创建自定义工具
- **13:50** - 创建一个能创建不同工具的代理
- **14:00** - 请求创建计算复合利息的工具
- **14:10** - 代码差异:导入Editor(允许编写和执行代码)、指示创建新工具并热加载
- **14:30** - 代理请求权限在工具目录中执行写操作
- **14:40** - 观众提问:如何将本地创建的工具部署到Agent Core
- **15:00** - 回答:下一阶段将展示,代理工厂会创建工具、创建网关、关联工具与网关、创建代理
- **15:20** - 展示创建的工具:Python函数加上@tool装饰器
- **15:40** - 强调:现有或新的Python函数都可以通过@tool装饰器暴露为工具
- **15:50** - 测试:请求计算复合利息,代理识别正确工具并执行计算

### 编码演示:MCP客户端 (16:00-19:30)
- **16:00** - 演示代理工厂如何访问MCP服务器
- **16:20** - 场景:创建解决方案架构师代理,访问最新AWS文档,计算托管成本
- **16:40** - 具体任务:托管静态网站(S3+CloudFront),计算总拥有成本(TCO)
- **17:00** - 代码差异:将代理设为MCP客户端、提供文件读写权限、创建stdio客户端
- **17:20** - 提供访问密钥(仅因定价MCP计算器需要,并非总是必需)
- **17:40** - 系统提示词:你是SA,可以读写文件、查找文档、服务用户请求
- **18:00** - 代理执行过程:安装MCP服务器→发现工具(读文档、搜索文档、获取定价)→执行操作
- **18:30** - 代理自我纠错:未找到数据传输定价代码时,自动找到正确代码
- **18:50** - 请求权限写入文件,创建包含TCO计算和文档链接的文件
- **19:10** - 观众提问:如何管理MCP工具返回的上下文窗口
- **19:20** - 回答:Strands内置上下文管理功能,设置了访问限制,无需手动管理

### 编码演示:多代理系统(A2A) (19:30-22:30)
- **19:30** - 演示创建多代理系统,多个代理协同工作实现更高级目标
- **19:50** - 展示架构:HR代理(端口8000)通过A2A与员工代理(端口8001)通信,使用MCP服务器获取员工数据
- **20:10** - 任务:找出能帮助机器学习项目的员工,数据库包含员工姓名和技能
- **20:30** - 发起curl请求触发HR代理
- **20:40** - HR代理代码:导入A2A客户端提供者,指定托管URL
- **21:00** - 员工代理代码:作为A2A服务器,指定URL和MCP服务器URL
- **21:20** - 展示模拟数据库:员工名字、姓氏和技能集的Python文件
- **21:40** - 查看curl请求结果:代理发送请求到服务器→查找员工技能→推荐合适员工
- **22:10** - 成功推荐具有机器学习所需框架和技术的员工列表

### 部署到Agent Core (22:30-24:30)
- **22:30** - 演示将代理部署到Agent Core
- **22:40** - 使用Agent Core CLI命令:agent core configure
- **23:00** - 指定代理文件,命名为"HR agent"
- **23:10** - 配置:requirements文件、Python版本、执行角色(使用默认值)、内存配置
- **23:40** - 启动部署过程
- **24:00** - 展示Agent Core文件差异:导入agent core app、创建app、使用@app装饰器定义入口点
- **24:20** - 强调:除了这三处差异,其他Strands代码完全相同

### Agent Core部署过程 (24:30-25:30)
- **24:30** - 观察部署过程:创建Agent Core运行时、创建角色、创建内存
- **24:50** - 上传到S3,启动到Agent Core
- **25:10** - 说明代理工厂将使用相同逻辑自动化这些步骤
- **25:20** - 过渡到Justin演示代理工厂实际应用

### 代理工厂实战演示 (25:30-28:00)
- **25:30** - Justin总结已展示内容:Strands SDK、MCP服务器、A2A、Agent Core部署
- **25:50** - 提出问题:是否有更简单的方法?能否用自然语言与构建者代理对话,让它自动创建和部署代理?
- **26:20** - 角色扮演场景:Justin是公司AI专家,周五晚上7点收到Girish的请求
- **26:40** - Girish请求:创建能帮助投资决策的代理,用于周一早上的董事会会议
- **27:00** - Justin决定使用代理工厂而非手动编码
- **27:20** - 展示简单的CLI应用程序与构建者代理交互
- **27:40** - 输入请求:"创建一个能使用工具按行业垂直领域确定风险的风险分析代理"

### 构建者代理代码解析 (28:00-30:00)
- **28:00** - 在代理运行时查看构建者代理代码
- **28:20** - 进入builder_agent.py文件,展示核心概念:导入agents和tools
- **28:40** - 展示app入口点:构建者代理已部署到Agent Core,定义调用函数
- **29:00** - 展示内存钩子(第78行):短期记忆,历史记录为5条消息
- **29:20** - 展示Strands代理配置(第87行):六个工具,重点关注三个核心工具
- **29:40** - 三个关键工具:deploy_agent(部署代理)、create_gateway(创建网关)、create_lambda_tools(创建Lambda工具)

### 代理工厂工作流程 (30:00-32:00)
- **30:00** - 解释工作流程:首先调用create_gateway创建Agent Core网关(门面层)
- **30:20** - 网关允许代理通过MCP协议连接Lambda函数或其他API
- **30:40** - 然后创建Lambda工具:部署到Lambda,通过网关暴露
- **31:00** - 最后使用deploy_agent工具将代理部署到Agent Core运行时
- **31:20** - 展示系统提示词部分
- **31:40** - 返回终端,看到风险代理成功创建和部署,名为"risk_analysis_agent"

### 测试风险分析代理 (32:00-34:00)
- **32:00** - 选择与已部署代理聊天(选项2)
- **32:20** - 加载可用代理列表:Girish的HR代理和新创建的风险分析代理
- **32:40** - 选择风险分析代理,询问:"技术行业的相关风险是什么?"
- **33:00** - 在代理运行时查看已部署的基础设施
- **33:10** - 进入Bedrock Agent Core Runtime控制台,看到新部署的风险分析代理
- **33:30** - 查看网关:看到风险分析网关
- **33:50** - 查看目标:看到风险分析目标,实际上是新部署的Lambda函数

### 基础设施检查 (34:00-35:30)
- **34:00** - 强调:构建者代理动态部署了Lambda函数
- **34:20** - 说明Lambda函数包含通用逻辑,但可以轻松扩展连接第三方系统
- **34:40** - 构建者代理可以编写复杂逻辑并部署为Lambda函数,然后作为工具暴露给代理
- **35:00** - 返回控制台,看到技术行业风险分析结果:70/100分
- **35:20** - Girish表示满意,但提出可以连接第三方系统和内部智能系统

### 第二个代理请求:费用代理 (35:30-37:30)
- **35:30** - Girish提出最后一个请求:为周一入职的实习生创建费用报销代理
- **35:50** - Justin同意尝试,返回构建者代理
- **36:00** - 输入请求:"创建一个能按用户获取费用和添加新费用的费用代理"
- **36:20** - 说明当前用Excel表格跟踪实习生费用,希望有代理更新后端数据存储
- **36:40** - 代理将允许实习生轻松添加新费用或查看现有费用
- **37:00** - 在代理运行时查看构建者代理的系统提示词

### 系统提示词分析 (37:30-39:00)
- **37:30** - 展示系统提示词的重要规则:只创建一个网关、只创建一个代理
- **37:50** - 避免在代理循环中出现重复
- **38:00** - (字幕在此处截断)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


注意: 字幕在会议进行到约38分钟时截断,完整会议可能还有更多内容未包含在此总结中。