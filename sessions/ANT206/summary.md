# AWS re:Invent 2025 - Amazon Redshift 和 Amazon Athena 新功能综述

## 会议概览

本次会议由 Amazon Redshift 高级产品经理 Imran Moen、Amazon Athena 首席产品经理 Scott Riggney 以及 Twilio 首席软件工程师 Sean McKibben 共同主讲，全面介绍了 Amazon Redshift 和 Amazon Athena 在 2025 年的最新功能和创新。

会议首先阐述了 AWS 分析服务组合如何满足不同客户需求：Amazon Redshift 作为专用云数据仓库处理结构化数据的 SQL 分析；Amazon Athena 提供无服务器方式查询 S3 中的非结构化或半结构化数据；Amazon SageMaker 则将数据仓库和数据湖整合，支持高级分析和机器学习场景。Redshift 在性能方面持续领先，相比最接近的竞争对手提供 2.2 倍的性价比优势，在 BI 仪表板等特定工作负载上更是达到 7 倍的性价比优势。

Twilio 的实际案例展示了如何利用 Redshift Serverless 和 Athena 重构计费引擎，每天处理数十亿使用事件。通过采用分布式数据仓库架构和 Apache Iceberg 支持，Twilio 实现了 75% 的成本降低，将完整月度重新计算时间从 6 小时缩短至 30 分钟，同时获得了前所未有的数据灵活性和分析能力。会议还重点介绍了 Athena 在 Iceberg 性能上的 1.5 倍提升，以及通过 AWS Lake Formation 实现的统一身份和治理能力。

## 详细时间线

### 开场介绍 (0:00-2:30)
- **0:00** - 会议开始，Imran Moen 介绍自己为 Amazon Redshift 团队高级产品管理经理
- **0:30** - 介绍共同演讲者：Scott Riggney (Amazon Athena 首席产品经理) 和 Sean McKibben (Twilio 首席软件工程师)
- **1:00** - 会议议程：Redshift 新功能、Twilio 案例研究、Athena 新功能

### 客户分析需求概述 (2:30-5:00)
- **2:30** - 介绍三大分析用例：云数据仓库（结构化数据）、云数据湖（非结构化/半结构化数据）、湖仓一体（统一数据基础）
- **3:30** - AWS 服务组合：Redshift（云数据仓库）、Athena（无服务器 S3 查询）、SageMaker（统一分析平台）

### Amazon Redshift 发展历程 (5:00-7:30)
- **5:00** - Redshift 创新历史回顾：2013 年首次推出云数据仓库
- **5:30** - 2017 年推出 Redshift Spectrum，连接数据仓库和数据湖
- **6:00** - 2022 年推出 Zero ETL 支持，简化数据摄取
- **6:30** - 2024 年推出 AI 驱动的扩展和优化
- **7:00** - 性能优势：相比竞争对手 2.2 倍性价比，BI 仪表板场景 7 倍性价比

### 2025 年 Redshift 三大投资支柱 (7:30-9:00)
- **7:30** - 三大投资领域：云数据仓库基础、分布式仓库、Apache Iceberg 支持
- **8:00** - 数万客户使用 Redshift，每天处理数十亿查询和 EB 级数据

### 云数据仓库基础功能 (9:00-15:00)
- **9:00** - 性能优化：持续投资查询性能，2026 年将有更多改进
- **9:30** - 物化视图增强：
  - 6 月：基于 DML 提交的增量自动刷新
  - 7 月：嵌套物化视图的级联刷新
  - 9 月：共享数据上的物化视图支持
- **11:00** - 多维数据布局 (MDDL)：9 月正式发布，基于查询模式自动排序表，提供 10 倍性价比提升
- **12:00** - 安全性增强：1 月提升安全默认设置，集群默认私有、完全加密、要求 SSL 连接

### 分布式数据仓库架构 (15:00-23:00)
- **15:00** - 分布式仓库愿景：不同工作负载运行在专用集群上，共享单一数据集
- **16:00** - 两种架构：Hub-and-Spoke（中心辐射）和 Data Mesh（数据网格）
- **17:00** - 优势：最佳性能、工作负载隔离、精细成本可见性和退款能力

### Redshift Serverless 增强 (18:00-23:00)
- **18:00** - 3 月：推出 Trailing Track 支持，允许客户测试新版本后再部署生产
- **19:00** - 5 月：获得 FedRAMP 授权，支持政府和受监管行业客户
- **19:30** - 6 月：支持 4 RPU 最小配置（低至每小时 $1.50），降低小型工作负载成本
- **20:00** - 7 月：简化网络要求，仅需 3 个 IP 地址和 2 个可用区，完全兼容 IPv6
- **21:00** - 4 月：推出 Serverless 预留实例，承诺使用量可获得高达 24% 折扣

### 统一身份和治理 (23:00-25:00)
- **23:00** - 最新发布：与 AWS Lake Formation 和 AWS Glue Data Catalog 集成
- **23:30** - 功能：使用 IAM Identity Center 或 IAM 凭证登录任何 Redshift 集群
- **24:00** - 细粒度访问控制：行级安全、列级权限、动态数据脱敏，权限适用于整个 Redshift 环境

### 并发扩展增强 (25:00-27:00)
- **25:00** - 2019 年推出并发扩展，自动应对查询量激增
- **25:30** - 新增工作负载类型支持：从 S3 自动复制、Zero ETL、物化视图创建、Spectrum 查询、流式物化视图刷新
- **26:00** - 除 IAD 区域外已在所有区域可用
- **26:30** - 10 月：支持 DML 和 DDL 命令（CREATE TABLE LIKE、ALTER TABLE）

### Apache Iceberg 支持 (27:00-30:00)
- **27:00** - 越来越多客户采用 Apache Iceberg 作为开放表格式
- **27:30** - Redshift 新增 Iceberg 表写入支持：直接创建和插入 Iceberg 表
- **28:00** - 结合去年的读取能力，现在支持完整的 Iceberg 读写功能
- **28:30** - 性能提升：数据湖查询性价比提升 2 倍
- **29:00** - Iceberg 物化视图自动刷新：定期轮询 S3 存储桶，检测新 Iceberg 文件并自动触发刷新

### Redshift 用例场景 (30:00-33:00)
- **30:00** - 批量分析：日终销售报告、季度监管报告
- **30:30** - BI 仪表板：在 QuickSight、Tableau、Looker 等工具中可视化结构化数据
- **31:00** - 复杂决策支持/即席分析：市场预测、客户细分
- **31:30** - 数据处理 (ETL/ELT)：从运营数据库摄取数据，使用 AWS Glue、SQL 或 DBT 转换
- **32:00** - 近实时交互式分析：点击流分析、IoT 监控，摄取延迟降至个位数秒

### Twilio 案例研究 (33:00-50:00)
- **33:00** - Sean McKibben 介绍 Twilio 计费引擎重构项目
- **34:00** - 挑战：每天处理数十亿使用事件，旧系统缺乏灵活性和分析能力
- **35:00** - 两大差距：
  1. 灵活性不足：无法支持创新定价模型（套餐、承诺使用折扣）
  2. 分析能力弱：财务团队无法回答基本问题，BI 团队无法构建仪表板
- **36:30** - 选择 Redshift 原因：作为运营数据仓库，提供可序列化事务隔离和分析性能
- **37:30** - Redshift Serverless 优势：无基础设施开销、自动扩展、按使用付费
- **38:00** - 成果：成本降低 75%，同时处理更多数据并提供更强一致性保证

### Twilio 架构详解 (38:00-45:00)
- **38:30** - 摄取层：数十亿事件从 MSK 流入 Redshift Serverless
- **39:00** - 两大架构决策：
  1. 可序列化事务隔离实现幂等性
  2. 自动刷新物化视图实现实时聚合
- **40:00** - 已存储超过 5000 亿事件，全部去重且可立即查询
- **40:30** - 分布式数据仓库架构：多个工作组通过数据共享访问相同数据集
- **41:00** - 工作负载隔离：摄取、定价引擎、分析各自独立运行
- **41:30** - 实时数据共享：所有工作组实时查看相同版本数据

### Twilio 定价引擎复杂性 (42:00-45:00)
- **42:00** - DBT 管道管理超过 2 亿个价格点
- **42:30** - 复杂定价规则：多层级折扣、促销折扣堆叠、多产品捆绑、分叉税收
- **43:00** - 使用 DBT Core 将定价规则分解为离散 SQL 模型
- **43:30** - Redshift 并行化处理，DBT 管理依赖关系图
- **44:00** - DBT 自动生成文档，可追溯发票行项目计算过程
- **44:30** - 性能：完整月度计费重新计算从 6 小时缩短至 30 分钟

### Zero ETL 历史模式 (45:00-47:00)
- **45:00** - 挑战：产品目录和定价配置分散在 7-8 个 Aurora 数据库中
- **45:30** - 旧系统仅存储当前状态，无法准确重新定价历史使用量
- **46:00** - 4 月推出 Zero ETL 历史模式：与 Aurora 集成，自动捕获完整变更历史
- **46:30** - 结果：可重建任意时间点账单，使用准确配置重新定价历史使用量

### Twilio 成果总结 (47:00-49:00)
- **47:00** - 成本：比之前系统降低 75%
- **47:30** - 速度：完整月度重新计算从 6 小时降至 30 分钟，财务仪表板从每日批量更新到亚分钟响应
- **48:00** - 灵活性：支持追溯定价变更、产品经理可对实时使用量建模新定价策略
- **48:30** - 新数据产品：有效定价模型，表示任何客户在任何时间对任何产品的支付价格
- **49:00** - 直接写入 S3 和 Iceberg 表，消除 Spark ETL 作业

### Twilio 未来计划 (49:00-50:00)
- **49:00** - 计划将精选财务数据集写入 Iceberg 表，使用 AWS Glue Data Catalog 索引
- **49:30** - 目标：向更广泛组织开放数据访问，无需直接访问 Redshift
- **50:00** - 引入 Odin 系统：基于 Iceberg 表和 Glue Data Catalog 的查询基础设施层，使用 Athena

### Amazon Athena 介绍 (50:00-53:00)
- **50:00** - Scott Riggney 介绍 Athena：无服务器交互式查询服务
- **50:30** - 现场调查：首次参加 re:Invent 和首次参加 Athena 会议的人数
- **51:00** - Athena 核心优势：易用性（无基础设施管理）、交互性优化（查询启动时间低于 1 秒）、数据兼容性（支持 Parquet、JSON、Iceberg、CSV 等）
- **52:00** - 与 Lake Formation 深度集成，提供细粒度访问控制
- **52:30** - 2016 年推出，目前每周处理数十亿查询

### Athena 与 S3 数据湖 (53:00-55:00)
- **53:00** - 客户选择 S3 的原因：无与伦比的持久性、可扩展性和可用性
- **53:30** - 数据湖的重大转变：开放表格式
- **54:00** - 开放表格式将熟悉的 SQL 功能引入 S3 数据湖
- **54:30** - Athena 2021 年推出开放表格式支持，Iceberg 成为领先选择

### Iceberg 优势和性能提升 (55:00-58:00)
- **55:00** - Iceberg 独特优势：处理大规模数据集、支持多查询引擎（Athena 和 Spark）、提供事务功能、不锁定单一供应商
- **55:30** - 重大公告：Athena 在 Iceberg with Parquet 上性能提升 1.5 倍（基于 TPC-DS 1TB 基准测试，与去年同期相比）
- **56:00** - 通过引擎改进和目录体验优化实现性能提升

### Iceberg 统计功能 (56:00-58:00)
- **56:30** - Iceberg 统计增强：两周前推出新更新，改进 Athena 与统计文件的交互行为
- **57:00** - 使用方法：通过 AWS Glue 收集 Iceberg 表统计信息
- **57:30** - Athena 自动应用统计信息做出更智能的查询规划决策，自动加速查询

### 会议结束
- **58:00** - 会议内容在此处截断（字幕未完整）