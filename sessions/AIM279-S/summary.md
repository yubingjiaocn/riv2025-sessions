# AWS re:Invent 2025 会议总结：Apache Spark Rapids GPU 加速技术

## 会议概述

本次会议由 Felix（加速计算与媒体产品负责人）主持，重点介绍了 Rapids 加速器在 Apache Spark 中的应用，以及 FINRA（美国金融业监管局）在实际生产环境中采用 GPU 加速技术的成功案例。会议展示了如何通过 NVIDIA GPU 芯片组运行 Apache Spark Rapids，在无需修改代码的情况下实现显著的性能提升和成本节约。

Apache Spark 作为最流行的数据处理框架之一，被几乎所有企业和组织广泛使用。随着数据量的爆炸式增长，特别是在 AI 时代，GPU 加速技术成为处理海量数据的关键解决方案。通过在 Spark 工作流中安装插件，利用云端或本地的 GPU 硬件层，企业可以在不改变代码的情况下获得更快的处理速度和更低的成本。

FINRA 作为早期采用者，分享了他们从 2013 年开始的云计算之旅，从 Apache Hive 到 Apache Spark，再到 GPU 加速 Spark 的技术演进。他们在多个生产工作负载中验证了该技术，在欺诈检测、监管报告等场景中实现了 50% 的性能提升和 45% 的成本降低。FINRA 目前在 AWS 云上运行超过 1000PB 的存储，每天处理 1500 亿条记录，GPU 加速技术已成为其大数据技术栈的战略性能杠杆。

## 详细时间线

开场介绍
- 00:00 - Felix 介绍自己是加速计算与媒体产品负责人，概述会议议程

Rapids 加速器技术介绍
- 00:30 - 介绍 Apache Spark 作为最流行的数据处理框架，被广泛用于分析、报告和机器学习
- 01:00 - 强调数据增长的惊人速度，特别是在 AI 时代
- 01:30 - 展示 GPU 加速技术栈：Spark 应用程序 + 插件 + GPU 硬件层，无需代码修改
- 02:00 - 说明虽然 GPU 有成本，但加速效果显著，最终实现更快更便宜的结果

行业应用案例
- 02:30 - 展示已公开使用该技术的企业：在线服务、零售、金融服务等行业
- 03:00 - 详细介绍欺诈检测用例：处理数十亿至数万亿条记录，回溯 5-15 年数据
- 03:30 - 欺诈检测案例结果：14 倍速度提升，90% 成本节约
- 04:00 - 提供 QR 码供观众查看 AWS FSI 团队合作发布的详细案例

FINRA 案例分享开始
- 04:30 - Alam（FINRA 大数据与性能工程高级总监）介绍自己在 FINRA 工作 20 多年
- 05:00 - 介绍 FINRA 使命：市场诚信和投资者保护，确保市场免受操纵和欺诈
- 05:30 - FINRA 技术规模：在 AWS 云上运行超过 1000PB 存储，每天处理 1500 亿条记录

FINRA 面临的挑战
- 06:00 - 市场交易量持续大幅增长，现代电子交易平台和高频交易系统带来挑战
- 06:30 - 需要在规模、成本效率和 GPU 加速之间找到平衡
- 07:00 - 强调性能、并发性、弹性和安全性的重要性

FINRA 的创新文化
- 07:30 - 创新是 FINRA DNA 的一部分，持续关注开源社区、新硬件和新服务
- 08:00 - 不断进行基准测试：Java Spark、架构优化、行业标准测试

基准测试方法
- 08:30 - 使用 TPC-DS 和实际生产工作负载进行测试
- 09:00 - 测试大型数据集、复杂的 shuffle 和 join 模式
- 09:30 - 确保输入数据、Spark 配置、集群配置在测试间保持一致，并验证输出结果

摩尔定律的实践
- 10:00 - 展示 EMR Spark 在不同硬件上的性能改进
- 10:30 - TPC-DS 9TB 基准测试：从数小时降至 45 分钟，5 倍性能提升
- 11:00 - 仅通过采用新技术（新 Spark 版本、新引擎、新实例系列）实现成本大幅降低

GPU 加速的发现
- 11:30 - 受去年 re:Invent 演讲启发，FINRA 开始探索 GPU 加速 Spark
- 12:00 - 作为 2013 年就开始使用云的早期采用者，从 Apache Hive 到 Apache Spark 的演进
- 12:30 - GPU 加速 Spark 被视为技术的新飞跃

首次 GPU 测试结果
- 13:00 - TPC-DS 9TB 测试：从 45 分钟降至约 22 分钟
- 13:30 - 50% 的性能提升和 50% 的成本降低，无需代码修改
- 14:00 - 决定在实际生产工作负载上测试

生产工作负载测试
- 14:30 - 测试监管和交易应用：关联两个各有 500 亿条记录的表
- 15:00 - 结果令人震惊：50% 性能提升，约 45% 成本降低，无需代码修改
- 15:30 - 从性能和成本节约角度，认识到这是必须深入探索的技术

优化过程的挑战
- 16:00 - 强调并非简单地"翻转开关"就能实现这些收益
- 16:30 - 首次尝试时 GPU 运行了 5 小时（比 CPU 更慢）
- 17:00 - 与 NVIDIA 团队密切合作，两个工程团队共同识别问题

性能调优
- 17:30 - 发现 GPU 有时会回退到 CPU 执行
- 18:00 - 识别多个瓶颈，NVIDIA 团队基于特定工作负载开发新插件
- 18:30 - 需要进行配置调整和优化

数据摄取工作负载案例
- 19:00 - 介绍另一个关键工作负载：会员公司每天提交数千个 CSV 文件
- 19:30 - 需要解压缩、转换为列式格式、转换为 Parquet 格式（使用 Snappy 压缩）
- 20:00 - 这是一个迭代过程，需要每天多次运行

数据摄取优化
- 20:30 - 最初 CPU 和 GPU 性能相当
- 21:00 - 再次与 NVIDIA 团队合作识别瓶颈
- 21:30 - 发现原始应用使用 Dataset API，不适合 GPU，需要转换为 DataFrame
- 22:00 - 优化后实现显著性能提升

测试总结
- 22:30 - 测试了行业基准和生产工作负载，实现更快的连接和更低的成本
- 23:00 - 某些工作负载集成 Rapids 和 DataFrame 管道后无需代码修改
- 23:30 - 运行时间和成本节约效果一致

实施考虑因素
- 24:00 - 某些管道需要代码修改
- 24:30 - 需要与 NVIDIA 建立配额关系以获取所需容量

当前状态与未来展望
- 25:00 - 总结第一阶段概念验证的结束
- 25:30 - 承认并非每个工作负载都能从 GPU 中受益，需要时间识别瓶颈
- 26:00 - 已建立 CPU 与 GPU 执行的验证流程
- 26:30 - GPU 从实验阶段演进为战略性能杠杆，基于性能优势和成本降低

结论
- 27:00 - GPU 和 Spark Rapids 已加入 FINRA 的大数据技术栈
- 27:30 - 目前 CPU 仍是默认选择，但 GPU 将成为未来的加速通道
- 28:00 - 提供联系方式和 URL，欢迎尝试和交流