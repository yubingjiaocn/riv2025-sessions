# AWS re:Invent 2025 - DAT429: 编写Amazon Aurora的MCP服务器

## 会议概述

本次技术会议由Jim和Vlad主讲，重点介绍如何为Amazon Aurora数据库构建模型上下文协议(MCP)服务器。MCP是一个通用框架，用于将后端数据暴露给大语言模型以支持生成式AI应用。会议采用现场编程的形式，演示了从基础查询编写到完整MCP服务器实现的全过程。

演讲者强调了MCP作为一个仍在发展中的规范（仅一年历史），最新版本刚在上周发布，包含了重要的安全功能。他们使用Aurora PostgreSQL作为数据源，结合Bedrock托管的模型，构建了一个娱乐中心应用，展示了如何安全地将数据库数据暴露给LLM使用。

## 详细时间线与关键要点

### 0:00-5:00 会议介绍与背景
- Jim和Vlad介绍会议形式：现场编程演示
- 介绍MCP（模型上下文协议）作为通用框架
- MCP规范仅一年历史，最新版本包含安全功能
- 将使用Aurora PostgreSQL、Bedrock和Streamlit构建应用

### 5:00-10:00 项目架构与数据模型
- 构建娱乐中心应用，包含两个MCP工具：get_movie_characters和get_actor_roles
- 使用IMDB数据集的标准化数据模型
- 演示基础Streamlit应用和时间MCP服务器
- 展示数据库表结构和PostgreSQL注释的重要性

### 10:00-15:00 使用Kiro进行开发
- 演示Kiro CLI工具与MCP服务器的集成
- 展示天气和PostgreSQL MCP服务器的配置
- 通过Kiro查询数据库表结构和schema信息
- 强调MCP服务器的信任机制和权限控制

### 15:00-25:00 编写数据库查询
- 使用Kiro生成复杂的四表连接查询
- 实现全文搜索功能查找电影角色和演员
- 优化查询性能，避免重复全文搜索
- 演示查询执行计划分析和优化建议

### 25:00-35:00 构建MCP服务器
- 使用天气MCP服务器作为模板
- 生成Python代码实现两个数据库查询工具
- 配置数据库连接和环境变量
- 处理查询结果和错误处理

### 35:00-45:00 测试和调试
- 测试MCP服务器的电影角色查询功能
- 创建自定义电影数据进行测试
- 演示LLM如何选择使用工具vs训练数据
- 讨论非确定性行为和工具选择机制

### 45:00-55:00 数据安全与行级安全
- 实现PostgreSQL行级安全(RLS)控制数据访问
- 基于用户角色限制可见的电影类型
- 演示安全策略的配置和测试
- 强调确定性安全控制的重要性
- 处理参数传递和会话管理问题

### 总结要点
- 提供GitHub仓库链接供后续参考
- 强调生产环境中成本控制的重要性
- 对比MCP方法与传统RAG方法的优劣
- 鼓励填写会议反馈调查