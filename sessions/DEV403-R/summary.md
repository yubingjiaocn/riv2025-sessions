# AWS re:Invent 2025 会议总结：使用 AI 代码助手的最佳实践

## 一、会议概述

本次 AWS re:Invent 2025 的技术分享会议由 Amazon 首席软件工程师 James Hood 和 AWS 高级开发者倡导者 Mary Cidle 共同主讲，重点介绍了 Amazon 内部如何使用生成式 AI 工具和代码助手来提升开发效率。

会议分为两个主要部分。第一部分由 Mary 介绍了与 LLM（大语言模型）交互的核心提示工程技术，包括零样本、单样本和少样本提示、上下文提示、角色提示、自洽性提示以及思维树等方法。这些技术已经在 Amazon 内部被编码为"机制"（mechanism），成为团队间共享的标准化工具，体现了 Amazon "发明与简化"的领导力原则。Mary 通过 Kiro CLI 进行了大量实时演示，展示了如何通过提供更多上下文和明确的指令来获得更准确、更符合需求的代码生成结果。

第二部分由 James 介绍了 Amazon 最新开源的 Agent SOPs（Agent Standard Operating Procedures，代理标准操作程序）。这是一个革命性的概念，将标准操作程序文档化为结构化的 Markdown 格式，包含标题、概述、参数、步骤（带约束条件）、示例和故障排除等部分。通过使用 RFC 2119 风格的关键词（如 MUST、SHOULD、MAY）来约束每个步骤的行为，Agent SOPs 使 AI 代理能够以高度一致和可预测的方式执行复杂任务。James 演示了如何使用 Agent SOPs 自动生成代码库文档、创建新的 SOP，甚至展示了如何快速为 GitHub 问题创建分类 SOP。这项技术让 James 这样的首席工程师能够在陌生的代码库和不熟悉的编程语言中，在短短几天内从概念到生产环境完成功能开发。

## 二、详细时间线与关键要点

### **开场介绍 (00:00 - 03:30)**
- **00:00** - James Hood 介绍自己是 Amazon 首席软件工程师，承诺会有一个"雄心勃勃的代码演示"
- **01:15** - Mary Cidle 自我介绍为 AWS 高级开发者倡导者，提醒观众她有听力障碍，请大家提问时大声说话
- **02:00** - Mary 说明代码助手的非确定性特性，演示过程中会坐下来进行编码
- **02:45** - 解释会议起源：Mary 观看了 James 的内部技术分享后，决定在 re:Invent 上展示这些内容

### **Amazon 的机制文化 (03:30 - 05:00)**
- **03:30** - 介绍 Amazon 的"机制"（mechanism）概念：当某个方法有效时，将其编码化并分享给整个公司
- **04:15** - 强调这与"发明与简化"领导力原则的关系，形成良性循环
- **04:45** - 展示 GitHub 仓库链接，所有演示代码都可以开源获取

### **零样本、单样本和少样本提示 (05:00 - 12:00)**
- **05:30** - Mary 开始演示零样本提示：直接询问 LLM 创建验证 IAM 策略的脚本
- **06:45** - LLM 生成 Python 代码，但这只是最基本的交互方式
- **08:00** - 演示单样本提示：提供一个 JavaScript 邮箱验证函数示例，要求创建类似的 IAM 策略验证函数
- **09:15** - LLM 理解了语言偏好，生成 JavaScript 代码而非 Python
- **10:00** - 演示少样本提示：提供多个示例，LLM 生成更精简的代码，省略了不必要的使用说明
- **11:30** - 最佳实践总结：简单任务用零样本，复杂任务用少样本提示以提供更多上下文

### **系统提示、上下文提示和角色提示 (12:00 - 18:30)**
- **12:15** - 演示系统提示：要求创建查询特定标签 EC2 实例的 Bash 脚本
- **13:30** - LLM 生成基本的 Bash 函数
- **14:00** - 演示上下文提示：说明团队管理多账户多实例的背景，要求创建适合该场景的脚本
- **15:15** - LLM 生成更符合实际工作场景的脚本，包含多账户支持
- **16:00** - 演示角色提示：告诉 LLM "你是 AWS 高级解决方案架构师"
- **17:00** - 角色提示使 LLM 从特定专业角度生成代码，可能包含更多细微差别
- **18:00** - 最佳实践：对于复杂任务，组合使用这些技术——先提供上下文，再定义角色，然后指定任务和期望的输出格式

### **自洽性提示 (18:30 - 23:00)**
- **18:45** - 介绍自洽性提示：让 LLM 生成多个独立的解决方案，然后选择最佳方案
- **19:30** - 演示：要求设计多区域高可用架构，探索三种不同方法，考虑成本、运营复杂性和延迟
- **20:45** - LLM 提出三种方案：主动-主动、主动-被动、带全局数据库的主动-主动
- **21:30** - 要求 LLM 在没有更多细节的情况下选择一个方案
- **22:15** - 解释该技术的优势：通过探索多个视角，LLM 能识别更稳健的解决方案
- **22:45** - 适用场景：复杂架构决策、疑难故障排查、安全分析、性能优化

### **思维树提示 (23:00 - 27:30)**
- **23:15** - 介绍思维树（Tree of Thought）：为 LLM 提供明确的问题解决路径
- **24:00** - 演示：Lambda 性能问题，考虑三个可能的瓶颈（冷启动、内存限制、外部 API 调用）
- **24:45** - 要求为每个瓶颈提供三种解决方案，并评估每种方案的优缺点
- **25:30** - LLM 按照结构化的分支进行探索，最终给出综合建议
- **26:15** - 适用场景：具有多个变量的复杂问题、需要考虑众多交互因素的决策
- **27:00** - 最佳实践：用清晰的分支和评估标准来构建提示，提供明确的指导

### **组合技术：思维树 + 自洽性 (27:30 - 30:00)**
- **27:45** - 演示组合使用：设计灾难恢复解决方案，使用思维树探索三种方法，对每种方法进行分析
- **28:30** - LLM 生成更全面的分析，涵盖多个维度
- **29:15** - 适用场景：关键任务系统设计、高风险架构决策
- **29:45** - 强调组合技术时要非常明确地说明希望 Kiro 如何进行思考和探索

### **使用上下文增强工具 (30:00 - 34:00)**
- **30:15** - 介绍如何向 Kiro 添加上下文信息
- **30:45** - Mary 展示已加载 Amazon 内部文档写作风格（叙述文档、单页文档、六页文档、PR FAQ）到上下文中
- **31:30** - 演示：要求撰写关于"帮助蝌蚪长成青蛙的产品"的叙述文档（虚构产品）
- **32:15** - Kiro 根据已加载的文档风格指南，自动生成符合 Amazon 标准的文档结构
- **33:00** - 文档包含成功指标、建议、市场机会等 Amazon 标准章节
- **33:45** - 强调使用这类工具可以大大简化文档编写工作

### **探索-计划-编码-提交工作流 (34:00 - 39:00)**
- **34:15** - 介绍"探索-计划-编码-提交"（Explore-Plan-Code-Commit）工作流
- **34:45** - LLM 擅长理解现有代码，可以读取代码库并理解依赖关系
- **35:15** - 演示：提供三个 JavaScript 文件（身份验证机制），让 Kiro 理解代码库
- **36:00** - 要求实现密码重置功能，考虑安全性和健壮性
- **36:45** - Kiro 生成实现计划，列出详细步骤
- **37:30** - 要求生成代码，Kiro 根据现有代码风格创建新功能
- **38:15** - 演示提交阶段：要求按照内部风格编写提交信息，包含最佳实践链接和文档
- **38:45** - 说明可以自动提交并创建 PR（如果连接到代码仓库）

### **开源资源分享 (39:00 - 40:30)**
- **39:15** - 再次展示 GitHub 仓库 QR 码
- **39:45** - 所有演示的代码和示例都已开源，可供使用和扩展
- **40:15** - 鼓励观众根据自己组织的最佳实践进行定制和改进

### **James 介绍 Agent SOPs (40:30 - 45:00)**
- **40:45** - James 接手演示，介绍自己在 Amazon 工作 16 年，曾是 AI 怀疑论者
- **41:30** - 解释之前对 AI 的怀疑：在真实代码上尝试各种演示都失败了
- **42:15** - 今年 2 月转变：意识到技术组合（推理模型、MCP、提示技术）的威力
- **43:00** - 介绍 Agent SOPs：代理标准操作程序，不到两周前刚开源
- **43:45** - 这是 Amazon 内部建设者社区的创新成果
- **44:30** - 解释 SOP 概念：详细的分步指南，用于完成常规任务

### **演示代码库摘要 SOP (45:00 - 52:00)**
- **45:15** - 进入 agent-sops 目录，展示 Strands Agent SOPs MCP 服务器
- **46:00** - 运行 codebase-summary SOP，这是默认提供的提示之一
- **46:45** - 输入参数：代码库路径（默认当前目录），consolidated=true（生成合并文件）
- **47:30** - SOP 开始执行，分析代码库结构
- **48:15** - 展示 codebase-summary.md 文件结构：标题、概述、参数（必需和可选）
- **49:00** - 关键部分：步骤列表，每个步骤都有约束条件
- **49:45** - 约束使用 RFC 2119 风格关键词：MUST（必须）、SHOULD（应该）、MAY（可以）
- **50:30** - 示例约束："必须验证代码库路径存在且可访问"、"必须使用 Mermaid 图表进行所有可视化表示"
- **51:15** - SOP 格式：标题、概述、参数、带约束的步骤、示例、故障排除
- **51:45** - 强调 Agent 和模型非常擅长遵循这些指令

### **SOP 生成的一致性 (52:00 - 55:30)**
- **52:15** - 对比传统提示：直接要求"探索代码库并编写文档"会得到差异很大的结果
- **52:45** - 使用 SOP 格式后，每次运行都会生成一致的文档结构
- **53:30** - 展示生成的文件：codebase-info.md（概述、技术栈、项目结构）
- **54:00** - architecture.md 包含 Mermaid 架构图
- **54:30** - 生成 components.md、interfaces.md 等多个摘要文件
- **55:00** - 最终生成 agents.mmd 合并文件，供代码助手使用

### **技术无畏与实际应用 (55:30 - 58:00)**
- **55:45** - James 分享首席工程师原则："技术无畏"（Technically Fearless）
- **56:15** - AI 和 Agent SOPs 让技术无畏程度提升了数个数量级
- **56:45** - 可以进入任何代码库，运行 SOP，代理就能理解并协助开发
- **57:15** - 实际案例：在不熟悉的代码库、不熟悉的语言中，2 天从概念到 PR
- **57:45** - 7 天从概念到生产环境，这是今年早些时候的"顿悟时刻"

### **创作 Agent SOPs (58:00 - 63:00)**
- **58:15** - 承认手写 SOP 看起来很繁琐
- **58:45** - 推荐方法：用 AI 代理编写 SOP
- **59:15** - 展示 steering file（引导文件），定义 SOP 格式
- **59:45** - 使用 strands-agent-sops CLI 工具
- **60:15** - 运行 rule 命令输出规则，可放入 Cursor 规则或 Kiro 引导文件
- **60:45** - Agent SOPs 是工具无关的，任何能接受 SOP 的 LLM 都可以使用
- **61:30** - 将规则复制到 Kiro 引导文件，固定在对话上下文中
- **62:15** - 即使清除对话历史，context 命令确保规则保持固定
- **62:45** - 演示创作：要求创建一个 SOP，根据人名生成有趣的短诗

### **实时创作和测试 SOP (63:00 - 68:00)**
- **63:30** - Kiro 生成 name-poem SOP，包含标准格式
- **64:00** - 配置 MCP 服务器查找额外的 SOP 文件夹
- **64:45** - 启动新的 Kiro CLI 会话，检查可用提示
- **65:15** - name-poem 提示现在可用，运行并输入名字"James"
- **65:45** - LLM 确认拼写（观众笑声），生成诗歌
- **66:30** - 展示生成的 SOP 结构：标题、概述、参数（person_name 必需）、步骤、示例
- **67:00** - 演示迭代：要求添加可选的 hometown 参数
- **67:45** - Kiro 更新 SOP，添加 hometown 参数和相应约束

### **测试更新后的 SOP (68:00 - 70:30)**
- **68:15** - 重新加载 MCP 服务器
- **68:45** - 运行更新后的 name-poem，输入"name=James, hometown=Tucson, Arizona"
- **69:15** - 强调参数传递的灵活性：可以用自然语言"My name is James and I'm from Tucson"
- **69:45** - LLM 会自动解析并提取参数
- **70:00** - 生成包含沙漠和仙人掌主题的诗歌

### **实用的 SOP 示例 (70:30 - 73:00)**
- **70:45** - James 表示作为前 AI 怀疑论者，更喜欢实用的例子
- **71:15** - 提出创建更实用的 SOP：为给定的 GitHub 仓库 URL 分类问题
- **71:45** - 强调已加载 GitHub MCP 服务器到代理上下文中
- **72:15** - SOP 创作时会知道可用的工具，可以利用这些工具
- **72:45** - 需要在上下文中加载与任务相关的 MCP 服务器

### **观众问答环节 (73:00 - 76:30)**
- **73:15** - James 询问是否有人想要诗歌或有问题
- **73:45** - 观众提问：向 LLM 提供代码时，如何确保不包含敏感信息？
- **74:30** - 观众追问：除了密码，还有什么信息需要注意？
- **75:00** - James 回答：内部使用 Amazon Bedrock，提供账户级别的隐私保护
- **75:45** - 说明 Bedrock 不会使用客户数据训练模型
- **76:15** - 讨论被截断（字幕结束）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


注意：本总结基于提供的字幕文本，会议可能在字幕结束后继续进行了更多内容。所有演示代码和 Agent SOPs 工具已在 GitHub 上开源供公众使用。