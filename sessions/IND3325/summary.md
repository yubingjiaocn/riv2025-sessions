# AWS re:Invent 2025 会议总结：零停机时间大规模迁移 - Peacock 全球流媒体平台迁移至 Amazon EKS

## 会议概述

本次技术分享会议主题为"零停机时间大规模迁移：Peacock 全球流媒体平台迁移至 Amazon EKS"（IND 3325）。会议由 AWS 首席解决方案架构师 Ian 主持，NBCUniversal/Sky 全球平台工程总监 Mans、平台基础设施负责人 Pete，以及 AWS 高级技术客户经理 Manish 共同分享了 Peacock 等全球流媒体服务从自管理 Kubernetes 集群迁移到 Amazon EKS 的完整历程。

全球流媒体技术团队负责管理包括 Peacock（美国）、SkyShowtime（欧洲）、Showmax（非洲）和 NOW/WOW（意大利、德国、英国等）在内的四个流媒体平台，服务超过 4000 万用户。团队面临的核心挑战是如何在不影响开发团队日常工作的前提下，将 1600 个应用程序从自管理 Kubernetes 平台迁移到 Amazon EKS，同时确保零停机时间和对开发者透明。

## 详细时间线与关键要点

### 0:00-5:00 会议开场与背景介绍
- 介绍演讲嘉宾和会议主题
- 播放 Peacock NBA 流媒体服务宣传片
- 强调大规模 Kubernetes 迁移的挑战性

### 5:00-15:00 全球流媒体平台概览
- **多租户架构**：单一代码库支持四个不同的流媒体平台
- **全球规模**：超过 4000 万用户，团队分布在美国、英国、捷克、葡萄牙和印度
- **体育内容优势**：拥有 NBA、NFL、英超联赛和 MLB 的重要转播权
- **技术挑战**：平台团队 70% 时间用于开发任务，30% 用于运维工作
- **迁移目标**：减少运维负担，释放更多工程时间用于创新

### 15:00-25:00 平台工程核心原则与迁移策略
- **四大核心原则**：
  - 工程师是我们的客户
  - 保护客户接口
  - 交付能力而非技术
  - 可靠性设计
- **历史背景**：从 2014-2015 年开始使用 Kubernetes，早于 EKS 发布
- **规模挑战**：需要迁移 1600 个应用、支持 1000+ 开发者和数百个业务单元

### 25:00-35:00 迁移目标与约束条件
- **五大迁移目标**：
  - 开发团队无需任何操作
  - 必须在线迁移
  - 零停机时间
  - 12 个月内完成
  - 团队甚至不知道迁移发生了
- **传统方案分析**：构建新平台需要 61 名全职工程师工作一年
- **AWS 合作**：利用 AWS 解决方案架构师专业知识和经过验证的架构模式

### 35:00-45:00 六阶段迁移流程详解
- **阶段一**：预检验证，降低 Route 53 区域 TTL
- **阶段二**：构建 EKS 集群和端到端测试套件
- **阶段三**：使用 Velero 创建快照，停止管道变更
- **阶段四**：工作负载迁移，采用 50-50 扩展策略
- **阶段五**：DNS 区域委托，流量切换到 EKS
- **阶段六**：重新启用管道，完成迁移

### 45:00-54:00 测试策略与复杂工作负载处理
- **综合测试套件**：
  - 合成负载测试（P99、P99.5 延迟监控）
  - 区域验证测试
  - 节点和集群级别检查
  - VPC 流日志分析防火墙问题
- **复杂工作负载**：Kafka 生产者/消费者迁移需要精细化自动化处理
- **多区域策略**：利用多区域架构转移流量，等待队列清零
- **VictoriaMetrics**：替代 Prometheus 处理大规模监控需求

### 54:00-54:30 迁移成果与未来展望
- **时间成果**：前 6 个月构建工具和自动化，后 4 个月完成全部迁移
- **运维改善**：BAU 工作从 30% 降至 10%，升级速度提升 6 倍
- **代码简化**：删除 50,000 行代码
- **未来方向**：扩展声明式接口到数据库、CDN 等其他基础设施组件
- **AWS 企业支持**：通过 AWS Countdown 和技术客户经理获得关键支持