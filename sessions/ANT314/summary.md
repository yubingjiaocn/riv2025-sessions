# AWS re:Invent 2025 会议总结：从词法搜索到混合搜索再到智能体搜索

## 一、会议概述

本次 AWS re:Invent 2025 分会场由三位演讲者共同呈现，分别是 AWS 高级首席解决方案架构师 John Handler、Amazon OpenSearch Service 产品经理 Bobby Muhammad，以及日本 Recruit 公司的机器学习工程师 Rioske Sudo。会议主题聚焦于搜索技术的演进，从传统的词法搜索（Lexical Search）发展到语义搜索（Semantic Search），再到混合搜索（Hybrid Search），最终探讨了智能体搜索（Agentic Search）的未来趋势。

演讲者首先阐述了搜索引擎在现代应用中的核心地位——无论是电商平台、搜索引擎还是文档管理系统，搜索都是用户表达意图和需求的主要方式。传统的词法搜索依赖于关键词匹配，虽然在精确查询场景下表现良好，但在处理拼写错误、同义词或抽象查询时存在明显局限。随着大语言模型和嵌入模型的发展，语义搜索能够理解查询的深层含义，但在处理精确匹配需求时又显得不够精准。因此，混合搜索应运而生，结合了两者的优势。会议还特别介绍了 Recruit 公司在日本最大的餐厅搜索平台 Hot Pepper Gourmet 上的实践案例，展示了混合搜索如何在实际业务中带来显著的效果提升。

最后，会议展望了智能体搜索的未来，这是一种由推理驱动的检索方式，能够通过智能体推理循环动态地分解复杂查询、丰富上下文，并迭代优化搜索结果，为下一代搜索应用提供了新的可能性。

## 二、详细时间线与关键要点

### **00:00 - 开场介绍**
- 三位演讲者自我介绍：John Handler（AWS 高级首席解决方案架构师）、Bobby Muhammad（OpenSearch Service 产品经理）、Rioske Sudo（Recruit 机器学习工程师）
- 会议分为三个部分，分别由三位演讲者主讲

### **00:30 - 搜索的重要性与挑战**
- 互动环节：几乎所有观众都在 Amazon.com 购物时使用过搜索功能
- 搜索是用户表达意图的核心方式，适用于电商、搜索引擎、文档管理等多种场景
- 传统搜索依赖词汇匹配，但存在明显的局限性

### **01:30 - 词法搜索的问题**
- 示例：搜索"适合看体育比赛的电视"，用户期望的是高刷新率、高亮度的特性，但这些词汇并未直接出现在查询中
- 词法搜索主要匹配关键词（如"TV"），无法理解查询的深层含义

### **02:00 - OpenSearch 简介**
- OpenSearch 是社区驱动的开源 AI 搜索和日志分析套件
- 在 Linux 基金会下采用开放治理模式
- 主要成员包括 AWS、IBM、SAP 和 Uber

### **02:30 - Amazon OpenSearch Service**
- 完全托管的 OpenSearch 服务，简化部署和运维
- 性能提升显著（从 1.3 版本到 2.19 版本提升 6 倍）
- 提供多种成本优化选项和与 AWS 服务的集成

### **03:00 - OpenSearch 架构**
- 分布式数据库系统，包含数据节点、集群管理节点、协调节点和超温节点
- 提供 Serverless 选项，用户只需创建集合并通过 REST API 发送数据

### **04:00 - 词法搜索的工作原理**
- 文本分析：通过语言感知分析器处理文本块，包括词干提取、停用词移除和同义词添加
- 倒排索引：将每个词项映射到包含该词项的文档
- BM25 评分：根据词项的稀有度和出现频率计算相关性分数

### **06:00 - 语义搜索的引入**
- 使用嵌入模型提取文本的语义含义
- 适合处理抽象查询和多语言场景
- 不适合精确查询（如具体的产品型号）

### **07:00 - 向量嵌入的工作流程**
- 从文档中提取文本块，发送到 Bedrock 或 SageMaker 生成向量嵌入
- 将向量嵌入添加到文档中并摄取到 OpenSearch
- 通过最近邻搜索找到相似文档

### **08:00 - 相似度度量**
- 欧几里得距离：计算向量之间的笛卡尔距离
- 余弦相似度：通过向量之间的角度判断相似性

### **09:00 - Neural Plugin 介绍**
- 提供连接器库，连接外部嵌入模型和大语言模型
- 支持摄取管道，自动生成向量嵌入
- 提供 Neural Query，简化查询嵌入的生成

### **10:30 - 批量推理和自动语义丰富**
- 支持通过 OpenSearch Ingestion 调用 Bedrock 批量推理
- 自动语义丰富功能支持稀疏向量模型

### **11:00 - 混合搜索的必要性**
- 词法搜索适合精确查询，语义搜索适合抽象查询
- 混合搜索结合两者优势，适用于大多数搜索场景

### **11:30 - 混合搜索的实现**
- 使用 Hybrid Query，并行运行多个查询子句（如 Neural Query 和 Sparse Query）
- 通过搜索管道混合评分

### **12:00 - 评分混合方法**
- 数值归一化：将不同评分范围归一化到相同尺度后平均
- 倒数排名融合（RRF）：基于结果位置权重进行混合，更稳定

### **13:00 - 混合搜索的性能提升**
- 在标准语料库（NF Corpus、ArguAna、Quora）上测试
- 使用 NDCG@10 指标，RRF 方法在某些场景下提升高达 12-13%

### **14:00 - Recruit 公司案例介绍**
- Rioske Sudo 登场，介绍 Recruit 公司及其餐厅搜索平台 Hot Pepper Gourmet
- Hot Pepper Gourmet 是日本最大的餐厅搜索和预订平台，每天处理数十万次预订

### **15:00 - 搜索挑战**
- 原始系统依赖词法搜索，对拼写错误和日语分词问题敏感
- 示例：搜索"寿司餐厅"时，拼写错误会导致匹配失败

### **16:00 - 向量搜索的局限性**
- 示例：搜索"Sushi Hero"时，向量搜索可能返回"Sushi Magic"而非"Sushi Hero on Strip"
- 原因：向量搜索关注语义而非精确关键词匹配

### **17:00 - 选择 OpenSearch 的原因**
- 混合搜索功能易于实现
- 完全托管，简化开发和运维
- 丰富的生态系统，包括 ETL 工具和语言插件

### **18:00 - 向量模型架构**
- 使用双塔模型（Two-Tower Model），分别编码查询和文档
- 基于用户日志和合成数据进行微调
- 轻量级微调模型优于大型语言模型

### **19:00 - 内置混合搜索的尝试**
- 使用 OpenSearch 内置的混合搜索功能，实现简单
- 带来了显著的业务影响，但仍有优化空间

### **20:00 - 内置混合搜索的局限性**
- OpenSearch 先并行运行词法和向量搜索，然后归一化并合并评分
- 问题：无法区分不同评分组合的含义（如拼写错误 vs. 领域特定词汇）

### **21:00 - 自定义混合搜索架构**
- 构建自定义执行器，分别获取词法和向量评分
- 将两个评分分别输入到自定义排序器中
- 排序器结合用户日志和其他信号进行智能排序

### **22:00 - 业务影响**
- 通过搜索的预订量提升 10%
- 零结果搜索减少 90%

### **23:00 - 最终架构**
- 自定义排序器和向量模型运行在 ECS 容器中
- 提供更大的灵活性和可扩展性

### **24:00 - 关键收获**
- 蓝绿部署实现零停机扩展
- OpenSearch 加速实验迭代
- 混合搜索和摄取功能帮助快速启动

### **25:00 - 未来展望**
- 希望支持基于模型的融合方法
- 探索多向量搜索以提高准确性
- 感谢 AWS 发布 OpenSearch 3.3 版本

### **26:00 - 智能体搜索介绍（Bobby Muhammad）**
- 智能体工作负载与传统工作负载的区别
- 传统：单次查询，毫秒级响应
- 智能体：多次密集查询，实时响应，动态迭代推理循环

### **27:00 - 智能体推理循环**
- 包含 LLM（大脑）、工具、数据源
- 迭代检索信息直到满足目标
- 检索是智能体的基础层

### **28:00 - 上下文丰富的挑战**
- LLM 上下文窗口虽然扩大（从数千到数百万 token），但仍不足以处理生产级智能体
- 检索质量和延迟问题：信息过载导致检索质量下降
- 上下文管理：需要外部机制在内存层次间移动信息

### **29:30 - RAG 的局限性**
- RAG 是过去两年最流行的用例
- 适合单查询静态系统
- 无法进行推理，限制了复杂场景的应用

### **30:30 - 智能体搜索的优势**
- 由推理驱动的检索
- 能够分解复杂查询，生成子查询和 DSL 查询
- 通过 MCP 协议与多个工具交互，丰富数据

### **31:00 - 会议结束**
- 演讲者总结并感谢观众

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


关键技术要点总结：
- 词法搜索：基于关键词匹配，适合精确查询
- 语义搜索：基于向量嵌入，理解查询含义
- 混合搜索：结合词法和语义搜索，使用 RRF 或数值归一化混合评分
- 智能体搜索：由推理驱动，动态迭代优化检索结果