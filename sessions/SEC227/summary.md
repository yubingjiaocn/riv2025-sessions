# AWS re:Invent 2025 - Amazon GuardDuty 恶意软件防护会议总结

## 会议概述

本次会议由 Amazon GuardDuty 的高级产品经理 Sujay Dosshi、拥有40年反恶意软件研究经验的 Peter Ferry，以及来自银行业的高级安全工程师 Mika 共同主讲。会议重点介绍了 GuardDuty 恶意软件防护套件的最新功能和技术实现。

GuardDuty 是 AWS 的原生威胁检测服务，被95%的 AWS 前2000大客户所信任。该服务通过分析数十万客户的数百万 EC2 实例和 S3 存储桶，提供账户和资源级别的入侵可见性。GuardDuty 的核心优势在于其可以访问内部威胁情报系统（如 Mitra 域名信誉服务和 Mattpot 蜜罐系统），这些系统能够比传统威胁情报提供商提前数天、数周甚至数月发现恶意域名和攻击行为。会议特别强调了2024年 Prime Day 期间，GuardDuty 在一小时内处理了近9万亿个事件，同比增长49%，展示了其强大的自动扩展能力。

会议的核心内容聚焦于恶意软件防护的三大产品线：EC2 的无代理恶意软件扫描、S3 对象的恶意软件检测，以及最新推出的 AWS Backup 备份扫描功能。特别值得关注的是备份扫描功能，它解决了传统实时扫描工具无法检测到的"休眠恶意软件"问题。Peter Ferry 深入讲解了 GuardDuty 扫描引擎的内部工作原理，包括哈希引擎、模式匹配引擎、机器学习引擎和第三方引擎的协同工作机制，以及运行时检测服务如何提供系统级可见性。

## 详细时间线

### 开场介绍（00:00 - 05:00）
- **00:00** - 会议开始，Sujay Dosshi 自我介绍，即将在 Amazon GuardDuty 团队工作满四年
- **00:30** - Peter Ferry 介绍自己在 Amazon 工作5年半，从事反恶意软件研究已有40年
- **01:00** - Mika 介绍自己在银行担任高级安全工程师近三年
- **01:30** - 现场调查：询问有多少人正在使用 GuardDuty 恶意软件防护功能
- **02:00** - 会议议程介绍：服务概述、新功能发布、扫描引擎深度解析、客户案例分享

### GuardDuty 服务概述（05:00 - 15:00）
- **05:00** - GuardDuty 基本介绍：AWS 原生威胁检测服务，被95%的前2000大客户使用
- **06:00** - 服务规模：监控数百万 EC2 实例和 S3 存储桶
- **07:00** - Mitra 系统介绍：基于图神经网络的域名信誉服务，监控 Amazon 过去7天的所有 DNS 流量
- **08:00** - Mattpot 系统介绍：全球分布式威胁传感器蜜罐系统，追踪攻击者行为和战术
- **09:00** - 2024年 Prime Day 数据：一小时内处理近9万亿个事件，同比增长49%
- **10:00** - 数据源介绍：CloudTrail 管理事件、VPC 流日志、DNS 查询日志为基础数据源
- **11:00** - 可选保护计划：S3 数据平面事件、Lambda 监控、运行时代理
- **12:00** - 完全托管服务优势：无需客户端配置，自动从后端流获取数据
- **13:00** - 分析引擎组成：威胁情报、基于启发式的 TTP 检测算法、机器学习异常检测
- **14:00** - 2022年首次推出恶意软件扫描功能，扩展到资源扫描领域

### EC2 恶意软件防护（15:00 - 22:00）
- **15:00** - 2022年推出的 EC2 恶意软件防护：无代理解决方案，一键启用
- **16:00** - 核心价值：无需安装、更新或管理代理
- **17:00** - 容器感知能力：可检测容器部署中的恶意软件
- **18:00** - 自动化工作流：检测到网络异常时自动扫描 EBS 卷
- **19:00** - 按需扫描：支持调查和取证工作流程
- **20:00** - 无性能影响：不影响实时工作负载
- **21:00** - 解决痛点：自动化了之前需要手动快照、扫描、关联的流程

### S3 恶意软件防护（22:00 - 30:00）
- **22:00** - S3 恶意软件防护介绍：保护数据管道安全
- **23:00** - 应用场景：不受信任的上传应用，外部供应商或内部用户上传数据
- **24:00** - 防止成为恶意软件接收者或分发者
- **25:00** - 自动监控新对象上传并扫描
- **26:00** - 通过 EventBridge 生成扫描通知
- **27:00** - 对象标签功能：扫描完成后自动附加标签
- **28:00** - 基于标签的访问控制：实现隔离和检疫用例
- **29:00** - 扫描引擎自动更新：无需管理基础设施或更新签名

### 按需扫描 API（30:00 - 35:00）
- **30:00** - 几周前推出的新功能：按需扫描 API
- **31:00** - 扫描现有 S3 对象：不仅限于新上传的对象
- **32:00** - 建立安全基线：为已存在的存储桶建立安全基准
- **33:00** - 混合策略：结合持续监控和回溯扫描
- **34:00** - API 集成：根据操作流程自定义编排

### AWS Backup 恶意软件扫描（35:00 - 55:00）
- **35:00** - 最新推出的完全托管备份扫描服务
- **36:00** - 从 AWS Backup 控制台配置，作为备份计划的一部分
- **37:00** - 持续监控：备份作业完成后自动扫描
- **38:00** - 支持的资源类型：EBS 快照、EC2 AMI、S3 恢复点
- **39:00** - 按需扫描：调查历史备份，用于安全恢复工作流
- **40:00** - 两种扫描模式：完全扫描和增量扫描
- **41:00** - 增量扫描：仅扫描变化的数据，提供成本效益
- **42:00** - 完全扫描：提供更高的安全保证，使用最新检测定义验证
- **43:00** - 最小化配置：无需手动扫描和恢复工作流
- **44:00** - 消除业务恢复延迟：特别是在勒索软件事件中

### 为什么要扫描备份（45:00 - 55:00）
- **45:00** - 14天保留期时间线示例开始
- **46:00** - 第1-7天（绿色阶段）：恶意软件已植入但处于休眠状态
- **47:00** - 休眠期特征：无系统变化、无文件影响、无加密、无恶意工件
- **48:00** - "干净备份"定义：在隔离环境中恢复可以消除环境依赖的恶意软件
- **49:00** - 第8-10天（黄色阶段）：早期阶段工件出现
- **50:00** - 低噪音变化：EDR 工具或实时扫描难以检测
- **51:00** - 仍可进行外科手术式修复和项目级恢复
- **52:00** - 第11-14天（红色阶段）：勒索软件事件发生
- **53:00** - 生产系统和新备份全部受损，不安全恢复
- **54:00** - 关键要点：主动保存干净备份，识别干净或受感染的备份

### 备份扫描的价值（55:00 - 65:00）
- **55:00** - 真实环境时间跨度：初始入侵可能发生在3周前
- **56:00** - 最后已知干净备份可能在2周前
- **57:00** - 保留窗口风险：可能失去所有干净备份
- **58:00** - 自然盲点：早期威胁绕过实时扫描解决方案
- **59:00** - 休眠行为检测：传统 EDR 工具无法检测
- **60:00** - 自动备份扫描解决方案：持续扫描静态备份数据
- **61:00** - 抽象保管库级构造：备份作业完成后自动启动扫描
- **62:00** - 持续跟踪变化：识别备份从干净到不安全再到受损的转变
- **63:00** - 定义最后已知干净备份：用于勒索软件事件恢复
- **64:00** - 第二层防御：与实时工作负载扫描互补而非竞争

### 定期完全扫描的重要性（65:00 - 75:00）
- **65:00** - 成本效率与安全保证的平衡
- **66:00** - 场景示例：第1天完全扫描，第2-4天增量扫描
- **67:00** - 零日恶意软件场景：第4天植入但检测定义尚未更新
- **68:00** - 标记为"未发现威胁"：即使威胁存在
- **69:00** - 第5天后引擎更新：获得零日恶意软件检测定义
- **70:00** - 仅增量扫描的问题：继续附加错误的处置标签
- **71:00** - 第7天定期完全扫描：使用最新定义重新扫描
- **72:00** - 正确识别威胁：标记备份7包含威胁
- **73:00** - 维护备份谱系：跟踪父备份关系
- **74:00** - 增量扫描继承状态：从重新建立的基线继承

### 实施工作流和控制台演示（75:00 - 85:00）
- **75:00** - 示例实施工作流：GuardDuty 发现结果
- **76:00** - EventBridge 通知：触发自定义实施
- **77:00** - Lambda 函数：标记备份
- **78:00** - SCP 策略：确保永不从受感染备份恢复
- **79:00** - 干净备份处理：移动到隔离环境
- **80:00** - 逻辑气隙保管库：确保安全恢复
- **81:00** - 控制台配置：在备份计划中提供扫描器角色
- **82:00** - 定义扫描资源：选择要扫描的资源类型
- **83:00** - 选择扫描模式：完全或增量
- **84:00** - 扫描频率：每日、每小时、每周、每月

### 定价和最佳实践（85:00 - 95:00）
- **85:00** - 统一定价：所有资源类型（EBS、S3、EC2）每 GB 5美分
- **86:00** - 增量扫描：首次扫描为完全扫描，后续为增量
- **87:00** - 定价示例：100GB 卷首次扫描5美元
- **88:00** - 增量成本：仅2GB 变化时成本更低
- **89:00** - 最佳实践1：自动增量扫描以提高成本效率
- **90:00** - 最佳实践2：定期完全扫描以重新建立基线和保证
- **91:00** - 最佳实践3：安全事件恢复时始终按需扫描
- **92:00** - 基础 GuardDuty 建议：虽非必需但推荐启用
- **93:00** - 勒索软件检测：S3 数据平面事件中的加密和异常活动
- **94:00** - 综合信号：结合多个功能获得更高保真度的发现

### 扫描引擎深度解析 - Peter Ferry（95:00 - 130:00）
- **95:00** - GuardDuty 多引擎架构介绍
- **96:00** - 哈希引擎：主要用于抑制误报
- **97:00** - 快速响应：在爆发时几分钟内添加检测
- **98:00** - 加速哈希操作：优化的哈希计算
- **99:00** - 对文件微小变化的弹性：不同于传统实现
- **100:00** - 可变内容处理：可以绕过文件中间的可变部分进行哈希
- **101:00** - 附加内容处理：哈希到可变内容开始的位置
- **102:00** - 恒定哈希：即使添加或更改可变部分
- **103:00** - 应对频繁更换站点的攻击者

### 模式匹配引擎（105:00 - 120:00）
- **105:00** - 模式匹配引擎介绍：用于哈希不适用的场景
- **106:00** - 灵活性：支持传统基于签名的扫描
- **107:00** - 条件评估：在文件特定点执行条件评估
- **108:00** - 频率分析：分析已见字节的频率
- **109:00** - 位级特征提取：用于细粒度模式匹配
- **110:00** - 高表达性：检测意图清晰
- **111:00** - 特定检测用例：跨副本的恒定代码
- **112:00** - 实际恶意软件示例：远程执行任意命令的代码
- **113:00** - 单一检测：简单示例
- **114:00** - 通用检测：多个变体仅略有不同
- **115:00** - 多态引擎示例：改变副本间的外观
- **116:00** - 插入随机字符：在解密器主体中
- **117:00** - 随机变量名：变量名更改为随机字符串
- **118:00** - 极端示例：恒定部分减少到最小长度
- **119:00** - 单一检测覆盖：尽管第一个和最后一个示例差异巨大

### 机器学习引擎（120:00 - 135:00）
- **120:00** - 机器学习引擎：专注于加密货币挖矿程序
- **121:00** - 加密货币挖矿是重大问题
- **122:00** - 时间线示例：从配置错误到受损状态不到4.5天
- **123:00** - 几乎立即发现：挖矿程序安装非常快
- **124:00** - 动态分析视角：超过60%的受损工作负载涉及加密货币挖矿
- **125:00** - 最常见的后利用活动
- **126:00** - 静态分析数据：一周扫描结果中8000个随机样本
- **127:00** - 45%是加密货币挖矿程序
- **128:00** - 即使90%相同，每周仍有300多个独特样本
- **129:00** - 机器学习模型的重要性：处理大量工作
- **130:00** - 其他引擎清理剩余部分

### 第三方引擎和运行时检测（135:00 - 150:00）
- **135:00** - 第三方引擎：从供应商接收的 SDK
- **136:00** - 完全隔离实例：无法连接云提供商或互联网
- **137:00** - 仅输出发现结果：谨慎接受以最小化数据泄露
- **138:00** - 历史检测用途：供应商见过我们可能从未见过的样本
- **139:00** - 不自动收集客户样本：不与供应商共享
- **140:00** - 启发式检测：供应商的机器学习模型
- **141:00** - 开发自有启发式：针对特定环境
- **142:00** - 文件格式解析器：存档、图像、文档
- **143:00** - 自有解析器开发：提高扫描性能
- **144:00** - 特定文件格式：供应商可能从未见过

### 运行时服务（145:00 - 155:00）
- **145:00** - 运行时服务介绍：在实例上运行
- **146:00** - 系统级可见性：实时监控所有活动
- **147:00** - 文件系统和网络事件
- **148:00** - 容器感知：可查看 EKS 和 ECS 内部
- **149:00** - 事件收集为信号：信号集合关联为发现
- **150:00** - 扩展威胁检测示例：详细级别展示
- **151:00** - 新下载文件检测：文件系统事件触发
- **152:00** - 哈希计算和查找
- **153:00** - 拒绝列表匹配：哈希在拒绝列表中发现
- **154:00** - 会议结束

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


注： 本总结基于提供的字幕文本，时间戳为估算值。会议主要涵盖 Amazon GuardDuty 恶意软件防护的完整产品线、技术架构和实际应用场景。