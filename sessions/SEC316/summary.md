# SEC316: Amazon Inspector 漏洞管理策略

## 会议概述

本次AWS re:Invent 2025分会场会议由Amazon Inspector团队的高级经理Rick Anthony主持，产品经理Anthony和Nirali共同参与。会议重点介绍了Amazon Inspector作为自动化漏洞管理服务的核心功能和最新发展，特别是代码安全(Code Security)这一新特性。

演讲者详细阐述了传统漏洞管理面临的挑战，包括缺乏云原生设计、资源动态性管理困难、许可证模式不适配以及发现结果优先级排序问题。Amazon Inspector通过自动化和持续扫描的方式解决这些痛点，支持EC2实例、ECR容器镜像、Lambda函数以及GitHub/GitLab代码仓库的全面监控。会议还展示了Inspector如何通过智能评分系统、恶意包检测以及左移安全策略，帮助组织建立更有效的漏洞管理体系。

## 详细时间线与关键要点

### 0:00-10:00 开场介绍与传统漏洞管理挑战
- **会议开场**：Rick Anthony介绍团队成员和议程安排
- **传统漏洞管理痛点**：
  - 解决方案未针对云环境设计，无法适应弹性扩缩容
  - 支持多种计算类型（虚拟机、容器、无服务器）的复杂性
  - 资源约束和动态环境下的可见性问题
  - 基于资源的许可证模式不适合动态云环境
  - 扫描结果数量庞大且优先级排序困难

### 10:00-20:00 Amazon Inspector核心概念与架构
- **Inspector定义**：自动化漏洞管理服务，持续监控软件漏洞和网络暴露
- **两大核心特性**：自动化运行和持续扫描
- **支持的资源类型**：EC2实例、ECR容器镜像、Lambda函数、GitHub/GitLab代码仓库
- **四个使用阶段**：
  - 启用阶段：账户或组织级别配置
  - 发现扫描监控：实时资源发现和漏洞检测
  - 发现结果上下文化：智能评分和优先级排序
  - 采取行动：多渠道修复和集成

### 20:00-30:00 组织级部署与智能评分系统
- **组织级管理**：委托管理员账户统一配置和可见性
- **自动启用**：新账户自动开启Inspector扫描
- **近实时监控**：资源变更时自动触发扫描
- **Amazon Inspector Score**：
  - 综合考虑漏洞严重性、网络暴露、已知利用等因素
  - 与Recorded Future合作提供高级漏洞情报
  - 支持MITRE ATT&CK映射和CISA已知利用漏洞

### 30:00-40:00 恶意包检测与实际案例
- **恶意包检测**：与OpenSSF合作的近实时恶意包识别
- **检测技术**：结合静态/动态分析和AI规则
- **重大发现**：检测到超过150,000个NPM恶意包的代币化挖矿活动
- **客户案例**：Volkswagen Financial Services在14分钟内完成CVE影响评估
- **演示展示**：ECR中恶意包anhackle/test的自动检测过程

### 40:00-50:00 Inspector功能详解与配置选项
- **EC2扫描模式**：
  - 基于代理：使用SSM Agent
  - 混合模式：结合代理和无代理扫描（推荐）
- **网络可达性分析**：自动推理确定互联网可达性
- **Linux深度检查**：自定义路径扫描配置
- **Lambda扫描**：标准包扫描和代码扫描两种模式
- **ECR镜像扫描**：基础扫描vs增强扫描，支持容器映射

### 50:00-58:00 代码安全功能与左移策略
- **冰山理论**：生产环境漏洞只是表面，开发阶段预防更重要
- **Log4J案例**：4年后仍有30%下载为易受攻击版本
- **代码安全扫描范围**：
  - 软件组成分析(SCA)：第三方依赖包
  - 静态应用安全测试(SAST)：第一方代码
  - 基础设施即代码(IaC)：Terraform、CDK配置
- **改进的治理模型**：在开发者工作流中原生嵌入安全检查
- **GitHub/GitLab集成**：PR评论中直接显示漏洞和修复建议
- **演示展示**：Python应用中硬编码密钥和远程代码执行漏洞的检测