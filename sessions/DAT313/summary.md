# DAT313: 使用生成式AI增强DocumentDB应用智能

## 会议概述

本次会议由Amazon DocumentDB的首席解决方案架构师Cody Allen和高级解决方案架构师Doug Bonser主讲，重点介绍了如何在Amazon DocumentDB上利用生成式AI技术构建智能应用。演讲者强调，虽然生成式AI已成为企业级倡议，但真正的差异化因素在于企业自身的数据。会议展示了三种主要的访问模式：TSQL到MongoDB查询语言的转换工具、RAG（检索增强生成）架构，以及模型上下文协议（MCP）服务器的应用。

演讲者通过实际演示展现了如何将向量嵌入与现有数据存储相结合，避免为AI应用创建新的数据架构。他们强调DocumentDB的向量搜索功能可以简化架构复杂性，将向量搜索和数据源搜索统一在同一存储库中运行。会议还深入探讨了向量索引的最佳实践，包括IVFFlat和HNSW两种索引类型的选择标准和性能权衡。

## 详细时间线与关键要点

### 00:00-05:00 会议开场与背景介绍
- 介绍会议主题：DocumentDB与生成式AI的结合
- 演讲者自我介绍：Cody Allen（首席解决方案架构师）和Doug Bonser（高级解决方案架构师）
- 强调生成式AI已成为企业级倡议，McKinsey研究显示其将为全球经济年增2.6-4.4万亿美元价值
- 核心观点：数据是生成式AI应用的差异化因素

### 05:00-10:00 数据架构与向量嵌入基础
- 客户希望利用现有数据架构构建生成式AI工作流，而非创建新的数据架构
- 将向量存储与现有数据库结合的优势：简化架构、减少数据移动、提升性能、降低许可成本
- 向量嵌入概念解释：将文本转换为数字表示，使机器能够理解上下文
- 客户应用场景：改善客户体验、提高员工生产力、创建新内容、优化业务运营

### 10:00-20:00 第一个访问模式：TSQL到MongoDB转换工具演示
- 介绍Amazon Bedrock驱动的DocumentDB TSQL插件
- 演示Ollama本地版本：使用Code Llama 7B模型进行本地TSQL到MQL转换
- 展示如何将简单的SQL查询（SELECT  FROM table）转换为MongoDB查询语法
- 演示复杂查询转换，包括多字段选择、WHERE子句、COUNT聚合等
- 展示Bedrock云端版本，使用Claude 3模型进行转换

### 20:00-35:00 第二个访问模式：RAG架构演示
- RAG（检索增强生成）架构解释：获取相关信息、添加到上下文、生成响应
- 演示在线鞋店客服场景：结合运营数据存储和政策文档进行智能回复
- RAG架构流程：用户提问→查询情境数据→生成问题嵌入→相似性搜索→合成提示→返回响应
- DocumentDB聊天机器人演示：
  - 使用1500页DocumentDB开发者指南、博客文章等作为知识库
  - 创建5400个文档块，每个1000字符，200字符重叠
  - 使用Titan Text Embedding v2模型创建嵌入

### 35:00-45:00 RAG演示深入应用
- 演示简单问题：DocumentDB是否提供无服务器实例
- 复杂查询演示：如何审计集群登录，包括CloudWatch日志配置
- 索引相关查询：创建部分索引的具体语法
- 数据建模建议：从PostgreSQL迁移到DocumentDB的架构设计
- 游戏平台复杂场景：处理玩家进度、成就追踪等多表关系的文档数据库设计
- 多语言支持演示：葡萄牙语查询的自动翻译和回复

### 45:00-50:00 第三个访问模式：MCP服务器
- Doug Bonser介绍模型上下文协议（MCP）服务器
- MCP架构组件：主机、客户端、服务器、数据源
- MCP服务器三大功能：资源（只读数据）、提示（预定义指令）、工具（执行操作）
- DocumentDB MCP服务器演示：
  - 使用Klein在Visual Studio Code中连接DocumentDB
  - 16种不同工具：连接、断开、查找、聚合等
  - 电商销售趋势分析案例：自动生成Python代码进行数据分析

### 50:00-54:00 最佳实践与总结
- 向量索引类型选择：IVFFlat vs HNSW
  - IVFFlat：索引更小、内存使用少、需要预填充数据、数据更新需重建索引
  - HNSW：构建时间长、内存使用多、准确性更高、延迟更低、无需重建索引
- 索引构建时间对比：HNSW明显慢于IVFFlat，但在数据加载前创建索引可显著提升性能
- 向量嵌入存储空间计算：key长度+1+维度×13字节
- 性能调优建议：根据QPS需求、查询延迟、召回率等要求选择合适的索引类型和参数
- 核心建议：尽早开始实验、探索新的工作方式、利用DocumentDB向量支持的优势