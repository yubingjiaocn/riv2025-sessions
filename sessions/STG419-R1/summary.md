# AWS re:Invent 2025 SG419 会话总结

## 会话概述

本次会话（SG419）由AWS解决方案架构师Matt Boyd和Pierre主讲，主题是"现代化托管文件传输与自动化文件处理"。会话采用代码演示（Code Talk）形式，向观众展示如何使用AWS服务构建现代化的托管文件传输（MFT）系统。

演讲者首先介绍了托管文件传输在各行业中的重要性，包括金融、物流和数据分析等领域。传统的MFT系统存在运维开销大、扩展性差等问题，因此需要向云原生架构转型。本次会话通过一个保险理赔处理的实际用例，演示了如何使用AWS Transfer Family、Amazon GuardDuty、Amazon Bedrock等服务，结合基础设施即代码（Terraform）和事件驱动架构，构建一个安全、可扩展、智能化的文件传输和处理系统。

整个解决方案分为四个阶段逐步构建：第一阶段部署Transfer Family SFTP服务器和自定义身份提供商；第二阶段集成GuardDuty恶意软件扫描；第三阶段使用AI代理（Agentic AI）实现智能文件处理；第四阶段提供基于Web的用户界面。演讲者通过实时编码和部署，展示了如何使用Terraform模块快速部署这些服务，并强调了模块化、标准化和CI/CD自动化部署的最佳实践。

## 详细时间线

### 开场与介绍 (00:00 - 05:30)
- **00:00** - 会话开始，演讲者Matt Boyd和Pierre进行开场互动，询问观众参会原因
- **01:15** - 介绍演讲者身份：AWS解决方案架构师
- **01:45** - 概述会话议程：托管文件传输基础、Transfer Family功能、用例架构、Agentic AI应用、实时编码演示
- **02:30** - 解释托管文件传输（MFT）的定义：安全的文件交换和处理，通常在已知业务伙伴之间进行

### 托管文件传输的重要性 (05:30 - 08:00)
- **05:30** - 说明MFT在各行业的关键作用：金融清算、物流供应链追踪、数据分析文件摄取
- **06:15** - 强调MFT是企业核心业务流程的一部分
- **06:45** - 提出现代化需求：摆脱传统工具和运维负担
- **07:20** - 介绍构建现代MFT系统的核心组件：AWS Transfer Family、GuardDuty恶意软件扫描、Agentic工作流、基础设施即代码

### AWS Transfer Family服务介绍 (08:00 - 11:30)
- **08:00** - 介绍Transfer Family的三大功能：文件传输服务器、SFTP连接器、Web应用
- **08:45** - 文件传输服务器特性：全托管、自动扩展、S3后端存储、支持SFTP/FTPS/AS2协议
- **09:30** - SFTP连接器：全托管SFTP客户端，通过API使用，无需维护基础设施
- **10:15** - Web应用：为S3文件提供安全的基于Web的访问界面
- **10:50** - 强调与Amazon EventBridge的集成，实现事件驱动架构

### 用例介绍：保险理赔处理 (11:30 - 16:00)
- **11:30** - Pierre接手演讲，介绍保险理赔处理用例
- **12:00** - 调查观众行业背景：保险、金融、医疗、酒店等
- **12:45** - 传统理赔处理流程：摄取阶段（SFTP上传）、提取阶段（基础OCR）、分析阶段（人工处理）
- **14:00** - 传统方法的挑战：易出错、耗时、无法扩展
- **14:30** - 展示现代化架构：安全文件传输、恶意软件扫描、AI代理处理
- **15:20** - 强调使用EventBridge进行事件编排

### 第一阶段：构建安全基础 (16:00 - 23:00)
- **16:00** - 介绍第一阶段目标：部署Transfer Family服务器和自定义身份提供商
- **16:45** - 使用Transfer Family替代传统SFTP服务器的优势：无基础设施管理、自动扩展、高可用性
- **17:30** - 自定义身份提供商工具包：与合作伙伴的IdP集成（Okta、Ping、Entra等）
- **18:15** - 使用S3存储，提供无限扩展性和高持久性
- **19:00** - Matt开始代码演示，展示Terraform项目结构
- **19:45** - 启动第一阶段部署脚本
- **20:30** - 讲解自定义IDP Terraform模块配置：VPC附加、API Gateway选项等

### Transfer Family服务器配置 (23:00 - 28:30)
- **23:00** - 展示Transfer Family服务器Terraform模块配置
- **23:30** - 配置参数：域（S3）、端点类型（公共）、协议（SFTP）
- **24:15** - 配置身份提供商为AWS Lambda，连接自定义IDP Lambda函数
- **25:00** - Pierre提问：如何管理用户和映射身份提供商
- **25:30** - Matt解释：通过DynamoDB表配置，包括身份提供商表和用户表
- **26:30** - 展示DynamoDB配置：Cognito用户池配置、用户映射、逻辑目录配置
- **27:45** - 部署完成，测试SFTP连接

### 第一阶段测试 (28:30 - 30:00)
- **28:30** - 运行测试脚本，从Secrets Manager获取凭证
- **29:00** - 使用anycompany-repairs用户登录SFTP
- **29:30** - 成功上传测试文件claim1.zip
- **29:45** - 验证文件已上传到S3存储桶

### 第二阶段：恶意软件扫描 (30:00 - 37:00)
- **30:00** - Pierre介绍第二阶段：添加自动恶意软件保护
- **30:30** - 调查观众：谁在使用GuardDuty恶意软件扫描
- **31:00** - GuardDuty工作原理：扫描受保护S3存储桶中的对象，添加标签（clean/threats found）
- **32:00** - 架构扩展：EventBridge监听GuardDuty事件，通过SQS解耦，Lambda处理路由
- **33:15** - 智能路由：干净文件到clean bucket，恶意文件到quarantine bucket，错误到error bucket
- **34:00** - 可选功能：死信队列（DLQ）和SNS通知
- **34:45** - 启动第二阶段部署

### 恶意软件保护模块配置 (37:00 - 41:00)
- **37:00** - 展示恶意软件保护Terraform模块代码
- **37:30** - 配置源存储桶（需要保护的存储桶）
- **38:00** - 可选功能配置：SNS主题、死信队列
- **38:45** - 路由配置：将GuardDuty事件映射到目标存储桶
- **39:30** - Matt确认：该模块不仅限于Transfer Family，可用于任何需要S3恶意软件扫描的场景
- **40:15** - Pierre确认：模块化设计，可独立使用或组合使用

### 第二阶段测试 (41:00 - 44:00)
- **41:00** - 运行第二阶段测试脚本
- **41:30** - 上传干净文件和EICAR测试文件（恶意软件测试标准文件）
- **42:15** - 解释EICAR文件：安全测试恶意软件保护的方法，不会实际感染系统
- **42:45** - 查看CloudWatch日志，确认GuardDuty正确标记文件
- **43:15** - 验证干净文件在clean bucket，EICAR文件在quarantine bucket
- **43:45** - 强调事件驱动架构的自动化特性

### Agentic AI介绍 (44:00 - 50:00)
- **44:00** - 调查观众：谁在使用或探索AI代理
- **44:30** - 对比传统文件处理管道：多个Lambda/Step Functions调用不同AI服务
- **45:15** - 传统架构仍然相关，但缺乏灵活性
- **45:45** - AI代理提供更大灵活性，适合需要动态处理的场景
- **46:30** - 使用Amazon Bedrock Agent Core编排代理工作流
- **47:00** - 介绍四个子代理：实体检测、验证（多模态）、摘要、数据库插入
- **48:00** - 监督代理（Supervisor Agent）：协调所有子代理任务
- **48:45** - 强调该模式适用于多个行业：医疗、金融等，只需调整提示词

### AI代理提示词示例 (50:00 - 52:30)
- **50:00** - 展示各代理的提示词配置
- **50:30** - 实体检测代理：从车辆损坏理赔中提取信息，输出JSON格式
- **51:00** - 验证代理：分析车辆损坏图像与报告的理赔详情
- **51:30** - 摘要代理：将所有发现总结为特定格式
- **52:00** - 数据库代理：提取实体并推送到DynamoDB表

### 第三阶段：AI代理代码实现 (52:30 - 58:00)
- **52:30** - 切换到代码演示，启动第三阶段部署
- **53:00** - 展示Agent Core Terraform模块
- **53:30** - 调查观众：谁在使用Strands SDK
- **54:00** - 介绍Strands框架：AWS开源框架，用于构建代理
- **54:45** - Strands三大核心概念：模型（Model）、工具（Tool）、任务（Task）
- **55:30** - 工具定义：代理可执行的操作，可以是函数或子代理
- **56:15** - 展示实体提取工具代码：获取代理ARN、准备payload、创建会话ID、调用Bedrock代理、解析输出
- **57:30** - 展示监督代理配置：使用自然语言定义任务，代理自动决定使用哪些工具

### Terraform模块与最佳实践 (58:00 - 1:02:00)
- **58:00** - 强调使用官方Terraform模块的优势
- **58:30** - 调查观众：谁在使用Transfer Family Terraform模块
- **59:00** - 调查观众：谁在使用Terraform进行自动化
- **59:30** - 使用模块的好处：标准化部署、跨环境一致性
- **1:00:00** - 建议使用Git跟踪变更、回滚和审计
- **1:00:30** - 推荐使用CI/CD管道部署所有基础设施
- **1:01:00** - 展示GitHub仓库QR码，观众可获取完整代码

### 第四阶段与总结 (1:02:00 - 结束)
- **1:02:00** - 提到第四阶段：Transfer Family Web应用（为人类用户提供浏览器访问）
- **1:02:30** - Web应用特性：简单的浏览器访问、自助服务、基于规则的访问控制、零信任原则
- **1:03:00** - 再次展示GitHub仓库QR码
- **1:03:30** - 强调所有模块都是独立的构建块，可以单独或组合使用
- **1:04:00** - 总结：展示了如何使用云原生服务和基础设施即代码构建现代化MFT系统

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


关键技术栈：
- AWS Transfer Family（SFTP服务器）
- Amazon GuardDuty（恶意软件扫描）
- Amazon Bedrock（AI代理）
- Amazon EventBridge（事件驱动编排）
- Terraform（基础设施即代码）
- Strands SDK（代理框架）
- Amazon S3、Lambda、SQS、SNS、DynamoDB、Cognito