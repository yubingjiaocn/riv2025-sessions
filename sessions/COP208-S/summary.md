# AWS re:Invent 2025 Karpenter 成本优化会议总结

## 会议概述

本次会议由 Zesty 公司联合创始人兼 CTO Alexey 主讲，重点介绍了如何使用 Karpenter 实现 Kubernetes 集群的成本效率和规模化适应性。会议时长约 15 分钟，面向已在生产环境中使用 Karpenter 的开发运维工程师和平台工程师。

演讲者强调了在稳定性、性能和成本之间找到平衡点的重要性，避免过度配置或配置不足的问题。会议涵盖了 Karpenter 的核心功能、最佳实践以及实际的成本优化策略，特别关注了 Spot 实例管理和节点整合策略。

## 详细时间线与关键要点

### 0:00-2:00 开场与问题背景
- 演讲者介绍和现场调研：了解听众对 Karpenter 和 Spot 实例的使用情况
- 核心挑战：在稳定性、性能和成本之间找到平衡点
- DevOps 工程师的目标：为复杂生产工作负载提供恰当的基础设施配置

### 2:00-4:00 Karpenter 整合策略
- **整合策略 (Consolidation Policies)**：监控节点利用率，安全终止未充分利用的节点
- **关键配置要素**：
  - PDB (Pod Disruption Budgets)：控制同时整合的副本数量
  - 整合延迟：配置 Karpenter 等待时间，避免短期使用量下降时的误操作
- 避免在高峰流量时段进行整合的配置示例

### 4:00-6:00 实例选择策略
- **多样化原则**：为 Karpenter 提供更广泛的实例类型选择
- **避免极端配置**：
  - 不使用过小实例：避免网络开销和调度复杂性
  - 不使用过大实例：避免资源浪费，影响整合效率
- **DaemonSets 考量**：大节点减少系统服务开销，小节点增加资源消耗

### 6:00-9:00 Spot 实例管理
- Karpenter 自动识别最佳价格和可用性的 Spot 实例
- **适用场景**：负载均衡器后的 Web 服务器、无状态微服务、批处理作业、开发/测试环境
- **最佳实践**：
  - 配置 Spot 实例与按需实例的故障转移
  - 创建独立的 Spot 和按需节点池
  - 使用节点亲和性控制工作负载分布
- 监控故障转移频率，适时扩大实例选择范围

### 9:00-11:00 Graviton 实例和网络优化
- **Graviton 优势**：相同或更好性能，更低价格
- **实施要求**：CI 过程中构建 ARM 和 x86 版本的容器镜像
- **跨可用区流量优化**：
  - 仅适用于非生产环境
  - 限制节点池到特定可用区以减少网络成本
  - 配置故障转移机制

### 11:00-14:00 挑战与解决方案
- **持续存在的挑战**：
  - Kubernetes 指标与成本关联的复杂性
  - 基础设施响应时间（几分钟）与 Karpenter 决策速度的差异
  - 大规模环境的运维复杂性
- **Zesty 平台介绍**：
  - 深度可视化集群和容器使用情况
  - 预测模型驱动的扩展决策
  - 自动化资源和财务优化
  - 快速扩展技术：30 秒内从休眠节点恢复
  - 承诺至少 70% 的成本节省