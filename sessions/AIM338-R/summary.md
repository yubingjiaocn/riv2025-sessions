# AWS re:Invent 2025 - 使用AI代理桥接结构化和非结构化数据

## 会议概述

本次技术会议由AWS高级解决方案架构师Aneel Murari和Rafia Tapia主讲，重点介绍如何使用AI代理技术将企业中的结构化数据（关系数据库）和非结构化数据（文档、文件等）进行整合。两位讲师来自AWS非营利组织客户团队，分别拥有5年和6年以上的AWS工作经验。

会议采用现场编程演示的方式，构建了一个慈善聊天助手应用，该应用能够智能地从Aurora PostgreSQL数据库（存储捐赠者、活动、会员等结构化数据）和Bedrock知识库（存储非结构化文档）中检索信息。整个演示使用Python和Streamlit构建UI，核心使用Strand SDK创建AI代理，展示了如何让单个代理智能选择合适的数据源来回答用户问题。

## 详细时间线与关键要点

### 0:00-5:00 开场介绍和架构概览
- 讲师自我介绍，确认现场观众对AI代理的使用情况
- 介绍企业数据现状：大量结构化数据存储在关系数据库中，同时存在越来越多的非结构化数据
- 展示应用架构图：UI层（Streamlit）→ AI代理 → 两个数据源（Bedrock知识库用于非结构化数据，Aurora数据库用于结构化数据）

### 5:00-10:00 技术栈和工具介绍
- 介绍Strand SDK：支持单代理和多代理构建，支持MCP和工具协议
- 解释RAG（检索增强生成）应用原理：将非结构化数据转换为向量存储
- 介绍Bedrock知识库：简化RAG基础设施构建，支持多种文档格式
- 演示最终应用效果：慈善聊天助手能够回答关于会员、捐赠、活动等问题

### 10:00-20:00 开发环境设置和基础UI构建
- 使用Kiro IDE进行开发演示
- 创建Python虚拟环境，安装必要依赖（strand-agent, strand-agent-tools等）
- 构建基础Streamlit应用框架（app.py）
- 创建基础代理结构（agent.py），使用Claude模型作为主LLM
- 演示空白代理的行为：回答"不知道"而不是编造答案

### 20:00-30:00 集成非结构化数据检索
- 添加Strand SDK内置的retrieve工具，用于查询Bedrock知识库
- 配置环境变量：知识库ID和AWS区域
- 观众提问环节：讨论向量数据库选择、嵌入模型、分块策略等技术细节
- 测试应用：代理现在能够从知识库检索信息，但准确性有限

### 30:00-45:00 构建自定义SQL查询工具
- 创建自定义工具query_SQL_db.py，用于访问Aurora数据库
- 介绍工具创建方法：使用@tool装饰器将Python函数转换为Strand工具
- 构建支持类StructuredDataAgent：
  - 数据库连接配置（ARN、Secrets Manager、数据库名称）
  - 使用Nova模型进行SQL生成（展示多模型使用策略）
  - 实现数据库模式检索功能

### 45:00-55:00 智能SQL生成和执行
- 实现get_table_schema函数：查询PostgreSQL系统表获取数据库结构
- 构建系统提示生成逻辑：将数据库模式嵌入到LLM提示中
- 实现generate_SQL函数：结合用户问题和数据库模式生成有效SQL查询
- 添加SQL提取和执行功能
- 观众讨论：数据字典、外键关系、列名语义理解等高级话题

### 55:00-58:30 最终演示和总结
- 完整应用测试：代理能够智能选择使用数据库查询或知识库检索
- 展示工具使用追踪功能：可以看到代理选择了哪个工具
- 讨论生产部署选项：Lambda、ECS、EKS、Agent Code等
- 强调系统提示的重要性：在复杂场景中指导代理行为
- 提供学习资源和后续交流安排