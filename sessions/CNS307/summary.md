# AWS re:Invent 2025 技术分享会总结

## 会议概述

本次分享会由 AWS 首席开发者倡导者 Eric Johnson 和容器专家 Matt Meckis 共同主讲,主题为"使用 Amazon ECS 和 AWS Fargate 构建事件驱动架构"。

演讲者通过一个名为 Sarah 的虚拟角色引入话题——她管理着一个中型开发团队,在黑色星期五促销期间遭遇了系统崩溃。问题的根源在于团队采用了同步微服务架构,导致服务之间紧密耦合。当忠诚度服务出现故障时,整个订单处理流程都受到影响。这个场景引出了核心议题:如何从同步微服务架构迁移到事件驱动架构(EDA),以及如何在 Amazon ECS 上实现这一转变。

演讲者强调,这不是 ECS 的问题,而是架构设计的问题。同步微服务虽然具有低延迟、简单和快速失败等优点,但也存在节流、弹性问题等明显缺陷。解决方案是引入事件代理(broker),将生产者和消费者解耦,实现"某事发生,我们做出反应"的事件驱动模式。这种架构能够提供更好的可扩展性、弹性和敏捷性。

## 详细时间线与关键要点

### 开场与问题引入 (0:00 - 5:30)
- **0:00** - Eric Johnson 和 Matt Meckis 介绍自己,Eric 是 AWS 首席开发者倡导者,Matt 是容器专家
- **1:45** - Eric 介绍"三条规则":手势代表任意数字、引号不是撇号、竖起大拇指而非其他手势
- **3:20** - 调查听众:大部分人在使用 ECS,但很少人在 ECS 上实施事件驱动架构
- **4:15** - 介绍虚拟角色 Sarah,她管理一个使用 ECS 的中型开发团队

### 问题场景:黑色星期五灾难 (5:30 - 8:00)
- **5:30** - 场景设定:黑色星期五晚上,系统在新产品发布后崩溃
- **6:20** - 问题诊断:这不是 ECS 的问题,而是架构问题
- **7:00** - 根本原因:Sarah 使用了同步微服务架构,服务之间紧密耦合
- **7:40** - 当忠诚度服务失败时,整个订单流程都会失败

### 同步架构的问题 (8:00 - 10:30)
- **8:15** - 同步请求-响应模型的优点:低延迟、简单、快速失败
- **9:00** - 同步架构的缺点:节流问题、弹性问题、在高负载时容易崩溃
- **9:45** - 解决方案预览:引入代理(broker)来解耦生产者和消费者

### 事件驱动架构(EDA)基础 (10:30 - 15:00)
- **10:45** - 展示 Claude AI 生成的复杂 EDA 定义(故意复杂化以制造幽默效果)
- **11:30** - Eric 的简化定义:"某事发生,我们做出反应"
- **12:15** - EDA 的核心概念:通过代理解耦生产者和消费者
- **13:00** - 对比图示:同步架构 vs 事件驱动架构
- **14:00** - EDA 的三大优势:可扩展性、弹性、敏捷性

### 计算选项:为什么选择 ECS (15:00 - 22:00)
- **15:20** - Matt 介绍转型的三个关键问题:业务逻辑、计算资源、事件路由器
- **16:00** - 常见误区:在架构问题后盲目切换到 Lambda 或 Kubernetes
- **16:45** - 建议:进行增量式改变,不要同时改变所有内容
- **17:30** - 为什么选择 ECS:已有的专业知识,可以专注于架构改进
- **18:15** - ECS 统计数据:每周启动 30 亿个 ECS 任务
- **19:00** - ECS 数据平面选项:Fargate(无服务器)vs EC2 实例
- **20:00** - 新功能介绍:ECS 托管实例(Managed Instances)
- **21:00** - ECS 托管实例的优势:AWS 管理补丁和实例,更快的扩展能力

### ECS 运行模式 (22:00 - 25:00)
- **22:15** - 独立任务模式:为每个事件启动新容器,适合低频事件
- **23:00** - 独立任务的缺点:不适合高吞吐量场景(如黑色星期五)
- **23:45** - 服务模式:长期运行的容器,可以定义 CPU、内存和副本数量
- **24:30** - 服务模式的优势:可扩展性、目标跟踪、与 AWS 服务的原生集成

### 事件代理类型 (25:00 - 35:00)
- **25:30** - 三类事件代理:路由器(Routers)、主题(Topics)、事件存储(Event Stores)
- **26:00** - 路由器(Routers):一对多模式,智能路由,处理重试和错误
- **27:00** - Amazon EventBridge:AWS 的路由器服务,无服务器,原生集成
- **28:15** - EventBridge 架构:事件源 → 事件总线 → 规则 → 目标
- **29:00** - 事件定义:表示过去发生的状态变化,不可更改
- **29:45** - EventBridge 规则:使用 JSON 匹配事件并路由到消费者
- **30:30** - EventBridge 目标:Lambda、ECS、API 目标等

- **31:15** - 主题(Topics):广播到多个消费者,支持多种协议
- **32:00** - Amazon SNS:每秒几乎无限的消息,每个主题支持 1250 万订阅
- **32:45** - SNS 的 FIFO 主题:保持消息顺序

- **33:15** - 事件存储(Event Stores):批量处理,消费者控制处理方式
- **33:45** - Amazon SQS:几乎无限扩展,支持标准队列和 FIFO 队列
- **34:15** - Amazon MQ:支持 RabbitMQ 和 ActiveMQ 的开源集成

### 流式处理 (35:00 - 37:00)
- **35:15** - 流(Streams):一对多,所有消费者接收所有消息
- **35:45** - 消费者负责过滤和错误处理
- **36:15** - Amazon Kinesis:每秒千兆字节级别的流处理
- **36:45** - Amazon MSK:托管的 Apache Kafka 服务

### 架构模式实践 (37:00 - 结束)
- **37:30** - Matt 总结:现在有了完整的工具箱(计算、路由器、各种服务)
- **38:00** - 挑战:如何将这些构建块组合成有用的架构模式
- **38:30** - Eric 接手:开始讲解具体的架构模式

### 长期运行容器模式 (38:30 - 42:00)
- **38:45** - 长期运行容器:推送或拉取模式,端到端处理
- **39:15** - 传统 ECS 架构:多个任务和容器,使用容量提供者
- **40:00** - 模式 1:公共 API 模式
- **40:30** - 场景:生产者通过 API 推送数据到消费者
- **41:00** - 解决方案:在中间插入 EventBridge
- **41:30** - 工作流程:生产者 → EventBridge → API 目标 → ECS 容器
- **42:00** - EventBridge 使用 IAM 角色进行安全连接,控制发送速率

### 会话未完待续
- **42:30** - Eric 提出新问题:如果不是机器对机器,而是客户端呢?
- 会话在此处被截断,后续内容未包含在字幕中

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


注意: 本总结基于提供的字幕文本,会话在讨论客户端场景时被截断,完整的架构模式讲解可能在后续内容中。