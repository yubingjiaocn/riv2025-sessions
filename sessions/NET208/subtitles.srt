1
00:00:01,320 --> 00:00:03,393
- Welcome to re:Invent 2025.

2
00:00:04,560 --> 00:00:07,140
Thank you for joining us for our session,

3
00:00:07,140 --> 00:00:09,240
and this is the first
session that you have.

4
00:00:09,240 --> 00:00:13,140
So thank you for coming in
and appreciate you giving us,

5
00:00:13,140 --> 00:00:14,440
starting your day with us.

6
00:00:15,300 --> 00:00:19,530
This is NET208 AWS
Networking Fundamentals,

7
00:00:19,530 --> 00:00:21,090
Connect, Secure, and Scale.

8
00:00:21,090 --> 00:00:22,620
My name is Rohit Aswani,

9
00:00:22,620 --> 00:00:25,500
I'm a principal networking
solutions architect

10
00:00:25,500 --> 00:00:27,780
within Worldwide Public Sector at AWS,

11
00:00:27,780 --> 00:00:30,180
and I'm excited to be
joined by my colleague.

12
00:00:30,180 --> 00:00:31,800
- Hey folks, my name's Dave DeRicco.

13
00:00:31,800 --> 00:00:34,050
I'm a networking specialist
technical account manager,

14
00:00:34,050 --> 00:00:34,883
which is a mouthful,

15
00:00:34,883 --> 00:00:38,490
but I'm part of our enterprise
support team here at AWS.

16
00:00:38,490 --> 00:00:39,323
- Thanks, Dave.

17
00:00:40,590 --> 00:00:42,690
So the agenda for today's session is

18
00:00:42,690 --> 00:00:45,540
we will start with global infrastructure,

19
00:00:45,540 --> 00:00:47,370
then we'll dive into the fundamentals

20
00:00:47,370 --> 00:00:50,190
of Amazon Virtual Private Cloud.

21
00:00:50,190 --> 00:00:52,170
Once we understand those fundamentals,

22
00:00:52,170 --> 00:00:55,350
we will go into the different
connectivity options.

23
00:00:55,350 --> 00:00:58,830
We'll cover internet
connectivity, hybrid connectivity,

24
00:00:58,830 --> 00:01:02,550
application networking, your
remote access connectivity.

25
00:01:02,550 --> 00:01:05,370
Then we'll dive into the DNS piece of it,

26
00:01:05,370 --> 00:01:07,590
followed by how you can
do traffic inspection

27
00:01:07,590 --> 00:01:10,530
with various types of firewalls on AWS,

28
00:01:10,530 --> 00:01:14,040
followed by how you can
monitor your network

29
00:01:14,040 --> 00:01:15,490
along with the observability.

30
00:01:18,180 --> 00:01:22,230
Before we begin, this
is a 200-level session

31
00:01:22,230 --> 00:01:24,300
designed to give you basic building blocks

32
00:01:24,300 --> 00:01:27,120
of the networking on AWS Cloud,

33
00:01:27,120 --> 00:01:30,180
and we expect that you
have some familiarity

34
00:01:30,180 --> 00:01:35,160
with fundamental constructs
such as CIDR notation, DNS,

35
00:01:35,160 --> 00:01:37,503
IP routing, and so on so forth.

36
00:01:39,030 --> 00:01:41,040
You can take some pictures along the way,

37
00:01:41,040 --> 00:01:44,850
but we will be posting these
slides on the AWS event page,

38
00:01:44,850 --> 00:01:48,543
so you'll have access to
that slides later on as well.

39
00:01:49,890 --> 00:01:52,530
With that, let's start with a view

40
00:01:52,530 --> 00:01:55,156
of the AWS Global Infrastructure.

41
00:01:55,156 --> 00:02:00,123
AWS Global Infrastructure
includes 38 regions.

42
00:02:01,080 --> 00:02:04,020
We have 43 local zones,

43
00:02:04,020 --> 00:02:09,020
and we have over 146 Direct
Connect points of presence.

44
00:02:09,030 --> 00:02:11,910
And all of this in Global Infrastructure

45
00:02:11,910 --> 00:02:15,270
is connected with the AWS
backbone that we have built.

46
00:02:15,270 --> 00:02:19,140
It is the most secure,
reliable backbone network

47
00:02:19,140 --> 00:02:20,100
that we have built.

48
00:02:20,100 --> 00:02:21,930
And you can scan this QR code

49
00:02:21,930 --> 00:02:25,920
that will take you to the
page on the AWS Global Network

50
00:02:25,920 --> 00:02:28,020
that you can take a look at it afterwards.

51
00:02:30,060 --> 00:02:34,350
Now let's zoom in a bit more
into the construct of region.

52
00:02:34,350 --> 00:02:37,110
So AWS has the construct of region,

53
00:02:37,110 --> 00:02:40,290
which is a physical
location around the world

54
00:02:40,290 --> 00:02:42,510
where we cluster these data centers.

55
00:02:42,510 --> 00:02:44,850
And all of these data
centers are interconnected

56
00:02:44,850 --> 00:02:48,310
with each other with
high-speed, high-bandwidth,

57
00:02:48,310 --> 00:02:51,333
and throughput and low-latency links.

58
00:02:52,260 --> 00:02:55,383
We encrypt traffic when it
leaves our secured facilities.

59
00:02:56,370 --> 00:02:59,160
And a cluster of these data
centers is what we call it

60
00:02:59,160 --> 00:03:01,110
as like an Availability Zone.

61
00:03:01,110 --> 00:03:03,600
So here, you can see there
are three Availability Zones

62
00:03:03,600 --> 00:03:04,950
that I'm showing.

63
00:03:04,950 --> 00:03:06,750
And all of these Availability Zones

64
00:03:06,750 --> 00:03:11,750
are also connected with
high-bandwidth, low-latency links,

65
00:03:11,790 --> 00:03:13,380
and we also encrypt traffic

66
00:03:13,380 --> 00:03:15,753
when it leaves these Availability Zones.

67
00:03:17,280 --> 00:03:20,520
Now having talked about
region and Availability Zones,

68
00:03:20,520 --> 00:03:21,930
you then create what we call it

69
00:03:21,930 --> 00:03:24,420
as like Amazon Virtual Private Cloud,

70
00:03:24,420 --> 00:03:27,630
which is a logically
isolated part of your network

71
00:03:27,630 --> 00:03:30,453
that you get to define
similar to your data center.

72
00:03:31,680 --> 00:03:34,770
Now within this region, you
have Availability Zones,

73
00:03:34,770 --> 00:03:37,860
and Availability Zones have data centers,

74
00:03:37,860 --> 00:03:40,680
and within these data center,
we have different racks,

75
00:03:40,680 --> 00:03:44,013
and your EC2 instances lives
on one of these racks here.

76
00:03:45,330 --> 00:03:48,030
Now with this understanding
of global infrastructure,

77
00:03:48,030 --> 00:03:50,516
let's start to understand the IPv4

78
00:03:50,516 --> 00:03:53,553
and IPv6 addressing options
that we have on AWS.

79
00:03:55,590 --> 00:04:00,060
But before we do that, let's
define how AWS thinks about

80
00:04:00,060 --> 00:04:03,900
public and private IP addressing on AWS.

81
00:04:03,900 --> 00:04:06,900
The way we define this is
in terms of advertisement,

82
00:04:06,900 --> 00:04:09,480
so AWS considers public IP addresses

83
00:04:09,480 --> 00:04:12,420
as those advertised on the internet.

84
00:04:12,420 --> 00:04:15,900
Whereas private IP addresses
are the ones that are not

85
00:04:15,900 --> 00:04:19,770
and cannot be advertised
on the internet from AWS.

86
00:04:19,770 --> 00:04:21,510
Now with this definition,

87
00:04:21,510 --> 00:04:24,540
there are different options
that you can think about it.

88
00:04:24,540 --> 00:04:28,080
On the left-hand side,
we have IPv4 and IPv6.

89
00:04:28,080 --> 00:04:32,070
And at the top, you have public
and private IP addresses.

90
00:04:32,070 --> 00:04:34,380
So let's start with public IPv4.

91
00:04:34,380 --> 00:04:36,570
So you can get a public IPv4 address space

92
00:04:36,570 --> 00:04:39,033
directly from Amazon, or
you can bring your own,

93
00:04:41,280 --> 00:04:43,410
and you can follow the
Bring Your Own IP process

94
00:04:43,410 --> 00:04:45,930
to advertise that from the AWS.

95
00:04:45,930 --> 00:04:50,010
You can also get a contiguous
IP block as well from AWS.

96
00:04:50,010 --> 00:04:51,510
That's also possible.

97
00:04:51,510 --> 00:04:53,190
In case of private IPv4,

98
00:04:53,190 --> 00:04:55,680
this is something that you
must be already familiar with.

99
00:04:55,680 --> 00:04:57,270
This is RFC 1918 range,

100
00:04:57,270 --> 00:05:02,270
which is 10/16, 172.31/16
so on and so forth.

101
00:05:03,150 --> 00:05:05,070
We also have the carrier-grade NAT

102
00:05:05,070 --> 00:05:08,160
that you can use for your
private IPv4 addresses.

103
00:05:08,160 --> 00:05:13,160
And you can also choose to use
a public IPv4 address space

104
00:05:14,550 --> 00:05:16,410
and you can assign it to the VPC,

105
00:05:16,410 --> 00:05:19,323
however, we will treat that
as private in this case.

106
00:05:20,580 --> 00:05:24,720
In case of public IPv6, these
are Global Unicast addresses

107
00:05:24,720 --> 00:05:28,350
that you can use, and you can
get this either from Amazon

108
00:05:28,350 --> 00:05:29,913
or you can bring your own.

109
00:05:31,020 --> 00:05:33,690
And in case of private IPv6,

110
00:05:33,690 --> 00:05:36,450
these are similar to your RFC 1918 range,

111
00:05:36,450 --> 00:05:38,760
because these are not
advertised on the internet,

112
00:05:38,760 --> 00:05:42,360
and you have the option of
using Unique Local Addresses.

113
00:05:42,360 --> 00:05:46,740
You can also use a
public IPS space as well

114
00:05:46,740 --> 00:05:48,420
for your VPC CIDR.

115
00:05:48,420 --> 00:05:51,630
And you can also use
private IPv6 GUA space

116
00:05:51,630 --> 00:05:53,253
for your VPC CIDR as well.

117
00:05:55,680 --> 00:05:58,410
So far, we have talked
about IPv4 and IPv6,

118
00:05:58,410 --> 00:06:01,770
and we will be showing IPv6
throughout the session.

119
00:06:01,770 --> 00:06:04,470
So what I'm gonna do
is we are gonna define

120
00:06:04,470 --> 00:06:06,960
how IPv6 on AWS is supported.

121
00:06:06,960 --> 00:06:08,760
You have IPv6 configuration

122
00:06:08,760 --> 00:06:10,710
that you can define in
two different modes,

123
00:06:10,710 --> 00:06:14,280
you can have a dual-stack,
as well as IPv6-only.

124
00:06:14,280 --> 00:06:17,250
Then we have AWS public service endpoints

125
00:06:17,250 --> 00:06:20,250
that you use to access AWS services.

126
00:06:20,250 --> 00:06:24,150
And the last one is the
private service endpoints

127
00:06:24,150 --> 00:06:25,680
powered by AWS PrivateLink,

128
00:06:25,680 --> 00:06:29,610
which we are gonna see in
the following slides as well.

129
00:06:29,610 --> 00:06:33,600
So as of today, we support
150 plus AWS services

130
00:06:33,600 --> 00:06:35,190
that support IPv6.

131
00:06:35,190 --> 00:06:36,210
Now you may be asking,

132
00:06:36,210 --> 00:06:38,700
where do I go find all these 150 services?

133
00:06:38,700 --> 00:06:42,210
So here's a QR code that
takes you to a central page

134
00:06:42,210 --> 00:06:47,163
where we list all the AWS
services that support IPv6.

135
00:06:49,620 --> 00:06:54,307
Okay, now let's dive into the
fundamentals of Amazon VPC.

136
00:06:55,500 --> 00:06:58,620
So now you want to build your first VPC.

137
00:06:58,620 --> 00:07:02,100
We talked about region, and
region has Availability Zones.

138
00:07:02,100 --> 00:07:04,170
Here, I'm showing two Availability Zones.

139
00:07:04,170 --> 00:07:07,140
Your VPC is a regional construct,

140
00:07:07,140 --> 00:07:10,020
and you define a CIDR range for a VPC.

141
00:07:10,020 --> 00:07:12,117
Here, I'm choosing a 10/16,

142
00:07:12,117 --> 00:07:15,030
and an IPv6 CIDR range for your VPC.

143
00:07:15,030 --> 00:07:17,400
And when you do that, this makes your VPC

144
00:07:17,400 --> 00:07:19,410
as your dual-stack VPC.

145
00:07:19,410 --> 00:07:21,480
But now you might be thinking,

146
00:07:21,480 --> 00:07:23,490
this is single VPC, single region,

147
00:07:23,490 --> 00:07:26,220
what if I'm operating in multiple accounts

148
00:07:26,220 --> 00:07:27,540
and multiple regions?

149
00:07:27,540 --> 00:07:29,940
How do I do this at scale?

150
00:07:29,940 --> 00:07:33,450
To do that, you can use
Amazon VPC IP Address Manager

151
00:07:33,450 --> 00:07:36,180
that allows you to automate
IP address assignments,

152
00:07:36,180 --> 00:07:39,780
you can plan and track
your IP addresses on AWS.

153
00:07:39,780 --> 00:07:42,363
We'll start with an
example of private IPv4.

154
00:07:43,380 --> 00:07:46,530
So we talked about the IP
addressing options on AWS,

155
00:07:46,530 --> 00:07:49,500
which is public and
private for both v4 and v6.

156
00:07:49,500 --> 00:07:51,990
So we'll take an example of private IPv4.

157
00:07:51,990 --> 00:07:56,310
So when you integrate with
Amazon VPC IP Address Manager,

158
00:07:56,310 --> 00:08:01,290
also known as VPC IPAM,
we define two scopes,

159
00:08:01,290 --> 00:08:03,000
a private and a public scope.

160
00:08:03,000 --> 00:08:05,310
A scope is nothing but like a container.

161
00:08:05,310 --> 00:08:09,930
Within a private scope,
since it's a private IPv4,

162
00:08:09,930 --> 00:08:12,810
you define this into the private scope.

163
00:08:12,810 --> 00:08:14,040
You create a top-level pool.

164
00:08:14,040 --> 00:08:16,530
Here, I'm showing a /12 as an example.

165
00:08:16,530 --> 00:08:19,590
And then, I'm operating in
three regions for example.

166
00:08:19,590 --> 00:08:21,750
And each region has a /14.

167
00:08:21,750 --> 00:08:25,380
Now the way I'm dividing
this IP address base

168
00:08:25,380 --> 00:08:28,500
is based on my organizational rules.

169
00:08:28,500 --> 00:08:31,200
So for example, you have a
dev pool and a prod pool,

170
00:08:31,200 --> 00:08:32,280
you can have many other pools

171
00:08:32,280 --> 00:08:34,440
like the staging and test as well.

172
00:08:34,440 --> 00:08:36,420
And here, I'm showing like a /16.

173
00:08:36,420 --> 00:08:37,320
And if you're operating

174
00:08:37,320 --> 00:08:39,630
across multiple accounts
and multiple regions,

175
00:08:39,630 --> 00:08:42,150
you can integrate with AWS organizations,

176
00:08:42,150 --> 00:08:44,640
and you can share these environment pools

177
00:08:44,640 --> 00:08:47,130
such as dev and prod
with different accounts.

178
00:08:47,130 --> 00:08:48,870
And then each application owner

179
00:08:48,870 --> 00:08:52,860
can go ahead and request
a /24 as an example

180
00:08:52,860 --> 00:08:54,090
to get that IP address base.

181
00:08:54,090 --> 00:08:57,063
And you can do this across
all different regions as well.

182
00:08:58,290 --> 00:09:00,120
Now what about IPv6?

183
00:09:00,120 --> 00:09:02,250
So here's another example.

184
00:09:02,250 --> 00:09:05,820
I'm showing an example of
Bring Your Own IPv6 with GUA,

185
00:09:05,820 --> 00:09:07,080
which is an advertised space.

186
00:09:07,080 --> 00:09:09,720
So as I mentioned, you
have different scopes,

187
00:09:09,720 --> 00:09:11,130
you put that in the public scope

188
00:09:11,130 --> 00:09:13,733
and you can have the rest of
the hierarchy as the same.

189
00:09:15,120 --> 00:09:18,150
Now let's bring our dual-stack VPC

190
00:09:18,150 --> 00:09:21,540
that we just built before, and
now apply these constructs.

191
00:09:21,540 --> 00:09:24,270
So you get this IP address
range now from IPAM

192
00:09:24,270 --> 00:09:25,803
and assign it to your VPC.

193
00:09:27,150 --> 00:09:30,000
Within a VPC, then you
create different subnets.

194
00:09:30,000 --> 00:09:33,240
Since we have IPv4 and IPv6 supported,

195
00:09:33,240 --> 00:09:35,370
you can have an IPv4-only subnet,

196
00:09:35,370 --> 00:09:37,710
you can have dual-stack subnet,

197
00:09:37,710 --> 00:09:41,880
and you can also have an
IPv6-only subnet as well.

198
00:09:41,880 --> 00:09:45,660
Now for IPv4, we support
creating a subnet size

199
00:09:45,660 --> 00:09:48,090
of /28 to /16.

200
00:09:48,090 --> 00:09:53,090
And in case of IPv6, we support
anything from /44 to /64

201
00:09:53,490 --> 00:09:55,713
in increments of /4 basically.

202
00:09:56,730 --> 00:09:58,590
Now once you define these subnets,

203
00:09:58,590 --> 00:10:01,230
subnets are tied to a
specific Availability Zone,

204
00:10:01,230 --> 00:10:03,390
as you can see, and you
can have many subnets

205
00:10:03,390 --> 00:10:05,463
that can reside within the VPC.

206
00:10:06,840 --> 00:10:10,410
Now each subnet has a route
table associated with it,

207
00:10:10,410 --> 00:10:12,429
and when you have both IPv4

208
00:10:12,429 --> 00:10:15,780
and IPv6 CIDR assigned to your VPC,

209
00:10:15,780 --> 00:10:19,080
by default, we add a
local route within the VPC

210
00:10:19,080 --> 00:10:23,100
that allows you to connect
with resources within the VPC.

211
00:10:23,100 --> 00:10:25,260
And you can see here a route table.

212
00:10:25,260 --> 00:10:26,820
There are other things that we will see

213
00:10:26,820 --> 00:10:28,920
how you can enable
connectivity to internet,

214
00:10:28,920 --> 00:10:30,990
and hybrid, and so on so forth.

215
00:10:30,990 --> 00:10:32,550
And we will talk about examples

216
00:10:32,550 --> 00:10:34,600
on how those route tables will look like.

217
00:10:36,420 --> 00:10:39,210
Now once you define
that, you can then create

218
00:10:39,210 --> 00:10:42,450
and launch your resources
such as Amazon EC2 instances,

219
00:10:42,450 --> 00:10:45,003
your RDS load balancers,
and so on and so forth.

220
00:10:45,870 --> 00:10:48,570
And when you do that, here,
I'm showing an example

221
00:10:48,570 --> 00:10:50,970
with dual-stack and an IPv6-only subnet.

222
00:10:50,970 --> 00:10:54,510
Each instance gets an
elastic network interface,

223
00:10:54,510 --> 00:10:56,070
and it gets an IP address range

224
00:10:56,070 --> 00:10:58,023
from the subnet that it is created in.

225
00:11:01,800 --> 00:11:03,750
Once we create these instances,

226
00:11:03,750 --> 00:11:06,600
now instances also have
some local services

227
00:11:06,600 --> 00:11:08,310
that are available to them.

228
00:11:08,310 --> 00:11:09,600
And for example,

229
00:11:09,600 --> 00:11:12,840
we have Amazon EC2
Instance Metadata Service.

230
00:11:12,840 --> 00:11:14,610
We also have Amazon Time Sync Service,

231
00:11:14,610 --> 00:11:17,220
and a Route 53 Resolver service.

232
00:11:17,220 --> 00:11:19,050
These are services that are available

233
00:11:19,050 --> 00:11:23,010
to your instances locally,
and you can use, for example,

234
00:11:23,010 --> 00:11:26,220
Amazon EC2 Instance Metadata
Service to get the user data,

235
00:11:26,220 --> 00:11:27,423
and so on so forth.

236
00:11:29,250 --> 00:11:32,970
Keep in mind here, we have
both IPv4 and IPv6 endpoints

237
00:11:32,970 --> 00:11:35,610
that are supported for these services.

238
00:11:35,610 --> 00:11:39,840
And for IPv6, you can do access this

239
00:11:39,840 --> 00:11:41,763
using a Nitro-based instance types.

240
00:11:42,870 --> 00:11:45,840
Now let's look at the Amazon VPC DNS.

241
00:11:45,840 --> 00:11:50,100
So every VPC comes with a
purpose-built DNS resolver,

242
00:11:50,100 --> 00:11:53,130
which we have at the
VPC CIDR plus two range.

243
00:11:53,130 --> 00:11:55,440
And we also have the IPv6 address space

244
00:11:55,440 --> 00:11:56,550
that I just talked about.

245
00:11:56,550 --> 00:11:59,310
And we will see these
examples about VPC DNS

246
00:11:59,310 --> 00:12:02,193
when Dave talks about in the
further part of the session.

247
00:12:03,840 --> 00:12:07,560
Now let's talk about
the fundamental security

248
00:12:07,560 --> 00:12:09,483
that you get on AWS.

249
00:12:10,410 --> 00:12:13,350
We'll start with Network
Access Control List,

250
00:12:13,350 --> 00:12:15,780
we also call it as like NACL.

251
00:12:15,780 --> 00:12:19,110
Network Access Control List
are stateless in nature,

252
00:12:19,110 --> 00:12:22,050
and you define this at the subnet level.

253
00:12:22,050 --> 00:12:23,850
And when you define this
at the subnet level,

254
00:12:23,850 --> 00:12:26,250
you can do both allow or deny rules,

255
00:12:26,250 --> 00:12:28,350
and based on how you define your rules,

256
00:12:28,350 --> 00:12:31,200
your traffic will be allowed or denied.

257
00:12:31,200 --> 00:12:36,200
And the second option here
is to use security groups.

258
00:12:36,810 --> 00:12:39,180
Security groups are stateful in nature,

259
00:12:39,180 --> 00:12:41,010
which is basically like a firewall

260
00:12:41,010 --> 00:12:46,010
that you can apply at the ENI,
Elastic Network Interface,

261
00:12:46,020 --> 00:12:48,420
or at an EC2 instance level.

262
00:12:48,420 --> 00:12:53,280
And you can control access,
it can only have allow rules.

263
00:12:53,280 --> 00:12:56,010
And by default with security groups,

264
00:12:56,010 --> 00:12:57,693
if the traffic is allowed,

265
00:12:58,720 --> 00:13:00,810
if you have an egress
rule that allows traffic

266
00:13:00,810 --> 00:13:03,270
to access a database
for example, by default,

267
00:13:03,270 --> 00:13:05,920
the inbound traffic is
automatically allowed as well.

268
00:13:07,410 --> 00:13:11,250
Now, we are talking
about IPv6-only subnets,

269
00:13:11,250 --> 00:13:12,390
but we are living in a world

270
00:13:12,390 --> 00:13:15,000
where we have both IPv4 and IPv6.

271
00:13:15,000 --> 00:13:18,450
So how do we ensure backwards
compatibility in that case?

272
00:13:18,450 --> 00:13:21,480
So here, I have an IPv6-only subnet,

273
00:13:21,480 --> 00:13:23,460
and I have an instance within that.

274
00:13:23,460 --> 00:13:26,940
If that instance makes a
query to an IPv4-only domain,

275
00:13:26,940 --> 00:13:31,710
it goes to the Amazon VPC DNS
server that every VPC gets,

276
00:13:31,710 --> 00:13:35,070
that performs a recursive
lookup to Route 53,

277
00:13:35,070 --> 00:13:38,580
and it gets a response back
with an IPv4 address base.

278
00:13:38,580 --> 00:13:40,830
Now you have an instance
that is IPv6-only,

279
00:13:40,830 --> 00:13:43,560
but the IP address it's getting is IPv4,

280
00:13:43,560 --> 00:13:46,830
how does the backward
translation happen here?

281
00:13:46,830 --> 00:13:49,410
To do that, we support DNS64,

282
00:13:49,410 --> 00:13:53,910
it is a setting that you can
enable on the IPv6-only subnet.

283
00:13:53,910 --> 00:13:55,956
And what this does is that is,

284
00:13:55,956 --> 00:14:00,570
when it makes a query to
the Route 53 DNS Resolver,

285
00:14:00,570 --> 00:14:03,630
it gets a synthesized IPv6 address space

286
00:14:03,630 --> 00:14:05,370
in the hexadecimal format.

287
00:14:05,370 --> 00:14:08,550
So here, you see a hexadecimal format

288
00:14:08,550 --> 00:14:10,860
of the same IPv4 address space

289
00:14:10,860 --> 00:14:13,020
that I got from that instance.

290
00:14:13,020 --> 00:14:16,740
Now DNS64 is just for
getting that address space

291
00:14:16,740 --> 00:14:18,570
that the instance can then reach out to.

292
00:14:18,570 --> 00:14:20,910
So we will see in the
further slides in terms of

293
00:14:20,910 --> 00:14:22,920
how you can apply this
constructs when you want

294
00:14:22,920 --> 00:14:26,043
to actually enable connectivity
to an IPv4 destination.

295
00:14:27,090 --> 00:14:31,080
And with that, we will
transition into talking about

296
00:14:31,080 --> 00:14:34,650
how you can establish
connectivity to internet

297
00:14:34,650 --> 00:14:35,703
from your VPC.

298
00:14:37,200 --> 00:14:39,608
So we will start with a public subnets.

299
00:14:39,608 --> 00:14:42,690
A public subnet is something
that has a route table

300
00:14:42,690 --> 00:14:44,550
pointing to an internet gateway.

301
00:14:44,550 --> 00:14:46,560
So you create an internet gateway

302
00:14:46,560 --> 00:14:48,600
and associate with your VPC.

303
00:14:48,600 --> 00:14:52,170
You can then, this Internet
Gateway does the translation

304
00:14:52,170 --> 00:14:56,280
of private IPv4 to the public

305
00:14:56,280 --> 00:14:59,730
or the Elastic IP of that instance.

306
00:14:59,730 --> 00:15:03,480
And you add a route
into the VPC route table

307
00:15:03,480 --> 00:15:06,570
pointing to the IPv4 default route.

308
00:15:06,570 --> 00:15:09,630
And once you do that, your IPv4 instances

309
00:15:09,630 --> 00:15:13,113
can establish connectivity
to IPv4 destinations.

310
00:15:14,100 --> 00:15:16,500
Similarly, in the dual-stack subnet,

311
00:15:16,500 --> 00:15:19,890
you then add a default route for IPv6,

312
00:15:19,890 --> 00:15:23,160
and then it can also connect
to IPv4 destinations.

313
00:15:23,160 --> 00:15:27,120
But for IPv6, it can also go
via the same Internet Gateway.

314
00:15:27,120 --> 00:15:31,350
So Internet Gateway supports
both IPv4 and IPv6 traffic.

315
00:15:31,350 --> 00:15:33,210
Keep in mind that here the translation

316
00:15:33,210 --> 00:15:35,280
that I'm talking about
here, the one-to-one NAT

317
00:15:35,280 --> 00:15:37,953
that Internet Gateway
is doing, it's for IPv4.

318
00:15:39,450 --> 00:15:42,720
Now we also talked about
public IPv6-only subnets.

319
00:15:42,720 --> 00:15:45,150
So in this case, as I mentioned,

320
00:15:45,150 --> 00:15:49,020
Internet Gateway can connect
to IPv6 destinations.

321
00:15:49,020 --> 00:15:51,270
But in case of IPv4,

322
00:15:51,270 --> 00:15:53,850
what you can do is you
create a NAT gateway,

323
00:15:53,850 --> 00:15:57,780
which is a network address
translation service from AWS

324
00:15:57,780 --> 00:16:02,083
that allows you to translate
traffic from private IPv4

325
00:16:03,737 --> 00:16:07,500
to the internet destination.

326
00:16:07,500 --> 00:16:09,660
And here, you can enable DNS64,

327
00:16:09,660 --> 00:16:12,360
since it's an IPv6-only address space.

328
00:16:12,360 --> 00:16:16,830
And what you do here is that
is you specify the 64:ff9b,

329
00:16:16,830 --> 00:16:20,040
which is a well-known prefix
pointing to the NAT gateway.

330
00:16:20,040 --> 00:16:21,810
When NAT gateway sees this traffic

331
00:16:21,810 --> 00:16:23,460
coming from this well-known prefix,

332
00:16:23,460 --> 00:16:27,540
it knows that it needs to
translate from 6to4 automatically.

333
00:16:27,540 --> 00:16:29,520
And this is something that can be done

334
00:16:29,520 --> 00:16:31,020
on your existing NAT gateways,

335
00:16:31,020 --> 00:16:32,730
you do not have to create any net-new

336
00:16:32,730 --> 00:16:34,023
NAT gateways to do that.

337
00:16:34,980 --> 00:16:38,190
And keep in mind, here I talked
about a zonal NAT gateway,

338
00:16:38,190 --> 00:16:39,660
but a couple of weeks ago,

339
00:16:39,660 --> 00:16:42,300
we also launched a regional
NAT gateway as well

340
00:16:42,300 --> 00:16:44,100
that you can use for these purposes.

341
00:16:45,750 --> 00:16:47,730
What about private subnets now?

342
00:16:47,730 --> 00:16:51,360
In case of private subnets, we
know that you have to create

343
00:16:51,360 --> 00:16:54,796
a public NAT gateway that can then route

344
00:16:54,796 --> 00:16:59,130
via internet gateway to go
to the IPv4 destinations.

345
00:16:59,130 --> 00:17:02,880
Same thing works from another
dual-stack subnet on IPv4.

346
00:17:02,880 --> 00:17:06,000
But for IPv6, you can use what we call it

347
00:17:06,000 --> 00:17:09,270
as like an Egress-Only Internet
Gateway that allows you

348
00:17:09,270 --> 00:17:13,710
to connect and initiate outbound
connectivity from your VPC

349
00:17:13,710 --> 00:17:16,110
to the IPv6 destinations.

350
00:17:16,110 --> 00:17:19,500
Similarly, for private IPv6-only subnets,

351
00:17:19,500 --> 00:17:21,420
you define an egress on internet gateway

352
00:17:21,420 --> 00:17:23,490
to talk to IPv6's destinations.

353
00:17:23,490 --> 00:17:25,470
And again, you can use
the well-known prefix

354
00:17:25,470 --> 00:17:29,100
via a NAT gateway to talk
to IPv4 destinations,

355
00:17:29,100 --> 00:17:30,300
and that can give you

356
00:17:30,300 --> 00:17:32,553
that backwards compatibility with 6to4.

357
00:17:33,750 --> 00:17:36,390
Now so far we talked about
having internet access,

358
00:17:36,390 --> 00:17:39,420
but you may have a requirement
where you want to block

359
00:17:39,420 --> 00:17:41,910
that internet connectivity,

360
00:17:41,910 --> 00:17:44,820
and you can block that
using what we call it

361
00:17:44,820 --> 00:17:46,920
as Amazon VPC Block Public Access.

362
00:17:46,920 --> 00:17:48,510
It comes in two different modes,

363
00:17:48,510 --> 00:17:51,120
a bidirectional and an ingress-only mode.

364
00:17:51,120 --> 00:17:54,150
In bidirectional, we block both
internet ingress and egress.

365
00:17:54,150 --> 00:17:57,660
And in ingress-only, we
can block only ingress.

366
00:17:57,660 --> 00:18:02,660
But you can apply this at
AWS account, Organizations,

367
00:18:02,820 --> 00:18:04,380
or at an OU level.

368
00:18:04,380 --> 00:18:07,500
But if you want to also create exclusions,

369
00:18:07,500 --> 00:18:11,943
you can do that as well for
your egress inspection as well.

370
00:18:13,740 --> 00:18:16,050
We talked about Amazon VPC so far,

371
00:18:16,050 --> 00:18:19,020
and this Amazon VPC is
tied to an AWS account,

372
00:18:19,020 --> 00:18:21,720
but you have different
subnets within that.

373
00:18:21,720 --> 00:18:24,990
And what you can do is
you can share your subnets

374
00:18:24,990 --> 00:18:27,990
that are part of the same
VPC with different accounts

375
00:18:27,990 --> 00:18:30,180
using Resource Access Manager.

376
00:18:30,180 --> 00:18:34,440
And those shared subnets can
then allow the participants

377
00:18:34,440 --> 00:18:36,360
to create resources within that.

378
00:18:36,360 --> 00:18:38,280
This is helpful if you want to conserve

379
00:18:38,280 --> 00:18:42,120
your IPv4 address space, and
you have separation of duties

380
00:18:42,120 --> 00:18:45,240
between the networking and
security teams to do that.

381
00:18:45,240 --> 00:18:47,970
You can still control access
between different subnets

382
00:18:47,970 --> 00:18:50,670
using security groups network
cases that we talked about,

383
00:18:50,670 --> 00:18:52,380
or by putting a firewall in between them,

384
00:18:52,380 --> 00:18:55,290
which Dave is going to
talk about later on.

385
00:18:55,290 --> 00:18:57,990
Now we talked about
connectivity to the internet,

386
00:18:57,990 --> 00:19:00,600
what about connectivity to AWS services?

387
00:19:00,600 --> 00:19:05,190
So you can use Gateway
Endpoints to access AWS services

388
00:19:05,190 --> 00:19:07,380
such as S3 and DynamoDB.

389
00:19:07,380 --> 00:19:10,643
And what it does is that is
you create a gateway endpoint

390
00:19:10,643 --> 00:19:13,167
and we support both dual-stack, IPv4-only,

391
00:19:13,167 --> 00:19:15,390
and IPv6-only as well.

392
00:19:15,390 --> 00:19:18,870
What it does is that is it
automatically adds a Prefix List

393
00:19:18,870 --> 00:19:21,600
for that service within
your VPC route table,

394
00:19:21,600 --> 00:19:25,500
and you can do that for
both IPv4 and IPv6 now.

395
00:19:25,500 --> 00:19:29,460
And this allows connectivity
from your EC2 instances

396
00:19:29,460 --> 00:19:32,430
to S3 and DynamoDB over AWS backbone.

397
00:19:32,430 --> 00:19:33,660
It is private and secure.

398
00:19:33,660 --> 00:19:35,970
You do not have to
create any other gateways

399
00:19:35,970 --> 00:19:37,520
to establish that connectivity.

400
00:19:38,670 --> 00:19:40,590
What about other AWS services?

401
00:19:40,590 --> 00:19:44,493
We also have Interface VPC
Endpoint for AWS services.

402
00:19:45,390 --> 00:19:48,090
And what you can do here
is that is you create

403
00:19:48,090 --> 00:19:49,800
what we call it as like
an interface endpoint,

404
00:19:49,800 --> 00:19:51,960
also known as like PrivateLink endpoint,

405
00:19:51,960 --> 00:19:54,780
which creates an Elastic Network
Interface within the VPC,

406
00:19:54,780 --> 00:19:57,930
and we support both IPv4
and IPv6, and dual-stack.

407
00:19:57,930 --> 00:19:59,760
And the instances then send traffic

408
00:19:59,760 --> 00:20:01,738
to these AWS services privately

409
00:20:01,738 --> 00:20:04,710
and securely to AWS services,

410
00:20:04,710 --> 00:20:06,410
and you can access these services.

411
00:20:07,500 --> 00:20:10,113
And we support over
170 plus services here.

412
00:20:11,070 --> 00:20:13,413
Let's talk about VPC to VPC connectivity.

413
00:20:14,310 --> 00:20:16,590
The simplest way to connect
to VPCs in the region

414
00:20:16,590 --> 00:20:18,750
is to use Amazon VPC Peering.

415
00:20:18,750 --> 00:20:19,890
Here you can see,

416
00:20:19,890 --> 00:20:22,530
you have two VPCs that
are non-overlapping.

417
00:20:22,530 --> 00:20:25,140
We create and update the
VPC route table pointing

418
00:20:25,140 --> 00:20:28,050
to the peering connection
ID of the other VPC,

419
00:20:28,050 --> 00:20:30,600
and the instances can
communicate with each other.

420
00:20:30,600 --> 00:20:33,153
Now, is this traffic encrypted?

421
00:20:34,530 --> 00:20:38,400
To do that, we just introduced
a VPC Encryption Controls.

422
00:20:38,400 --> 00:20:40,800
This is a new capability that you can use

423
00:20:40,800 --> 00:20:43,230
to update and enforce
encryption in transit

424
00:20:43,230 --> 00:20:45,150
for all of your traffic within the VPC

425
00:20:45,150 --> 00:20:47,460
and across the VPC in a single region.

426
00:20:47,460 --> 00:20:49,680
And what you can do that
is it comes in two modes,

427
00:20:49,680 --> 00:20:51,090
a monitor and an enforce mode.

428
00:20:51,090 --> 00:20:55,560
In monitor mode, you can monitor
your traffic within the VPC

429
00:20:55,560 --> 00:20:58,740
and look at resources that
are not encrypting traffic.

430
00:20:58,740 --> 00:21:01,590
And you can use VPC flow logs,
which Dave will talk about.

431
00:21:01,590 --> 00:21:04,530
And in the enforce mode, you
can enforce which services

432
00:21:04,530 --> 00:21:06,480
and resources encrypt traffic.

433
00:21:06,480 --> 00:21:08,250
And you can also create exclusions

434
00:21:08,250 --> 00:21:10,200
if you want to internet destinations

435
00:21:10,200 --> 00:21:12,030
and some other destinations as well.

436
00:21:12,030 --> 00:21:13,500
So how does this work?

437
00:21:13,500 --> 00:21:15,540
With VPC Encrypt Controls,

438
00:21:15,540 --> 00:21:19,290
you create and enforce
encryption on your VPCs

439
00:21:19,290 --> 00:21:21,780
that then you can encrypt the traffic

440
00:21:21,780 --> 00:21:24,270
between the two Nitro-supported instances

441
00:21:24,270 --> 00:21:26,310
over the VPC peering connection.

442
00:21:26,310 --> 00:21:28,260
You also have VPC peering that supports

443
00:21:28,260 --> 00:21:32,670
across regions as well, and
everything works the same.

444
00:21:32,670 --> 00:21:36,671
But what if you want to
have VPCs that want to scale

445
00:21:36,671 --> 00:21:38,948
more than what VPC peering supports

446
00:21:38,948 --> 00:21:41,700
and you want to have
transitive routing as well.

447
00:21:41,700 --> 00:21:43,500
You can do that with Transit Gateway.

448
00:21:43,500 --> 00:21:46,050
Transit Gateway is a layer three routing,

449
00:21:46,050 --> 00:21:47,100
virtual router service,

450
00:21:47,100 --> 00:21:49,680
that allows you to connect multiple VPCs,

451
00:21:49,680 --> 00:21:51,930
and you can define your VPC route tables

452
00:21:51,930 --> 00:21:53,880
and point to the Transit
Gateway as the next hop

453
00:21:53,880 --> 00:21:55,653
for both v4 and v6 traffic.

454
00:21:57,420 --> 00:21:59,280
You can have Transit
Gateways in one region

455
00:21:59,280 --> 00:22:02,850
or in the same region, and
you can peer them together,

456
00:22:02,850 --> 00:22:06,210
or they can be in different
regions, and you can peer them.

457
00:22:06,210 --> 00:22:08,640
But in this case, we only
support static routing.

458
00:22:08,640 --> 00:22:10,800
And in case of static routing,

459
00:22:10,800 --> 00:22:13,380
which means that if you add
another region or a VPC,

460
00:22:13,380 --> 00:22:15,150
then you have to add statically add routes

461
00:22:15,150 --> 00:22:16,620
across all your network,

462
00:22:16,620 --> 00:22:18,480
and that can become cumbersome.

463
00:22:18,480 --> 00:22:21,660
To address that challenge,
you can use AWS Cloud WAN

464
00:22:21,660 --> 00:22:26,190
and build that global WAN
connectivity to do that.

465
00:22:26,190 --> 00:22:28,260
Here, I'm showing a
three-region deployment

466
00:22:28,260 --> 00:22:30,540
where you can manage this network

467
00:22:30,540 --> 00:22:32,550
using a JSON policy document,

468
00:22:32,550 --> 00:22:34,290
and you can show your three regions.

469
00:22:34,290 --> 00:22:35,280
And what it does is that is,

470
00:22:35,280 --> 00:22:38,103
it creates a Transit
Gateway managed by AWS,

471
00:22:38,103 --> 00:22:41,223
and we support dynamic
routing across this network.

472
00:22:43,207 --> 00:22:45,540
Cloud WAN also has a concept of segments,

473
00:22:45,540 --> 00:22:46,920
which is nothing but like a VRF

474
00:22:46,920 --> 00:22:48,540
that you folks might be familiar with.

475
00:22:48,540 --> 00:22:51,060
You can have these
segments either globally,

476
00:22:51,060 --> 00:22:53,260
or you can have a
regional segments as well.

477
00:22:57,480 --> 00:22:59,460
VPCs that are connected
to the same segment

478
00:22:59,460 --> 00:23:02,370
enable connectivity, but you
can prevent that communication

479
00:23:02,370 --> 00:23:03,543
by setting this flag,

480
00:23:07,140 --> 00:23:10,080
then your VPCs can
attach to the Cloud WAN.

481
00:23:10,080 --> 00:23:13,560
But the way you can do that
is by attaching the policy,

482
00:23:13,560 --> 00:23:16,290
and you can define saying that
if there is a specific tag,

483
00:23:16,290 --> 00:23:19,683
go ahead and associate to the
specific segment to do that.

484
00:23:25,260 --> 00:23:26,370
How do you share routes?

485
00:23:26,370 --> 00:23:28,590
You can do a segment route sharing.

486
00:23:28,590 --> 00:23:30,330
And again, this is also controlled

487
00:23:30,330 --> 00:23:32,400
through the policy as well.

488
00:23:32,400 --> 00:23:35,010
Now let's talk about hybrid connectivity.

489
00:23:35,010 --> 00:23:37,620
The first option is to
use AWS Direct Connect,

490
00:23:37,620 --> 00:23:39,540
which is a private dedicated connection

491
00:23:39,540 --> 00:23:41,460
from your corporate data center

492
00:23:41,460 --> 00:23:43,680
to AWS bypassing the internet.

493
00:23:43,680 --> 00:23:45,420
The way it supports is that is you connect

494
00:23:45,420 --> 00:23:47,700
to one of our AWS Direct
Connect locations,

495
00:23:47,700 --> 00:23:50,070
you can either have a
dedicated connection,

496
00:23:50,070 --> 00:23:51,300
or a hosted connection.

497
00:23:51,300 --> 00:23:53,100
It comes in different speeds.

498
00:23:53,100 --> 00:23:55,860
And at this location,
you have an AWS router,

499
00:23:55,860 --> 00:23:57,630
and you may either have your own router,

500
00:23:57,630 --> 00:24:00,300
or you can work with a partner
that has their own router,

501
00:24:00,300 --> 00:24:02,580
and create a cross-connect between them,

502
00:24:02,580 --> 00:24:05,310
and extend connectivity
to your corporate network

503
00:24:05,310 --> 00:24:07,020
through that partner network.

504
00:24:07,020 --> 00:24:09,270
That's your physical connection.

505
00:24:09,270 --> 00:24:11,250
Now what about the logical connection?

506
00:24:11,250 --> 00:24:15,000
You create a logical connectivity
using virtual interfaces.

507
00:24:15,000 --> 00:24:17,820
You can create a public VIF
to access public services.

508
00:24:17,820 --> 00:24:20,190
And when you do that, we set up a BGP,

509
00:24:20,190 --> 00:24:22,380
which supports both v4 and v6,

510
00:24:22,380 --> 00:24:25,950
and we advertise all AWS prefixes
back to your on-premises.

511
00:24:25,950 --> 00:24:29,520
You can also connect to a
VPC using a construct called

512
00:24:29,520 --> 00:24:32,130
as Direct Connect Gateway and
a Virtual Private Gateway.

513
00:24:32,130 --> 00:24:34,230
The Direct Connect Gateway
is a global construct,

514
00:24:34,230 --> 00:24:36,360
which is highly available,
highly redundant,

515
00:24:36,360 --> 00:24:38,370
and it allows your connectivity

516
00:24:38,370 --> 00:24:40,980
to multiple VPCs in
different regions as well.

517
00:24:40,980 --> 00:24:43,110
And in this case, Direct Connect Gateway

518
00:24:43,110 --> 00:24:45,142
has a construct called as allowed prefixes

519
00:24:45,142 --> 00:24:48,510
where all the VPCs that are connected

520
00:24:48,510 --> 00:24:49,650
through that Direct Connect Gateway

521
00:24:49,650 --> 00:24:51,000
via Virtual Private Gateway,

522
00:24:51,000 --> 00:24:53,823
we advertise those prefixes
back to your on-premises.

523
00:24:55,170 --> 00:24:56,430
What about Transit Gateway?

524
00:24:56,430 --> 00:24:58,920
You can create a Transit VIF

525
00:24:58,920 --> 00:25:00,450
connecting to the Direct Connect Gateway,

526
00:25:00,450 --> 00:25:02,550
which then connects to
the Transit Gateway.

527
00:25:02,550 --> 00:25:04,830
And then on the Direct Connect Gateway,

528
00:25:04,830 --> 00:25:07,230
you specify what we call it
as like allowed prefixes.

529
00:25:07,230 --> 00:25:10,290
These are all the prefixes of
your VPCs that you advertise,

530
00:25:10,290 --> 00:25:13,383
that you want to advertise back
to your on-premises network.

531
00:25:14,850 --> 00:25:15,990
What about Cloud WAN?

532
00:25:15,990 --> 00:25:18,300
Cloud WAN also supports
with the Transit VIF

533
00:25:18,300 --> 00:25:21,453
and interconnect with Direct
Connect Gateway there.

534
00:25:22,770 --> 00:25:25,830
Now let's talk about Site-to-Site VPN.

535
00:25:25,830 --> 00:25:27,960
Site-to-Site VPN connection allows you

536
00:25:27,960 --> 00:25:30,960
to create IPsec-encrypted tunnels

537
00:25:30,960 --> 00:25:33,482
from your corporate data center to AWS.

538
00:25:33,482 --> 00:25:36,960
On the AWS side, you can
terminate this VPN connection

539
00:25:36,960 --> 00:25:38,910
on a Virtual Private Gateway.

540
00:25:38,910 --> 00:25:41,940
And when you do that,
we create two tunnels.

541
00:25:41,940 --> 00:25:43,800
Each tunnel is 1.25 gigs,

542
00:25:43,800 --> 00:25:46,860
and only one tunnel is active
at any given point of time.

543
00:25:46,860 --> 00:25:48,750
We do not support ECMP in this case,

544
00:25:48,750 --> 00:25:51,630
and we support both static
and dynamic routing.

545
00:25:51,630 --> 00:25:54,780
What if you want to connect
to multiple VPCs now?

546
00:25:54,780 --> 00:25:56,760
You can terminate that VPN connection

547
00:25:56,760 --> 00:25:58,530
on the Transit Gateway instead.

548
00:25:58,530 --> 00:26:01,440
And with Transit Gateway,
you get additional benefits

549
00:26:01,440 --> 00:26:04,110
such as you can have
an IPv6 also supported.

550
00:26:04,110 --> 00:26:07,080
We just recently announced
larger bandwidth tunnels

551
00:26:07,080 --> 00:26:08,520
where you can have now up to

552
00:26:08,520 --> 00:26:11,460
5 gigabits of bandwidth on each tunnel,

553
00:26:11,460 --> 00:26:13,143
and you can also do ECMP.

554
00:26:14,190 --> 00:26:17,430
Same thing works for AWS Cloud WAN as well

555
00:26:17,430 --> 00:26:20,460
where you can have
multiple VPN connections

556
00:26:20,460 --> 00:26:23,190
that are supported and you
can do ECMP in this phase

557
00:26:23,190 --> 00:26:25,523
and the other features
that I just talked about.

558
00:26:26,700 --> 00:26:29,820
What if you now want to
integrate your SD-WAN appliances?

559
00:26:29,820 --> 00:26:31,230
Here, you have VPCs connected

560
00:26:31,230 --> 00:26:33,390
to either Transit Gateway or Cloud WAN,

561
00:26:33,390 --> 00:26:35,220
and you have corporate data center.

562
00:26:35,220 --> 00:26:38,100
You can deploy these SD-WAN
appliances within the VPC,

563
00:26:38,100 --> 00:26:40,350
with the VPC attachment as the underlay.

564
00:26:40,350 --> 00:26:42,840
And on top of it, you create a GRE tunnel,

565
00:26:42,840 --> 00:26:45,720
and exchange BGP prefixes
from these SD-WAN appliances

566
00:26:45,720 --> 00:26:48,000
with either Transit Gateway or Cloud WAN,

567
00:26:48,000 --> 00:26:49,890
and you can further extend connectivity

568
00:26:49,890 --> 00:26:51,930
to your corporate data center

569
00:26:51,930 --> 00:26:55,024
with either Virtual Private
Gateway or internet.

570
00:26:55,024 --> 00:26:58,350
What if you don't want to
have those tunnels to manage

571
00:26:58,350 --> 00:27:00,330
and you want to get the full bandwidth?

572
00:27:00,330 --> 00:27:02,850
You can do that on Cloud WAN

573
00:27:02,850 --> 00:27:05,010
where you don't have to
manage those tunnels,

574
00:27:05,010 --> 00:27:08,763
and you can get the tunnel
less connect with Cloud WAN.

575
00:27:11,280 --> 00:27:15,003
All right, let's talk about
Elastic Load Balancing now.

576
00:27:17,400 --> 00:27:19,380
The first option in Elastic Load Balancing

577
00:27:19,380 --> 00:27:21,240
is Application Load Balancer.

578
00:27:21,240 --> 00:27:24,570
This is a layer seven load
balancer that allows you

579
00:27:24,570 --> 00:27:27,510
to load balance incoming traffic on HTTP

580
00:27:27,510 --> 00:27:30,870
and HTTPS to your applications.

581
00:27:30,870 --> 00:27:33,330
Here, on the Application Load Balancer,

582
00:27:33,330 --> 00:27:36,180
you can see, we support
advanced request routing.

583
00:27:36,180 --> 00:27:39,450
You can do cool things such
as like path-based routing,

584
00:27:39,450 --> 00:27:42,240
host-based routing, query
string, and so on and so forth.

585
00:27:42,240 --> 00:27:44,940
And we recently announced
a couple of months ago,

586
00:27:44,940 --> 00:27:48,450
a header modification where
you can modify these headers

587
00:27:48,450 --> 00:27:51,033
before it gets sent to the targets.

588
00:27:52,110 --> 00:27:55,650
And the Application Load Balancer

589
00:27:55,650 --> 00:27:59,640
can then load balance traffic
across these instances,

590
00:27:59,640 --> 00:28:02,550
and you can use different types
of load balancing algorithms

591
00:28:02,550 --> 00:28:03,603
that we support here.

592
00:28:05,880 --> 00:28:09,810
The second option is to
use Network Load Balancer.

593
00:28:09,810 --> 00:28:13,260
And with Network Load Balancer,
the beauty here is that is,

594
00:28:13,260 --> 00:28:15,690
it supports static IP addressing,

595
00:28:15,690 --> 00:28:18,300
which means that you can use
these static IP addresses

596
00:28:18,300 --> 00:28:20,760
to either allowlist
your specific firewalls

597
00:28:20,760 --> 00:28:22,680
or specific clients that
you want to do that.

598
00:28:22,680 --> 00:28:27,680
And we support both TCP, UDP, and TLS,

599
00:28:28,020 --> 00:28:30,450
and we recently announced
support for QUIC protocol

600
00:28:30,450 --> 00:28:32,763
as well on Network Load Balancer.

601
00:28:34,800 --> 00:28:36,690
Once the load balancer
receives that traffic,

602
00:28:36,690 --> 00:28:40,380
it can load balance traffic
across your targets,

603
00:28:40,380 --> 00:28:43,890
and we support both v4 and v6 targets.

604
00:28:43,890 --> 00:28:47,070
And here, the target group
we recently announced,

605
00:28:47,070 --> 00:28:48,790
where you can do weighted targets

606
00:28:50,088 --> 00:28:52,650
with Network Load Balancer as well.

607
00:28:52,650 --> 00:28:54,963
And with that, I will hand over to Dave.

608
00:28:57,450 --> 00:28:58,800
- All right. Thanks, Rohit.

609
00:28:59,970 --> 00:29:02,070
All right, now so far, we've been focusing

610
00:29:02,070 --> 00:29:04,440
on layer three connectivity
between our VPCs,

611
00:29:04,440 --> 00:29:06,090
but there's another way we can think about

612
00:29:06,090 --> 00:29:07,650
connecting our application together,

613
00:29:07,650 --> 00:29:09,810
and that's with Application Networking.

614
00:29:09,810 --> 00:29:11,490
So Application Networking
is a little bit different

615
00:29:11,490 --> 00:29:12,780
if you're not super familiar with it.

616
00:29:12,780 --> 00:29:14,430
Essentially, we focus on connectivity

617
00:29:14,430 --> 00:29:18,450
between resources and
applications instead of networks.

618
00:29:18,450 --> 00:29:23,220
So to do that, we'll create
an endpoint in our client VPC,

619
00:29:23,220 --> 00:29:25,320
and then that endpoint will
be configured with listeners

620
00:29:25,320 --> 00:29:27,210
appropriate to our applications
that we've got over

621
00:29:27,210 --> 00:29:28,510
on the provider side here.

622
00:29:29,520 --> 00:29:32,220
Now those applications
are going to appear native

623
00:29:32,220 --> 00:29:33,450
to that local VPC.

624
00:29:33,450 --> 00:29:36,180
So for example, when my
client here does a DNS lookup,

625
00:29:36,180 --> 00:29:38,850
they're going to get an IP
address for that endpoint

626
00:29:38,850 --> 00:29:41,130
local to that VPC.

627
00:29:41,130 --> 00:29:42,630
And there's two services we'll talk about

628
00:29:42,630 --> 00:29:44,037
that can provide this
kind of connectivity,

629
00:29:44,037 --> 00:29:47,910
AWS PrivateLink and Amazon VPC Lattice.

630
00:29:47,910 --> 00:29:50,460
Now regardless of which
one of these we use,

631
00:29:50,460 --> 00:29:53,430
this will allow us to use
identity-based access controls

632
00:29:53,430 --> 00:29:56,400
alongside network controls,
things like Route Tables,

633
00:29:56,400 --> 00:29:58,830
Network ACLs, stuff that Rohit
was talking about earlier.

634
00:29:58,830 --> 00:30:00,510
And this brings us into a position

635
00:30:00,510 --> 00:30:03,150
where we can start to talk
about Zero Trust as well.

636
00:30:03,150 --> 00:30:04,740
Now I'm not gonna read
the whole definition

637
00:30:04,740 --> 00:30:06,180
of Zero Trust there, but essentially,

638
00:30:06,180 --> 00:30:09,510
it's this idea where we
use identity-based controls

639
00:30:09,510 --> 00:30:13,143
alongside network controls to
improve our security posture.

640
00:30:14,490 --> 00:30:15,810
Now I mentioned there's two services,

641
00:30:15,810 --> 00:30:17,260
let's start with PrivateLink.

642
00:30:18,330 --> 00:30:21,420
Now with PrivateLink, we
can access AWS services,

643
00:30:21,420 --> 00:30:22,290
Rohit mentioned that earlier,

644
00:30:22,290 --> 00:30:24,810
but we can also access
custom-defined services

645
00:30:24,810 --> 00:30:26,880
whether that's for our
own internal consumption,

646
00:30:26,880 --> 00:30:29,250
or maybe we're sharing those
out with a third party.

647
00:30:29,250 --> 00:30:32,640
So to do that, we'll need a
Network Load Balancer to start.

648
00:30:32,640 --> 00:30:34,860
And then we'll define target groups

649
00:30:34,860 --> 00:30:36,930
based off of the different
types you see here.

650
00:30:36,930 --> 00:30:38,210
And these will can support
different listener types

651
00:30:38,210 --> 00:30:42,150
from TCP or UDP, with a callout
that if you're gonna do UDP,

652
00:30:42,150 --> 00:30:45,333
it does need to have an IPv6 target.

653
00:30:46,440 --> 00:30:49,590
And then we'll use a
VPC interface endpoint

654
00:30:49,590 --> 00:30:52,320
to access that service
from the client side.

655
00:30:52,320 --> 00:30:54,930
And these clients can be
IPv4, they can be IPv6,

656
00:30:54,930 --> 00:30:56,630
or they can be dual-stack as well.

657
00:30:57,480 --> 00:30:59,040
And that allows us also

658
00:30:59,040 --> 00:31:01,350
to not only communicate
across different types,

659
00:31:01,350 --> 00:31:03,600
but also have those
endpoints be in different,

660
00:31:03,600 --> 00:31:05,553
you know, v4, v6 as well.

661
00:31:06,840 --> 00:31:09,060
Now from consideration here,

662
00:31:09,060 --> 00:31:11,430
you'll notice that I have
deliberately highlighted

663
00:31:11,430 --> 00:31:12,990
these overlapping IPv4 CIDR.

664
00:31:12,990 --> 00:31:14,130
So if you're in a situation

665
00:31:14,130 --> 00:31:16,920
where you have overlapping IPv4 CIDRs,

666
00:31:16,920 --> 00:31:17,753
PrivateLink allows you

667
00:31:17,753 --> 00:31:20,100
to still have that
connectivity between them.

668
00:31:20,100 --> 00:31:23,820
Now these clients and services
can be in different regions,

669
00:31:23,820 --> 00:31:26,520
and they can also be
in different accounts.

670
00:31:26,520 --> 00:31:28,560
Now from a security perspective,

671
00:31:28,560 --> 00:31:30,270
the first thing that you
should know about PrivateLink

672
00:31:30,270 --> 00:31:32,040
is that this is unit
directional connectivity.

673
00:31:32,040 --> 00:31:35,640
Providers cannot initiate
connections to client resources.

674
00:31:35,640 --> 00:31:37,200
So as a consumer or as a client,

675
00:31:37,200 --> 00:31:39,630
I can connect to those
resources through PrivateLink,

676
00:31:39,630 --> 00:31:42,060
but the provider cannot initiate
a connection back to me,

677
00:31:42,060 --> 00:31:45,270
they can only respond to
traffic that I've started.

678
00:31:45,270 --> 00:31:47,100
Additionally, from the provider side,

679
00:31:47,100 --> 00:31:48,720
I've got some additional controls.

680
00:31:48,720 --> 00:31:50,520
First, I can define service permissions,

681
00:31:50,520 --> 00:31:52,680
which basically are IAM policies saying

682
00:31:52,680 --> 00:31:55,680
which principals can access my service,

683
00:31:55,680 --> 00:31:57,240
and I can also then when someone tries

684
00:31:57,240 --> 00:32:00,090
to connect to my service,
allow or block access

685
00:32:00,090 --> 00:32:02,790
to that service when they
try to create that endpoint.

686
00:32:04,140 --> 00:32:05,430
Now from a DNS perspective,

687
00:32:05,430 --> 00:32:08,910
PrivateLink is gonna create
endpoint specific DNS host name

688
00:32:08,910 --> 00:32:10,530
for each service that we have.

689
00:32:10,530 --> 00:32:12,600
So it'll look something like
what you have on the screen.

690
00:32:12,600 --> 00:32:14,520
And when our client goes to resolve that,

691
00:32:14,520 --> 00:32:17,160
again, they'll get an IP
address local to that VPC

692
00:32:17,160 --> 00:32:19,293
using that long custom DNS name.

693
00:32:20,160 --> 00:32:21,720
Or if you don't want to use that.

694
00:32:21,720 --> 00:32:25,020
Well, in that case, you could
also specify a custom DNS name

695
00:32:25,020 --> 00:32:26,580
for your endpoint service.

696
00:32:26,580 --> 00:32:29,490
So in this case, I'm gonna
use app1.example.com.

697
00:32:29,490 --> 00:32:32,730
I need to validate that I
actually own app1.example.com

698
00:32:32,730 --> 00:32:34,410
before I can, you know, use that.

699
00:32:34,410 --> 00:32:37,890
But once I do that validation
process, I can then use that.

700
00:32:37,890 --> 00:32:41,280
And when my clients go to
look up app1.example.com,

701
00:32:41,280 --> 00:32:42,113
that'll now resolve to those

702
00:32:42,113 --> 00:32:44,913
PrivateLink IP addresses within the VPC.

703
00:32:46,710 --> 00:32:48,687
All of that requires having a
Network Load Balancer though.

704
00:32:48,687 --> 00:32:51,240
And you might have some
resources like these

705
00:32:51,240 --> 00:32:54,060
that don't require a
Network Load Balancer.

706
00:32:54,060 --> 00:32:56,040
And if that's the case,

707
00:32:56,040 --> 00:32:57,930
that's where you could use VPC resources.

708
00:32:57,930 --> 00:32:58,950
Now this is slightly newer,

709
00:32:58,950 --> 00:33:01,020
we launched these last year at re:Invent.

710
00:33:01,020 --> 00:33:03,690
And these provide that same
kind of secure, private,

711
00:33:03,690 --> 00:33:05,220
unidirectional connectivity

712
00:33:05,220 --> 00:33:07,770
without needing a Network Load Balancer.

713
00:33:07,770 --> 00:33:09,660
So instead, we'll have a construct

714
00:33:09,660 --> 00:33:11,430
called a Resource Gateway.

715
00:33:11,430 --> 00:33:13,380
And with this Resource
Gateway, we can then define

716
00:33:13,380 --> 00:33:15,360
what are called resource configurations

717
00:33:15,360 --> 00:33:17,460
for each type of resource
that we want to use.

718
00:33:17,460 --> 00:33:19,170
And the supported types
are up there on the screen.

719
00:33:19,170 --> 00:33:22,020
We support FQDNs, IP addresses,

720
00:33:22,020 --> 00:33:24,210
and you can also specify resources by ARN,

721
00:33:24,210 --> 00:33:25,983
and we support RDS on that today.

722
00:33:26,910 --> 00:33:29,520
Once I do that, I'll
create a resource endpoint

723
00:33:29,520 --> 00:33:31,110
in my client VPC,

724
00:33:31,110 --> 00:33:33,810
and I will be able to access
those resources that way.

725
00:33:35,670 --> 00:33:37,080
Now a couple callouts here,

726
00:33:37,080 --> 00:33:38,790
because this differs a
little bit from PrivateLink.

727
00:33:38,790 --> 00:33:40,800
First, these are regional constructs.

728
00:33:40,800 --> 00:33:43,710
You're not gonna do these
across region today.

729
00:33:43,710 --> 00:33:45,570
You can however share them across accounts

730
00:33:45,570 --> 00:33:46,830
using Resource Access Manager

731
00:33:46,830 --> 00:33:48,390
to create that resource configuration,

732
00:33:48,390 --> 00:33:49,840
share it with other accounts.

733
00:33:50,790 --> 00:33:52,800
And each resource, just
like with PrivateLink,

734
00:33:52,800 --> 00:33:54,180
is gonna have its own unique endpoint

735
00:33:54,180 --> 00:33:55,440
with a unique DNS name.

736
00:33:55,440 --> 00:33:56,580
That's gonna look again

737
00:33:56,580 --> 00:33:58,800
something like that on the screen here.

738
00:33:58,800 --> 00:34:00,240
And just like with PrivateLink,

739
00:34:00,240 --> 00:34:01,470
if you don't want to use that,

740
00:34:01,470 --> 00:34:03,120
you can create a custom domain name

741
00:34:03,120 --> 00:34:04,380
for these resources as well.

742
00:34:04,380 --> 00:34:06,930
We just announced support
for that fairly recently.

743
00:34:06,930 --> 00:34:09,753
So if I want to use
resource1.example.com here,

744
00:34:10,650 --> 00:34:12,810
I can now use that from my client side,

745
00:34:12,810 --> 00:34:14,610
and that'll resolve to my end point.

746
00:34:16,710 --> 00:34:18,360
Now one other call out here.

747
00:34:18,360 --> 00:34:20,280
So we've got a bunch of resources.

748
00:34:20,280 --> 00:34:22,050
As I add additional resources

749
00:34:22,050 --> 00:34:23,820
or want to access additional resources,

750
00:34:23,820 --> 00:34:26,250
I'm gonna need to create
additional endpoints

751
00:34:26,250 --> 00:34:27,570
for each one of these,

752
00:34:27,570 --> 00:34:29,940
'cause this is functionally
point-to-point connectivity.

753
00:34:29,940 --> 00:34:31,980
So that works at, you
know, maybe a small scale,

754
00:34:31,980 --> 00:34:34,350
or if I've only got a few
resources I need to access.

755
00:34:34,350 --> 00:34:36,270
But if I wanna manage this at scale,

756
00:34:36,270 --> 00:34:37,620
or if I have a lot of resources

757
00:34:37,620 --> 00:34:39,510
and services I want to connect to,

758
00:34:39,510 --> 00:34:42,123
well, that's where VPC
Lattice is gonna come in.

759
00:34:43,140 --> 00:34:44,820
Now with Lattice, not
only can we use those

760
00:34:44,820 --> 00:34:47,310
same resource configurations
we just looked at,

761
00:34:47,310 --> 00:34:50,760
but we can also create
constructs called services.

762
00:34:50,760 --> 00:34:53,370
I'm gonna take a quick moment
and talk about services here.

763
00:34:53,370 --> 00:34:54,780
So services, you can think of these

764
00:34:54,780 --> 00:34:56,220
as layer seven constructs.

765
00:34:56,220 --> 00:34:57,600
They're very similar
to what we talked about

766
00:34:57,600 --> 00:34:59,670
when Rohit had covered
Application Load Balancer

767
00:34:59,670 --> 00:35:03,900
a few minutes ago, they're
layer seven, HTTP, HTTPS, TLS.

768
00:35:03,900 --> 00:35:05,190
So we'll configure these services

769
00:35:05,190 --> 00:35:07,440
with listeners and target groups.

770
00:35:07,440 --> 00:35:10,440
And then we'll take those
services and we'll associate them

771
00:35:10,440 --> 00:35:12,810
with a construct called
the service network.

772
00:35:12,810 --> 00:35:14,220
And that service network

773
00:35:14,220 --> 00:35:16,260
makes those services
accessible from clients.

774
00:35:16,260 --> 00:35:19,020
And I'll talk about how
that works in a moment.

775
00:35:19,020 --> 00:35:22,200
And we can also apply auth policies.

776
00:35:22,200 --> 00:35:23,220
And these auth policies,

777
00:35:23,220 --> 00:35:25,830
or functionally IAM policy
documents, that we can apply

778
00:35:25,830 --> 00:35:28,650
either broadly at the
service network level,

779
00:35:28,650 --> 00:35:31,293
or at the individual
service level instead.

780
00:35:33,450 --> 00:35:34,890
Now from a client perspective,

781
00:35:34,890 --> 00:35:37,080
this is gonna look pretty
similar to what we saw before.

782
00:35:37,080 --> 00:35:39,240
I've got two client VPCs here.

783
00:35:39,240 --> 00:35:42,210
My first option is gonna be a
service network association.

784
00:35:42,210 --> 00:35:44,400
I can only have one
service network association

785
00:35:44,400 --> 00:35:46,950
with a given VPC, but if I've
only got one service network,

786
00:35:46,950 --> 00:35:48,330
that's a good way to go.

787
00:35:48,330 --> 00:35:50,220
And this works with route tables.

788
00:35:50,220 --> 00:35:52,020
So just like with a gateway endpoint

789
00:35:52,020 --> 00:35:53,310
where it adds those routes

790
00:35:53,310 --> 00:35:55,290
into your route table automatically,

791
00:35:55,290 --> 00:35:58,320
the service network
association works the same way.

792
00:35:58,320 --> 00:36:00,630
Otherwise, you can do a
service network endpoint.

793
00:36:00,630 --> 00:36:02,740
And this endpoint is
gonna again use an IPv4

794
00:36:02,740 --> 00:36:06,030
or an IPv6 address right
out of your VPC there.

795
00:36:06,030 --> 00:36:07,230
Either one of those will allow you

796
00:36:07,230 --> 00:36:10,380
to connect to your service network,

797
00:36:10,380 --> 00:36:12,150
and can apply those additional controls

798
00:36:12,150 --> 00:36:15,270
like security groups and
network ACLs on top of that.

799
00:36:15,270 --> 00:36:17,010
So between the auth policies

800
00:36:17,010 --> 00:36:18,300
and these additional constructs,

801
00:36:18,300 --> 00:36:20,520
you're again going back to
that idea of Zero Trust,

802
00:36:20,520 --> 00:36:22,320
where you're layering
these additional ideas

803
00:36:22,320 --> 00:36:23,370
on top of each other.

804
00:36:24,360 --> 00:36:25,680
And both of these, like I said,

805
00:36:25,680 --> 00:36:28,350
will give you access to
your service network.

806
00:36:28,350 --> 00:36:30,780
And finally, using those same resource

807
00:36:30,780 --> 00:36:32,610
configurations we looked at earlier,

808
00:36:32,610 --> 00:36:34,170
we can now tie all of this together

809
00:36:34,170 --> 00:36:35,640
into a single service network,

810
00:36:35,640 --> 00:36:38,790
so we can access our
services and our resources,

811
00:36:38,790 --> 00:36:39,900
and both will be accessible

812
00:36:39,900 --> 00:36:41,580
via that service network endpoint

813
00:36:41,580 --> 00:36:43,260
and that service network association.

814
00:36:43,260 --> 00:36:45,873
So for a scale, this is
gonna be your better option.

815
00:36:47,400 --> 00:36:50,160
Now I've started talking a
little bit about DNS as well.

816
00:36:50,160 --> 00:36:51,360
And earlier, Rohit had explained

817
00:36:51,360 --> 00:36:53,730
how the Route 53 Resolver
works within a VPC.

818
00:36:53,730 --> 00:36:57,150
You've got that .2 address
and that v6 address.

819
00:36:57,150 --> 00:36:59,460
Using the Route 53 Resolver
is gonna give us access

820
00:36:59,460 --> 00:37:01,380
to some additional capabilities.

821
00:37:01,380 --> 00:37:04,110
First one, being Resolver DNS Firewall.

822
00:37:04,110 --> 00:37:07,230
Now with DNS Firewall, we can
create either block lists,

823
00:37:07,230 --> 00:37:09,513
so domains that we
explicitly want to block,

824
00:37:10,380 --> 00:37:11,880
or we can create allow lists,

825
00:37:11,880 --> 00:37:13,500
where we take the
opposite approach and say,

826
00:37:13,500 --> 00:37:16,650
we only want to allow DNS
resolution to these domains,

827
00:37:16,650 --> 00:37:19,320
taking that walled
garden type of approach.

828
00:37:19,320 --> 00:37:20,280
So we'll define those,

829
00:37:20,280 --> 00:37:22,140
we'll define any actions
we want to take on that.

830
00:37:22,140 --> 00:37:24,660
We can define if we only
want these rules to apply

831
00:37:24,660 --> 00:37:28,230
to specific types like A
records, AAAA records, et cetera.

832
00:37:28,230 --> 00:37:32,250
And we'll associate all
of these rules to our VPC,

833
00:37:32,250 --> 00:37:34,290
and then we can optionally
use some additional controls

834
00:37:34,290 --> 00:37:36,120
to prevent against
things like DNS tunneling

835
00:37:36,120 --> 00:37:37,773
and domain generation algorithms.

836
00:37:39,060 --> 00:37:42,810
We can then start to use Resolver
query logging separately,

837
00:37:42,810 --> 00:37:44,820
or in conjunction with this as well.

838
00:37:44,820 --> 00:37:46,290
And like the name implies,

839
00:37:46,290 --> 00:37:48,780
well, this is just going
to log your DNS queries

840
00:37:48,780 --> 00:37:51,630
that go to that Route
53 Resolver in the VPC.

841
00:37:51,630 --> 00:37:54,810
So it'll include source,
destination, any responses,

842
00:37:54,810 --> 00:37:58,920
but it'll also give you any
information about rule actions,

843
00:37:58,920 --> 00:38:00,180
or any effects that were taken,

844
00:38:00,180 --> 00:38:02,550
as a result of your firewall rule groups.

845
00:38:02,550 --> 00:38:05,760
So you take that, apply to your VPC.

846
00:38:05,760 --> 00:38:08,340
And this can be super useful
not only for just understanding

847
00:38:08,340 --> 00:38:09,990
what DNS traffic you have,

848
00:38:09,990 --> 00:38:12,060
but also if you're trying to troubleshoot

849
00:38:12,060 --> 00:38:14,130
any kind of like firewall
rules that you may have created

850
00:38:14,130 --> 00:38:16,830
that maybe you're having
some unintended consequences.

851
00:38:18,060 --> 00:38:19,980
I'm gonna put those aside for a moment.

852
00:38:19,980 --> 00:38:21,960
What if you want private DNS?

853
00:38:21,960 --> 00:38:24,840
You know, like you might have
in your data center today?

854
00:38:24,840 --> 00:38:27,750
For that, we have this idea
of a private hosted zone.

855
00:38:27,750 --> 00:38:28,920
So I'll create a zone here.

856
00:38:28,920 --> 00:38:31,530
In this case, for app1.example.com,

857
00:38:31,530 --> 00:38:34,980
and I'll define records within that zone.

858
00:38:34,980 --> 00:38:38,850
I will say take that zone and
I can associate it with a VPC.

859
00:38:38,850 --> 00:38:41,550
Now, as the name private
hosted zone implies,

860
00:38:41,550 --> 00:38:43,980
this is a private hosted zone.

861
00:38:43,980 --> 00:38:46,800
If it is not associated with that VPC,

862
00:38:46,800 --> 00:38:48,963
nothing in that zone will be resolvable.

863
00:38:50,250 --> 00:38:52,350
So in this case, when
I've got my instance,

864
00:38:52,350 --> 00:38:54,660
I'm gonna query foo.app1.example.com.

865
00:38:54,660 --> 00:38:55,920
Because of that association,

866
00:38:55,920 --> 00:38:58,170
I can successfully resolve that.

867
00:38:58,170 --> 00:39:01,260
I can also associate
multiple private hosted zones

868
00:39:01,260 --> 00:39:02,793
to a single VPC.

869
00:39:05,160 --> 00:39:07,350
I can also take those
same private hosted zones

870
00:39:07,350 --> 00:39:09,240
and associate them with multiple VPCs,

871
00:39:09,240 --> 00:39:12,843
so that'll give me a
multi VPC view of my DNS.

872
00:39:15,510 --> 00:39:16,890
Now what about our data center?

873
00:39:16,890 --> 00:39:17,970
We don't want our poor data center

874
00:39:17,970 --> 00:39:20,640
feel left out of all the DNS fun, right?

875
00:39:20,640 --> 00:39:23,550
So for that, what we can do

876
00:39:23,550 --> 00:39:25,200
is we're gonna take these
private hosted zones,

877
00:39:25,200 --> 00:39:26,730
we'll associate them with our VPC,

878
00:39:26,730 --> 00:39:27,630
and then we're gonna create

879
00:39:27,630 --> 00:39:30,390
what's called an inbound
resolver endpoint.

880
00:39:30,390 --> 00:39:34,230
And that endpoint will allow us to resolve

881
00:39:34,230 --> 00:39:36,840
those private hosted zones
from our data center.

882
00:39:36,840 --> 00:39:39,123
So to do that, we'll create a forwarder

883
00:39:39,123 --> 00:39:41,430
in our on-premises DNS server.

884
00:39:41,430 --> 00:39:42,263
And as long as we have

885
00:39:42,263 --> 00:39:43,710
some kind of private connectivity path,

886
00:39:43,710 --> 00:39:45,510
so like Direct Connect
or Site-to-Site VPN,

887
00:39:45,510 --> 00:39:46,710
like we talked about earlier,

888
00:39:46,710 --> 00:39:48,330
we'll then be able to resolve those,

889
00:39:48,330 --> 00:39:50,310
and we can optionally
choose to encrypt that

890
00:39:50,310 --> 00:39:52,680
with DNS over HTTPS as well.

891
00:39:52,680 --> 00:39:56,343
So from a flow perspective,
we've got our DNS server,

892
00:39:57,480 --> 00:39:58,630
it's got our forwarder,

893
00:39:59,610 --> 00:40:03,720
that server receives a query
for foo.app1.example.com,

894
00:40:03,720 --> 00:40:06,300
and then that will now go to
our inbound resolver endpoint,

895
00:40:06,300 --> 00:40:08,500
so we can resolve this
private hosted zones.

896
00:40:09,990 --> 00:40:11,640
Now what about the opposite direction?

897
00:40:11,640 --> 00:40:13,470
Well, we had an inbound endpoint,

898
00:40:13,470 --> 00:40:15,330
now we've got an outbound endpoint.

899
00:40:15,330 --> 00:40:16,950
The same idea here before,

900
00:40:16,950 --> 00:40:19,290
we had a forwarder in
our on-premises server.

901
00:40:19,290 --> 00:40:22,440
Now we're gonna create
forwarding rules instead.

902
00:40:22,440 --> 00:40:23,670
And these forwarding rules will point

903
00:40:23,670 --> 00:40:25,020
to our on-premises data center,

904
00:40:25,020 --> 00:40:27,483
in this case, for corp.example.com.

905
00:40:28,590 --> 00:40:29,610
We'll take those forwarding rules.

906
00:40:29,610 --> 00:40:31,860
We could also choose
to delegate if we want,

907
00:40:31,860 --> 00:40:34,860
and we'll associate them with our VPC.

908
00:40:34,860 --> 00:40:36,870
Once we do that, we can
again optionally choose

909
00:40:36,870 --> 00:40:38,040
to encrypt those queries.

910
00:40:38,040 --> 00:40:40,890
So from a flow perspective,
it'll look something like this.

911
00:40:40,890 --> 00:40:44,463
We'll query, in this case,
for bar.corp.example.com.

912
00:40:45,570 --> 00:40:47,340
We'll see that we have
that forwarding rule

913
00:40:47,340 --> 00:40:49,650
associated with our VPC.

914
00:40:49,650 --> 00:40:51,990
And then that'll send it to
the outbound resolver endpoint,

915
00:40:51,990 --> 00:40:54,843
and then to our DNS server
on-premises for resolution.

916
00:40:57,150 --> 00:40:58,530
There's a lot of associations here,

917
00:40:58,530 --> 00:40:59,730
there's a lot of constructs here,

918
00:40:59,730 --> 00:41:00,930
there's a lot of resources.

919
00:41:00,930 --> 00:41:02,730
How do we manage all of this at scale,

920
00:41:02,730 --> 00:41:04,770
especially if you're operating
in a large environment

921
00:41:04,770 --> 00:41:06,990
where you've got a lot of VPCs?

922
00:41:06,990 --> 00:41:09,540
So for that, you can take all of these,

923
00:41:09,540 --> 00:41:12,210
and put them into what's
called a Route 53 profile.

924
00:41:12,210 --> 00:41:14,490
We actually just added support
for resolver query logging

925
00:41:14,490 --> 00:41:16,110
like you can see there.

926
00:41:16,110 --> 00:41:18,270
Once you do that, instead
of having to manage

927
00:41:18,270 --> 00:41:21,390
each of these separately, you
can take this one profile,

928
00:41:21,390 --> 00:41:23,250
and associate it with many VPCs,

929
00:41:23,250 --> 00:41:25,410
either within your same account,

930
00:41:25,410 --> 00:41:29,250
or across multiple accounts
using Resource Access Manager,

931
00:41:29,250 --> 00:41:30,360
giving you that, you know,

932
00:41:30,360 --> 00:41:33,063
complete multi-account view of your DNS.

933
00:41:36,330 --> 00:41:38,250
So we talked about DNS Firewall.

934
00:41:38,250 --> 00:41:39,510
And earlier, Rohit was talking about

935
00:41:39,510 --> 00:41:41,070
some of the basic security concepts.

936
00:41:41,070 --> 00:41:42,900
But when we think about
our environment too,

937
00:41:42,900 --> 00:41:44,400
we'll probably want to think about

938
00:41:44,400 --> 00:41:46,350
adding a firewall in somewhere.

939
00:41:46,350 --> 00:41:48,150
So there's a couple of different
places we might do that.

940
00:41:48,150 --> 00:41:50,700
We might want to add a
firewall to inspect traffic

941
00:41:50,700 --> 00:41:54,390
between VPCs, maybe between subnets,

942
00:41:54,390 --> 00:41:56,580
maybe you know, on-premises in or out,

943
00:41:56,580 --> 00:41:59,130
to or from our data center,
or out to the internet.

944
00:42:00,150 --> 00:42:03,600
Now with the internet, let's
use that as an example.

945
00:42:03,600 --> 00:42:05,370
It would probably look
something like this.

946
00:42:05,370 --> 00:42:08,070
I've got a workload in a private subnet.

947
00:42:08,070 --> 00:42:10,590
I've got a NAT gateway in a public subnet.

948
00:42:10,590 --> 00:42:12,330
And ideally, I wanna place my firewall

949
00:42:12,330 --> 00:42:13,560
right in the middle there,

950
00:42:13,560 --> 00:42:15,990
in some kind of an inspection subnet.

951
00:42:15,990 --> 00:42:18,300
Now there's two approaches we can take

952
00:42:18,300 --> 00:42:20,220
depending upon what we want to use

953
00:42:20,220 --> 00:42:22,680
to actually do that traffic inspection.

954
00:42:22,680 --> 00:42:24,393
So to get things started,

955
00:42:25,230 --> 00:42:28,080
if you're using third-party
firewall appliances,

956
00:42:28,080 --> 00:42:30,120
you could use AWS Gateway Load Balancer.

957
00:42:30,120 --> 00:42:32,970
So Rohit talked about two
types of load balancer earlier.

958
00:42:32,970 --> 00:42:35,610
This is a third one, but
this is specifically designed

959
00:42:35,610 --> 00:42:39,990
for third-party appliances to
provide native load balancing.

960
00:42:39,990 --> 00:42:40,823
How it works?

961
00:42:40,823 --> 00:42:43,650
We've got our load balancer,
we'll take our firewalls,

962
00:42:43,650 --> 00:42:45,990
and we will create them
and define them as targets

963
00:42:45,990 --> 00:42:47,540
for this gateway load balancer.

964
00:42:48,660 --> 00:42:50,820
And then we'll use an endpoint
powered by PrivateLink,

965
00:42:50,820 --> 00:42:52,200
a gateway load balancer endpoint,

966
00:42:52,200 --> 00:42:54,750
and this will give us
bump-in-the-wire traffic inspection.

967
00:42:54,750 --> 00:42:56,130
It's transparent to the source,

968
00:42:56,130 --> 00:42:57,480
it's transparent to the target.

969
00:42:57,480 --> 00:43:00,180
We're using route tables to
steer traffic to that endpoint,

970
00:43:00,180 --> 00:43:01,890
to the gateway load balancer.

971
00:43:01,890 --> 00:43:03,720
Load balancers will do what
load balancers do best.

972
00:43:03,720 --> 00:43:06,300
They'll send it to the
targets, if that's allowed,

973
00:43:06,300 --> 00:43:08,580
a traffic will return to
the gateway load balancer,

974
00:43:08,580 --> 00:43:11,430
back to the endpoint, and then
route out to the internet.

975
00:43:12,660 --> 00:43:15,180
Now the consideration here is that

976
00:43:15,180 --> 00:43:17,520
even though we're using native
load balancing capabilities,

977
00:43:17,520 --> 00:43:18,660
we still have to manage

978
00:43:18,660 --> 00:43:21,120
these firewall appliances themselves.

979
00:43:21,120 --> 00:43:23,040
If we don't want to do that,

980
00:43:23,040 --> 00:43:25,590
instead, we could use
AWS Network Firewall.

981
00:43:25,590 --> 00:43:26,610
And with Network Firewall,

982
00:43:26,610 --> 00:43:30,000
this is a fully-managed
native firewall service

983
00:43:30,000 --> 00:43:32,580
that gives us the same basic capabilities

984
00:43:32,580 --> 00:43:33,810
where we can allow and block traffic,

985
00:43:33,810 --> 00:43:35,430
we could do logging, things like that.

986
00:43:35,430 --> 00:43:37,800
But it gives us all these
additional capabilities as well,

987
00:43:37,800 --> 00:43:39,840
including some recently launched features,

988
00:43:39,840 --> 00:43:41,760
like Managed Rules from AWS Partners,

989
00:43:41,760 --> 00:43:44,700
and a Managed Proxy, which
is currently in preview.

990
00:43:44,700 --> 00:43:47,550
Architecturally, this is going
to look exactly the same way.

991
00:43:47,550 --> 00:43:49,590
Instead of a gateway
load balancer endpoint,

992
00:43:49,590 --> 00:43:51,450
we have a firewall endpoint.

993
00:43:51,450 --> 00:43:53,310
We'll route our traffic
to the firewall endpoint,

994
00:43:53,310 --> 00:43:57,060
which we'll pass it to
our firewall service.

995
00:43:57,060 --> 00:43:58,380
That traffic is allowed through,

996
00:43:58,380 --> 00:43:59,610
it'll return to that endpoint,

997
00:43:59,610 --> 00:44:01,830
and then go out to the internet.

998
00:44:01,830 --> 00:44:05,640
Now the key takeaway here,
regardless of which one you use,

999
00:44:05,640 --> 00:44:08,400
is that both gateway load
balancer and the appliances,

1000
00:44:08,400 --> 00:44:09,720
and Network Firewall will support

1001
00:44:09,720 --> 00:44:11,973
the same inspection architectures.

1002
00:44:12,960 --> 00:44:15,293
What do I mean by inspection
architectures here?

1003
00:44:17,010 --> 00:44:20,070
Well, here's an example using
that one we were looking at,

1004
00:44:20,070 --> 00:44:21,780
that's an example of a distributed model,

1005
00:44:21,780 --> 00:44:24,180
where we have an endpoint in the VPC

1006
00:44:24,180 --> 00:44:26,580
that's doing the actual
inspection right there.

1007
00:44:26,580 --> 00:44:28,260
And we could do that for
on-premises in or out

1008
00:44:28,260 --> 00:44:30,600
if we're connecting directly to a VPC.

1009
00:44:30,600 --> 00:44:33,350
And we could also use that
for traffic between subnets.

1010
00:44:34,710 --> 00:44:35,790
But we didn't really talk about

1011
00:44:35,790 --> 00:44:39,390
how to do traffic
inspection between VPCs yet.

1012
00:44:39,390 --> 00:44:41,850
So for that, we're gonna need
a different type of model,

1013
00:44:41,850 --> 00:44:44,100
and this is gonna be a
centralized inspection model.

1014
00:44:44,100 --> 00:44:46,890
And this is going to use
either AWS Transit Gateway

1015
00:44:46,890 --> 00:44:48,780
or AWS Cloud WAN.

1016
00:44:48,780 --> 00:44:50,040
And once we start to think about

1017
00:44:50,040 --> 00:44:51,600
centralizing our inspection,

1018
00:44:51,600 --> 00:44:55,950
well, we can centralize
our on-premises inspection,

1019
00:44:55,950 --> 00:44:58,890
as well as centralizing
our internet ingress

1020
00:44:58,890 --> 00:45:01,203
or our internet egress as well.

1021
00:45:02,700 --> 00:45:04,100
Let me show you what I mean.

1022
00:45:05,190 --> 00:45:08,040
So taking Transit Gateway as an example,

1023
00:45:08,040 --> 00:45:11,220
I've got some VPCs connected
to my Transit Gateway.

1024
00:45:11,220 --> 00:45:13,860
I can choose one of two
approaches with Transit Gateway.

1025
00:45:13,860 --> 00:45:16,740
Either can create a
dedicated inspection VPC

1026
00:45:16,740 --> 00:45:18,690
that has the firewall endpoint in it.

1027
00:45:18,690 --> 00:45:20,700
And if I do that, I do wanna
configure appliance mode

1028
00:45:20,700 --> 00:45:22,650
to make sure my traffic is symmetrical.

1029
00:45:23,490 --> 00:45:25,650
Or with Transit Gateway,
you have the ability

1030
00:45:25,650 --> 00:45:28,530
to create an AWS Network
Firewall native attachment,

1031
00:45:28,530 --> 00:45:30,270
and that will basically
remove the need for you

1032
00:45:30,270 --> 00:45:32,343
to create that inspection VPC.

1033
00:45:33,240 --> 00:45:35,160
I'm gonna use the Network
Firewall attachment for this,

1034
00:45:35,160 --> 00:45:37,500
but you could do the same thing here.

1035
00:45:37,500 --> 00:45:40,170
With the inspection VPC, functionally,

1036
00:45:40,170 --> 00:45:42,210
from the VPC's perspective,
you route traffic

1037
00:45:42,210 --> 00:45:44,640
to the Transit Gateway, the
Transit Gateway passes it

1038
00:45:44,640 --> 00:45:46,440
to the Network Firewall attachment,

1039
00:45:46,440 --> 00:45:47,880
the Network Firewall attachment returns it

1040
00:45:47,880 --> 00:45:49,260
to the Transit Gateway if it's, you know,

1041
00:45:49,260 --> 00:45:50,850
been inspected and allowed through,

1042
00:45:50,850 --> 00:45:53,343
and then routed back
to the destination VPC.

1043
00:45:55,230 --> 00:45:56,520
For on-premises, again,

1044
00:45:56,520 --> 00:45:58,980
assuming we've got some kind
of private connectivity here,

1045
00:45:58,980 --> 00:46:01,350
the flow is going to look very similar.

1046
00:46:01,350 --> 00:46:04,860
Instead of sending it back
to the destination VPC now,

1047
00:46:04,860 --> 00:46:07,080
we're gonna send it to our
on-premises data center.

1048
00:46:07,080 --> 00:46:08,340
From the VPC's perspective,

1049
00:46:08,340 --> 00:46:09,777
it still has that route
to the Transit Gateway,

1050
00:46:09,777 --> 00:46:12,377
and the Transit Gateway
handles that routing for us.

1051
00:46:14,130 --> 00:46:16,380
Now, internet egress is
a little bit different.

1052
00:46:16,380 --> 00:46:17,670
This is my personal opinion here.

1053
00:46:17,670 --> 00:46:19,770
You could go through the
Network Firewall attachment,

1054
00:46:19,770 --> 00:46:22,920
and then go through, you know,
a centralized egress VPC.

1055
00:46:22,920 --> 00:46:25,230
I think it's a little easier to do this.

1056
00:46:25,230 --> 00:46:27,060
So we'll take our inspection VPC,

1057
00:46:27,060 --> 00:46:28,290
and we'll add a NAT gateway,

1058
00:46:28,290 --> 00:46:29,340
and we'll add an internet gateway,

1059
00:46:29,340 --> 00:46:32,460
so we have a path out to the internet.

1060
00:46:32,460 --> 00:46:35,700
Once we do that, now our
VPCs can send traffic

1061
00:46:35,700 --> 00:46:37,500
to the Transit Gateway
like they did before,

1062
00:46:37,500 --> 00:46:39,180
but instead of having to go

1063
00:46:39,180 --> 00:46:40,680
through the Transit Gateway twice,

1064
00:46:40,680 --> 00:46:44,403
we inspect and we egress in the same VPC.

1065
00:46:46,380 --> 00:46:47,430
Now, that was with Transit Gateway.

1066
00:46:47,430 --> 00:46:50,340
Cloud WAN is pretty much the same thing.

1067
00:46:50,340 --> 00:46:52,353
So with Cloud WAN, earlier
we talked about how,

1068
00:46:52,353 --> 00:46:54,300
you know, you can have
different segments there,

1069
00:46:54,300 --> 00:46:57,870
we'll attach our VPCs and our
connectivity to our segments.

1070
00:46:57,870 --> 00:46:58,800
And then we'll create what's called

1071
00:46:58,800 --> 00:47:00,030
a network function group.

1072
00:47:00,030 --> 00:47:02,730
And this is a special kind of
segment specifically designed

1073
00:47:02,730 --> 00:47:06,570
to manage the routing for these
firewall appliances for us.

1074
00:47:06,570 --> 00:47:08,550
And we'll attach that inspection VPC

1075
00:47:08,550 --> 00:47:10,200
to the Cloud WAN network function group.

1076
00:47:10,200 --> 00:47:12,800
We don't have the native
attachment available today.

1077
00:47:13,680 --> 00:47:15,420
But from a flow perspective,

1078
00:47:15,420 --> 00:47:16,980
it's gonna look largely the same.

1079
00:47:16,980 --> 00:47:18,960
So again, we send our
traffic, in this case,

1080
00:47:18,960 --> 00:47:20,760
to our Cloud WAN core network.

1081
00:47:20,760 --> 00:47:22,740
That core network rides
it to the inspection VPC,

1082
00:47:22,740 --> 00:47:24,330
gets inspected by that endpoint,

1083
00:47:24,330 --> 00:47:26,220
returns back to the core network,

1084
00:47:26,220 --> 00:47:28,270
and then rides it to the destination VPC.

1085
00:47:29,460 --> 00:47:31,470
For on-premises, same thing,

1086
00:47:31,470 --> 00:47:33,300
we're gonna go through our core network,

1087
00:47:33,300 --> 00:47:36,000
the inspection endpoint takes
care of the inspection for us,

1088
00:47:36,000 --> 00:47:39,390
and then routes it back to
our on-premises data center.

1089
00:47:39,390 --> 00:47:42,720
Then finally, for internet
egress, same content applies.

1090
00:47:42,720 --> 00:47:44,910
We're gonna use that same inspection VPC

1091
00:47:44,910 --> 00:47:47,280
where we're inspecting and we're egressing

1092
00:47:47,280 --> 00:47:49,620
all in the same VPC.

1093
00:47:49,620 --> 00:47:53,400
So the takeaway here is whether
you are using AWS Cloud WAN

1094
00:47:53,400 --> 00:47:55,620
or Transit Gateway, whether
you use third-party appliances,

1095
00:47:55,620 --> 00:47:58,140
whether you use, you know,
AWS Network Firewall,

1096
00:47:58,140 --> 00:48:00,000
these concepts will apply the same,

1097
00:48:00,000 --> 00:48:02,220
giving you that flexibility that you want

1098
00:48:02,220 --> 00:48:03,620
for this kind of inspection.

1099
00:48:05,820 --> 00:48:07,680
Let's take a quick moment to detour about

1100
00:48:07,680 --> 00:48:09,183
and talk about remote access.

1101
00:48:10,500 --> 00:48:13,080
Earlier, we talked about this
idea of accessing networks

1102
00:48:13,080 --> 00:48:14,760
versus applications and resources.

1103
00:48:14,760 --> 00:48:16,560
And the same concept applies here

1104
00:48:16,560 --> 00:48:18,360
when we talk about remote access.

1105
00:48:18,360 --> 00:48:21,600
So for network access, you
could use AWS Client VPN.

1106
00:48:21,600 --> 00:48:23,970
This is a fully-managed
remote VPN solution.

1107
00:48:23,970 --> 00:48:25,680
It'll automatically scale up or down

1108
00:48:25,680 --> 00:48:28,830
based on how much you use it,
how many users are connecting.

1109
00:48:28,830 --> 00:48:30,420
And how this works,

1110
00:48:30,420 --> 00:48:32,250
you can define multiple
authentication options,

1111
00:48:32,250 --> 00:48:34,320
including certificate based off.

1112
00:48:34,320 --> 00:48:35,220
And then once you do that,

1113
00:48:35,220 --> 00:48:37,050
you can create authorization rules.

1114
00:48:37,050 --> 00:48:40,440
And these rules will allow you
access to specific networks

1115
00:48:40,440 --> 00:48:42,300
based off of the
authentication information

1116
00:48:42,300 --> 00:48:44,100
that the VPN receives.

1117
00:48:44,100 --> 00:48:46,200
You'll notice here, in this
case, I'm connecting, you know,

1118
00:48:46,200 --> 00:48:47,210
this engineering group can connect

1119
00:48:47,210 --> 00:48:48,710
to this particular CIDR block.

1120
00:48:50,340 --> 00:48:51,540
Once I do that, I can configure

1121
00:48:51,540 --> 00:48:53,040
other things like connection logging,

1122
00:48:53,040 --> 00:48:55,980
client route enforcement
to prevent route leaks.

1123
00:48:55,980 --> 00:48:58,980
And then from the target
side, couple things here.

1124
00:48:58,980 --> 00:49:03,960
First, my clients can be
v4, v6, or dual-stack.

1125
00:49:03,960 --> 00:49:06,900
And my targets can be
v4, v6, or dual-stack.

1126
00:49:06,900 --> 00:49:10,020
And in addition to accessing
resources in that one VPC,

1127
00:49:10,020 --> 00:49:12,210
I can also connect to resources

1128
00:49:12,210 --> 00:49:15,060
in that same VPC or outside of that VPC.

1129
00:49:15,060 --> 00:49:16,440
Again, as long as I've got some kind

1130
00:49:16,440 --> 00:49:18,483
of a routable path to those.

1131
00:49:20,010 --> 00:49:22,230
Now what if I don't
want access to networks,

1132
00:49:22,230 --> 00:49:23,640
but I want that different approach

1133
00:49:23,640 --> 00:49:26,340
where it's more that application
networking-based approach?

1134
00:49:26,340 --> 00:49:28,620
Well, for that, I could
use verified access.

1135
00:49:28,620 --> 00:49:29,820
And with verified access,

1136
00:49:29,820 --> 00:49:32,250
again, similar to what
we saw with VPC Lattice,

1137
00:49:32,250 --> 00:49:35,130
we're providing access to
applications and resources

1138
00:49:35,130 --> 00:49:38,070
without requiring a full VPN connection.

1139
00:49:38,070 --> 00:49:40,620
And we can add additional
group and app-level policies

1140
00:49:40,620 --> 00:49:41,770
on top of that as well.

1141
00:49:43,140 --> 00:49:45,960
This will support HTTP
and HTTPS applications,

1142
00:49:45,960 --> 00:49:47,220
and TCP resources.

1143
00:49:47,220 --> 00:49:50,020
Again, very similar to what
we saw with Lattice earlier.

1144
00:49:52,170 --> 00:49:55,350
Now for the first one,
HTTP/HTTPS applications,

1145
00:49:55,350 --> 00:49:58,410
we'll configure verified
access with trust providers.

1146
00:49:58,410 --> 00:49:59,430
And these trust providers

1147
00:49:59,430 --> 00:50:01,710
will include not only
identity information,

1148
00:50:01,710 --> 00:50:03,750
but we can also use device information.

1149
00:50:03,750 --> 00:50:05,400
So is my laptop up to date?

1150
00:50:05,400 --> 00:50:07,260
Do I have all of the
right security patches?

1151
00:50:07,260 --> 00:50:08,093
Things like that.

1152
00:50:08,093 --> 00:50:10,290
Do I have any software
that shouldn't be on there?

1153
00:50:10,290 --> 00:50:12,000
I can configure all of that.

1154
00:50:12,000 --> 00:50:13,680
And then based off of that information

1155
00:50:13,680 --> 00:50:16,620
from those trust providers,
I can now craft policies,

1156
00:50:16,620 --> 00:50:18,750
and I can do these policies per group,

1157
00:50:18,750 --> 00:50:21,573
or I can do them per
application or per endpoint,

1158
00:50:22,620 --> 00:50:24,090
configure access logging.

1159
00:50:24,090 --> 00:50:25,770
And because these are
layer seven constructs,

1160
00:50:25,770 --> 00:50:27,180
I can also choose to optionally

1161
00:50:27,180 --> 00:50:30,303
integrate AWS Web
Application Firewall as well.

1162
00:50:32,040 --> 00:50:33,090
From a target perspective,

1163
00:50:33,090 --> 00:50:35,730
I can connect to Elastic
Network Interfaces

1164
00:50:35,730 --> 00:50:39,030
you know, attached to an EC2
instance, or load balancers.

1165
00:50:39,030 --> 00:50:41,700
These do need to be
private load balancers.

1166
00:50:41,700 --> 00:50:42,600
And then once I do that,

1167
00:50:42,600 --> 00:50:44,730
I can define those per
app policies as well.

1168
00:50:44,730 --> 00:50:46,980
So remember, thinking back
to what we saw with Lattice,

1169
00:50:46,980 --> 00:50:50,400
the same concept apply here,
broad at the group level,

1170
00:50:50,400 --> 00:50:53,580
and more granular at the
individual application level.

1171
00:50:53,580 --> 00:50:55,860
And that will allow me to
provide that connectivity,

1172
00:50:55,860 --> 00:50:58,860
and those policies will then
be used by verified access

1173
00:50:58,860 --> 00:51:01,803
to provide that continuous
authentication in real time.

1174
00:51:03,900 --> 00:51:06,840
TCP resources are gonna be
pretty much the same thing.

1175
00:51:06,840 --> 00:51:09,030
Only in this case, instead
of using HTTP/HTTPS,

1176
00:51:09,030 --> 00:51:13,020
we're connecting to
services via TCP, SSH, RDP,

1177
00:51:13,020 --> 00:51:13,870
things like that.

1178
00:51:14,910 --> 00:51:16,020
My targets will be the same,

1179
00:51:16,020 --> 00:51:18,540
I can apply resource
policies on those as well,

1180
00:51:18,540 --> 00:51:20,430
but I've got now the ability to connect it

1181
00:51:20,430 --> 00:51:21,960
to additional resource types.

1182
00:51:21,960 --> 00:51:23,610
One is gonna be an RDS database,

1183
00:51:23,610 --> 00:51:26,880
which I could connect to
directly, or a network CIDR.

1184
00:51:26,880 --> 00:51:28,950
And a network CIDR is
gonna be super useful

1185
00:51:28,950 --> 00:51:31,350
if I have auto-scaling
resources that, you know,

1186
00:51:31,350 --> 00:51:33,540
are very ephemeral, they
scale up, they scale down.

1187
00:51:33,540 --> 00:51:36,030
I don't wanna have to manage
connectivity to all of those.

1188
00:51:36,030 --> 00:51:37,230
Verified access will make it,

1189
00:51:37,230 --> 00:51:38,850
so I don't have to manage that.

1190
00:51:38,850 --> 00:51:40,650
I can just connect into each one of those

1191
00:51:40,650 --> 00:51:41,760
as they appear and disappear,

1192
00:51:41,760 --> 00:51:44,730
it'll take care of that
for me automatically.

1193
00:51:44,730 --> 00:51:47,550
Ultimately, I can use the same construct

1194
00:51:47,550 --> 00:51:49,200
to access both of these,

1195
00:51:49,200 --> 00:51:52,560
whether it's HTTP,
HTTPS, or TCP resources.

1196
00:51:56,115 --> 00:51:58,950
Okay, now we've covered quite a bit here.

1197
00:51:58,950 --> 00:52:00,600
How do we have an understanding of this?

1198
00:52:00,600 --> 00:52:01,433
How do we reason about all of this,

1199
00:52:01,433 --> 00:52:03,483
you know, these network constructs?

1200
00:52:04,350 --> 00:52:06,450
Well, the first is, and
Rohit mentioned this earlier,

1201
00:52:06,450 --> 00:52:07,770
so I wanted to make
sure we came back to it.

1202
00:52:07,770 --> 00:52:09,690
First is flow logs.

1203
00:52:09,690 --> 00:52:12,900
Now flow logs, you can
apply them at a VPC,

1204
00:52:12,900 --> 00:52:16,200
at a subnet within a VPC,
or at a network interface,

1205
00:52:16,200 --> 00:52:18,270
as well as on a Transit Gateway.

1206
00:52:18,270 --> 00:52:20,340
And this will give you
flow-level visibility,

1207
00:52:20,340 --> 00:52:22,170
essentially metadata about your flows.

1208
00:52:22,170 --> 00:52:24,060
This is not a packet capture.

1209
00:52:24,060 --> 00:52:27,510
This is metadata about
those specific flows.

1210
00:52:27,510 --> 00:52:29,520
So include things like
source and destination,

1211
00:52:29,520 --> 00:52:32,460
port, protocol, bytes,
and then any actions taken

1212
00:52:32,460 --> 00:52:35,670
as a result of Network
ACLs and security groups.

1213
00:52:35,670 --> 00:52:37,170
And then all of that will get emitted

1214
00:52:37,170 --> 00:52:40,170
into our logging destinations,
Amazon CloudWatch Logs, S3,

1215
00:52:40,170 --> 00:52:41,373
or Data Firehose.

1216
00:52:42,480 --> 00:52:44,820
We've also sticking with Transit Gateway,

1217
00:52:44,820 --> 00:52:47,400
we can register our Transit
Gateways in Network Manager,

1218
00:52:47,400 --> 00:52:49,350
or if we're using AWS Cloud WAN,

1219
00:52:49,350 --> 00:52:51,780
we can use Network Manager to
get some additional metrics

1220
00:52:51,780 --> 00:52:54,180
and events from these two services.

1221
00:52:54,180 --> 00:52:56,040
And this will include things
like topology changes,

1222
00:52:56,040 --> 00:52:57,930
so as we add or remove attachments,

1223
00:52:57,930 --> 00:53:00,450
routing updates, as routes
are added or removed.

1224
00:53:00,450 --> 00:53:02,970
And for SD-WAN and VPN,
any status updates,

1225
00:53:02,970 --> 00:53:04,770
so if they go up or down.

1226
00:53:04,770 --> 00:53:05,790
All of those will get admitted

1227
00:53:05,790 --> 00:53:08,190
into the same logging
destinations as flow logs.

1228
00:53:12,090 --> 00:53:14,190
Network Manager also is
gonna give us visibility

1229
00:53:14,190 --> 00:53:15,900
into infrastructure performance,

1230
00:53:15,900 --> 00:53:18,930
and these are metrics
that we at AWS publish

1231
00:53:18,930 --> 00:53:20,940
that give you insight into network latency

1232
00:53:20,940 --> 00:53:23,373
and performance between regions,

1233
00:53:24,300 --> 00:53:26,640
between Availability
Zones within a region,

1234
00:53:26,640 --> 00:53:28,380
or within an Availability Zone.

1235
00:53:28,380 --> 00:53:30,630
So think back to that
graphic we saw earlier

1236
00:53:30,630 --> 00:53:31,560
where an Availability Zone

1237
00:53:31,560 --> 00:53:33,060
consists of multiple data centers.

1238
00:53:33,060 --> 00:53:35,160
This gives you that visibility.

1239
00:53:35,160 --> 00:53:36,960
Now these metrics will be
available in the console,

1240
00:53:36,960 --> 00:53:38,940
but there you can also publish them

1241
00:53:38,940 --> 00:53:40,890
to a CloudWatch subscription,

1242
00:53:40,890 --> 00:53:43,680
and then action off of those accordingly.

1243
00:53:43,680 --> 00:53:45,150
Now speaking of CloudWatch,

1244
00:53:45,150 --> 00:53:47,820
CloudWatch has a number of
tools that we can use here.

1245
00:53:47,820 --> 00:53:49,140
So for starters, let's say I've got

1246
00:53:49,140 --> 00:53:50,743
some public internet resources,

1247
00:53:50,743 --> 00:53:52,590
a CloudFront distribution, WorkSpaces,

1248
00:53:52,590 --> 00:53:54,003
a public-facing VPC.

1249
00:53:54,960 --> 00:53:56,790
I've got users who are accessing that.

1250
00:53:56,790 --> 00:53:59,430
I wanna understand what's
impacting their connectivity

1251
00:53:59,430 --> 00:54:01,290
to those resources.

1252
00:54:01,290 --> 00:54:04,530
For that, I could use Amazon
CloudWatch Internet Monitor,

1253
00:54:04,530 --> 00:54:06,960
and this is going to give
me internet performance

1254
00:54:06,960 --> 00:54:11,040
and availability metrics
by ISP and location.

1255
00:54:11,040 --> 00:54:13,590
So functionally, it'll give
me something like this,

1256
00:54:13,590 --> 00:54:15,420
a map of the internet weather

1257
00:54:15,420 --> 00:54:18,573
that would be affecting
connectivity to my applications.

1258
00:54:20,490 --> 00:54:21,840
Now that's for the internet.

1259
00:54:21,840 --> 00:54:24,240
What about hybrid connectivity
to my data center?

1260
00:54:24,240 --> 00:54:27,570
So for that, we can use
Network Synthetic Monitor.

1261
00:54:27,570 --> 00:54:29,640
And this will give us metrics
like a round trip time

1262
00:54:29,640 --> 00:54:31,680
and packet loss for
either Site-to-site VPN

1263
00:54:31,680 --> 00:54:33,120
or Direct Connect.

1264
00:54:33,120 --> 00:54:35,700
So in this example here,
I'm using Direct Connect.

1265
00:54:35,700 --> 00:54:39,330
I'll set up probes in these
VPCs, in this source subnet.

1266
00:54:39,330 --> 00:54:41,520
And as part of that configuration,

1267
00:54:41,520 --> 00:54:43,590
I'll specify the type
of probe that I want.

1268
00:54:43,590 --> 00:54:46,710
I can do TCP or ICMP, and I
can also specify, you know,

1269
00:54:46,710 --> 00:54:49,110
the port and packet size for TCP.

1270
00:54:49,110 --> 00:54:51,300
And then I can specify an IPv4

1271
00:54:51,300 --> 00:54:54,480
or an IPv6 destination on-premises.

1272
00:54:54,480 --> 00:54:56,940
And this will give me that
round trip time and packet loss.

1273
00:54:56,940 --> 00:54:57,960
And for Direct Connect,

1274
00:54:57,960 --> 00:55:01,380
this will also include a
network health indicator metric,

1275
00:55:01,380 --> 00:55:03,030
which is a probabilistic value,

1276
00:55:03,030 --> 00:55:04,470
and that will give you some insight

1277
00:55:04,470 --> 00:55:06,150
as to whether that network degradation

1278
00:55:06,150 --> 00:55:08,973
is within AWS or external to AWS.

1279
00:55:10,950 --> 00:55:12,150
Sticking with CloudWatch,

1280
00:55:12,150 --> 00:55:14,070
we've also got Network Flow Monitor,

1281
00:55:14,070 --> 00:55:17,250
and this is designed
for traffic within AWS.

1282
00:55:17,250 --> 00:55:19,650
And this will give you performance
and availability metrics

1283
00:55:19,650 --> 00:55:21,130
about specific network flows

1284
00:55:21,990 --> 00:55:24,540
by installing agents
either on EC2 instances,

1285
00:55:24,540 --> 00:55:27,660
or you can also apply this
onto your EKS clusters.

1286
00:55:27,660 --> 00:55:31,140
Once you do that, you'll
specify local remote resources,

1287
00:55:31,140 --> 00:55:33,090
and this could be any of
the resources you see here,

1288
00:55:33,090 --> 00:55:35,250
a region, a VPC, an Availability Zone,

1289
00:55:35,250 --> 00:55:37,650
a subnet within a VPC.

1290
00:55:37,650 --> 00:55:39,060
It could be a remote region.

1291
00:55:39,060 --> 00:55:40,560
And it could also be AWS services

1292
00:55:40,560 --> 00:55:42,750
like DynamoDB and Amazon S3.

1293
00:55:42,750 --> 00:55:44,319
And this will give you TCP metrics

1294
00:55:44,319 --> 00:55:45,750
and network health indicator

1295
00:55:45,750 --> 00:55:48,390
just like we had with
Direct Connect a moment ago,

1296
00:55:48,390 --> 00:55:49,560
as well as bytes transfer.

1297
00:55:49,560 --> 00:55:51,610
So you can see what that flow looks like.

1298
00:55:54,630 --> 00:55:56,283
Now what about troubleshooting?

1299
00:55:57,360 --> 00:55:59,280
We've got a lot of
components in here, right?

1300
00:55:59,280 --> 00:56:01,260
So if we even just take this example here

1301
00:56:01,260 --> 00:56:02,280
where we've got a load balancer,

1302
00:56:02,280 --> 00:56:06,300
targeting an Elastic Network
Interface, and a VPC.

1303
00:56:06,300 --> 00:56:07,770
Well, there's a lot of things

1304
00:56:07,770 --> 00:56:09,360
that could go wrong in the path, right?

1305
00:56:09,360 --> 00:56:11,340
There's route tables,
there's security groups,

1306
00:56:11,340 --> 00:56:13,200
there's those Network ACLs.

1307
00:56:13,200 --> 00:56:15,210
So if we wanna troubleshoot this,

1308
00:56:15,210 --> 00:56:16,470
this is where we could use a tool

1309
00:56:16,470 --> 00:56:18,870
called VPC Reachability Analyzer.

1310
00:56:18,870 --> 00:56:22,410
And this gives you hop-by-hop
visibility of the path

1311
00:56:22,410 --> 00:56:26,130
between a source and a
destination that you specify.

1312
00:56:26,130 --> 00:56:28,290
And crucially, it'll also tell you

1313
00:56:28,290 --> 00:56:29,640
if there's anything in the path

1314
00:56:29,640 --> 00:56:31,230
that is blocking connectivity

1315
00:56:31,230 --> 00:56:32,910
from that source to the destination.

1316
00:56:32,910 --> 00:56:34,830
In this case, it's a security group

1317
00:56:34,830 --> 00:56:36,060
on my Application Load Balancer

1318
00:56:36,060 --> 00:56:38,730
that's not allowing that traffic through.

1319
00:56:38,730 --> 00:56:40,800
So in addition to load balancers,

1320
00:56:40,800 --> 00:56:42,570
Reachability Analyzer
supports all of these

1321
00:56:42,570 --> 00:56:44,490
intermediary components
like Network Firewall,

1322
00:56:44,490 --> 00:56:46,620
Transit Gateways, peering connections.

1323
00:56:46,620 --> 00:56:49,800
And ultimately, this is gonna
be the best tool in your,

1324
00:56:49,800 --> 00:56:52,170
you know, sort of tool bag here

1325
00:56:52,170 --> 00:56:53,790
for fine grain troubleshooting

1326
00:56:53,790 --> 00:56:56,440
if you've got a specific
case you're trying to solve.

1327
00:56:57,390 --> 00:56:59,250
Stepping back a little bit more,

1328
00:56:59,250 --> 00:57:03,006
if you want to understand if
there are any unintended paths

1329
00:57:03,006 --> 00:57:07,080
to access your network, you can
use Network Access Analyzer.

1330
00:57:07,080 --> 00:57:09,000
And with that, you define what are called

1331
00:57:09,000 --> 00:57:10,871
Network Access Scopes.

1332
00:57:10,871 --> 00:57:14,310
Examples here, maybe you turned
on VPC Block Public Access.

1333
00:57:14,310 --> 00:57:16,140
You want to understand the impact of that,

1334
00:57:16,140 --> 00:57:17,520
or you want your instances

1335
00:57:17,520 --> 00:57:19,380
to only be reachable via a load balancer,

1336
00:57:19,380 --> 00:57:21,900
but not publicly facing any other way.

1337
00:57:21,900 --> 00:57:23,610
So you define this intent,

1338
00:57:23,610 --> 00:57:25,920
and the Network Access
Analyzer takes that intent

1339
00:57:25,920 --> 00:57:27,750
and uses automated reasoning

1340
00:57:27,750 --> 00:57:30,450
to determine whether
there are any unintended

1341
00:57:30,450 --> 00:57:32,010
or non-compliant paths

1342
00:57:32,010 --> 00:57:35,580
that don't line up with that access scope.

1343
00:57:35,580 --> 00:57:38,340
So this is gonna be best
for that broad evaluation

1344
00:57:38,340 --> 00:57:40,383
within an account or within a region.

1345
00:57:43,440 --> 00:57:45,540
Okay, we're just about at time here,

1346
00:57:45,540 --> 00:57:48,300
and we have covered a
lot in the last hour.

1347
00:57:48,300 --> 00:57:50,430
We could easily have spent a whole hour

1348
00:57:50,430 --> 00:57:52,410
on each one of these topics.

1349
00:57:52,410 --> 00:57:56,310
But fortunately, there are
a whole bunch of sessions

1350
00:57:56,310 --> 00:57:57,570
that are running this week.

1351
00:57:57,570 --> 00:57:59,700
If you're catching this
later or somewhere else,

1352
00:57:59,700 --> 00:58:01,830
you might be able to catch some
of these on YouTube as well.

1353
00:58:01,830 --> 00:58:04,770
Please take a moment,
grab a photo of this.

1354
00:58:04,770 --> 00:58:06,660
These sessions are ones that Rohit

1355
00:58:06,660 --> 00:58:07,710
and I picked out specifically,

1356
00:58:07,710 --> 00:58:10,080
they dive deeper into
additional networking topics

1357
00:58:10,080 --> 00:58:13,080
that we've started and
kind of cover here today.

1358
00:58:13,080 --> 00:58:14,640
And you can find all of the information

1359
00:58:14,640 --> 00:58:16,410
that you want to find out
about these, where they are,

1360
00:58:16,410 --> 00:58:18,663
times, et cetera, in the session catalog.

1361
00:58:19,740 --> 00:58:21,180
I'll leave this up for
just another moment,

1362
00:58:21,180 --> 00:58:23,193
give folks a chance to grab a photo.

1363
00:58:26,460 --> 00:58:27,693
And with that,

1364
00:58:28,808 --> 00:58:30,750
I wanna say thank you all
so much for joining us.

1365
00:58:30,750 --> 00:58:32,460
Thank you for starting your
re:Invent week with us.

1366
00:58:32,460 --> 00:58:34,260
I hope you have a
wonderful rest of the week.

1367
00:58:34,260 --> 00:58:36,060
And if you have any
questions, we'll be around.

1368
00:58:36,060 --> 00:58:37,059
Thank you so much.

1369
00:58:37,059 --> 00:58:37,892
(audience applauding)

