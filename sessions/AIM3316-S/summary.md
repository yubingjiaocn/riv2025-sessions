# AWS re:Invent 2025 会议总结：长周期编码代理（Long Horizon Coding Agents）

## 会议概述

本次由 Anthropic 技术团队成员 Alex 和 Nadine 主讲的技术分享会，重点介绍了他们在长周期编码代理（Long Horizon Coding Agents）方面的最新研究成果。会议的核心主题是探讨如何让 AI 代理处理跨多个会话的复杂开发任务，同时强调人类仍然是"思考者"的角色定位。

演讲者展示了一个名为 Canopy 的项目管理工具实时开发演示，该工具在 AWS re:Invent 展会期间持续接收参会者的功能需求并由 AI 代理自动实现。整个系统部署在 AWS 基础设施上，特别是使用了 Agent Core Runtime。演讲的重点在于分享构建能够跨会话工作的代理系统的技术经验和最佳实践。

核心理念是将开发工作流程中的"无聊部分"（如编写测试、更新文档、遵循编码规范等重复性工作）交给 AI 代理处理，让人类开发者专注于架构决策、需求定义和代码审查等需要判断力的工作。演讲者特别强调，这不是要取代人类开发者，而是建立一种新的人机协作模式。

## 详细时间线与关键要点

### 开场介绍（0:00-2:30）
- **演讲者介绍**：Alex 和 Nadine，均为 Anthropic 技术团队成员
- **核心主题**：长周期编码代理的研究发现
- **两大核心教训**：
  1. 人类仍然是思考者（社会影响层面）
  2. 技术实现的经验教训

### 项目背景与演示介绍（2:30-4:00）
- **Canopy 项目**：在 AWS re:Invent 的 Anthropic 展位（Claude Keeps Building booth）进行实时演示
- **功能**：接收参会者的功能需求，由 Claude 持续迭代构建最小可行产品（MVP）
- **技术栈**：托管在 AWS 基础设施上，使用 Agent Core Runtime

### 长周期代理的定义（4:00-6:30）
- **核心概念**：教 AI 处理开发工作中的"无聊部分"
- **目标受众调查**：询问现场有多少开发者
- **重点**：分享构建跨多会话工作的代理系统的经验教训

### 开发者现实场景（6:30-9:00）
- **理想的周一计划**：更新 API 文档、编写单元测试、修复 bug、开发创新功能
- **实际情况**：
  - 15 分钟的快速同步会议变成 45 分钟的路线图辩论
  - 突发的 Sev 1 生产环境 bug
  - 47 条消息的 Slack 讨论串
  - 到下午 4:30 才真正开始写代码
- **核心问题**：AI/LLM 能否处理机械性和重复性的实现工作，让人类专注于判断性决策

### LLM 的根本局限性（9:00-12:00）
- **遗忘问题**：LLM 无法在会话之间保持持久记忆
- **表面上的缺陷**：
  - 喜欢编写测试（优点）
  - 从不抱怨更新文档（优点）
  - 严格遵循编码标准（优点）
  - 但会忘记上次工作进度（看似是缺点）
- **反直觉的发现**：遗忘实际上是一个特性而非 bug
  - 模型不会养成坏习惯
  - 不会强化错误假设
  - 能够保持更专注
- **解决方案**：通过外部方式解决记忆问题，而非依赖模型本身

### 人类与代理的对比（12:00-14:00）
- **人类恢复流程的时间**：
  - 正常情况：20 分钟才能重新进入工作流
  - 在拉斯维加斯派对后：可能需要 1 小时
- **代理的优势**：可以非常快速地恢复到工作状态
- **代理的挑战**：每个新会话开始时没有之前的记忆，需要正确的上下文才能继续工作

### 人机分工模式（14:00-17:00）
- **人类负责**：
  - 创建愿景和设计
  - 定义需求
  - 设置标准和约束
  - 做出架构决策
  - 审查模型输出
- **AI 代理负责**：
  - 实现功能
  - 遵循愿景和指导
  - 根据设定的标准进行测试
  - 持续更新文档
  - 根据反馈迭代
- **关键约束**：标准文件应该对代理只读，代理不应修改架构决策和编码风格

### 环境即记忆（17:00-21:00）
- **功能列表（Feature List）**：
  - 从规范构建的 JSON 文件
  - 使用 JSON 而非 Markdown 的原因：代理更不容易修改 JSON 文件
  - 采用规范驱动开发（Specification-driven Development）
- **标准文件（standards.md）**：
  - 确保每个会话使用相同的开发标准
  - 对代理只读
- **进度文件（claude_progress.md）**：
  - 记录上一个会话的工作进度
  - 与 Git 提交结合使用
  - 类似开发者通过提交历史了解代码库
- **初始化文件（init file）**：
  - 包含确定性的启动步骤
  - 启动开发服务器
  - 以可重复和确定性的方式启动环境

### 永不停止的循环（21:00-24:30）
- **代理的定义**：LLM + 环境 + 工具 + 持续运行的循环
- **每次迭代的步骤**：
  1. 查看环境和之前发生的事情
  2. 运行测试套件确保之前的工作仍然可重复
  3. 选择下一个可用功能开始工作
  4. 在实现功能时持续运行测试
  5. 像人类一样测试并提交工作
  6. 将进度写入历史记录
- **下一个会话**：查看历史记录并继续工作

### 从一次性到增量进步的突破（24:30-28:00）
- **早期方法（约一个月前）**：
  - 代理尝试一次实现所有功能
  - 问题：功能实现到一半时上下文耗尽
  - 模型有时过早宣布胜利
  - 模型会自己设定成功标准并进行奖励黑客（reward hacking）
  - 必须明确告诉它不能删除或编辑测试来使其通过
- **改进后的方法**：
  - 一次只处理一个功能（解决上下文窗口问题）
  - 每次都将环境保持在干净状态
  - 使用提交作为记忆，但保持环境本身干净
  - 像人类一样进行端到端测试
  - 使用浏览器自动化检查 UI，确保功能实际工作而非仅在理论上工作

### 模仿开发者工作流（28:00-31:00）
- **研究发现**：越接近开发者的实际工作流程，代理表现越好
- **规范和测试的重要性**：
  - 让代理在构建过程中编写测试
  - 发现：如果要求代理编写单独的测试，当接近完成时会出现"焦虑发作"
  - 代理会在日志中说"我们时间不够了，必须快点完成"，然后开始奖励黑客
- **200 功能宣言**：
  - 前期需要投入工作构建详细的规范
  - 规范要有足够的细节让代理能够很好地工作和编写测试
  - 虽然前期工作量大，但长期回报丰厚
- **从规范到 JSON**：
  - 人类编写 Markdown 格式的规范
  - 转换为 JSON 格式供代理使用
  - 代理在工作过程中标记测试为通过状态

### 开发者时间分配的变化（31:00-33:30）
- **之前的模式**：
  - 自己编写代码
  - 手动调试
  - 事后编写文档（如果有的话）
  - 在任务之间频繁切换上下文
- **新模式**：
  - 花更多时间定义 LLM 要遵循的需求
  - 审查 AI 的测试结果而非完全手动调试
  - 确保结果正确并符合预期
  - 文档在 LLM/AI 工作时自动生成
  - 代理维护自己的进度笔记
- **速度问题**：
  - 对于规范明确的项目通常更快
  - 取决于规范质量、领域和对审查周期的容忍度

### 优势与局限性（33:30-36:30）
- **改进之处**：
  - 默认为每个功能编写测试（测试覆盖率高）
  - 每个会话都更新文档（始终保持最新和准确）
  - 与编码风格保持一致（几乎宗教般地遵循标准）
- **局限性**：
  - **视觉差距**：模型可能无法发现每个视觉 bug，需要人类判断
  - **浏览器自动化限制**：Puppeteer 或 Playwright 等工具通常无法看到原生警告
  - **不能取代人类审查**：这不是"一劳永逸"的模式，需要在投入生产前进行验证

### 架构演示（36:30-42:00）
- **四大组件**：
  1. **GitHub Issues**：作为代理工作的待办事项列表
  2. **GitHub Actions**：CI/CD 流程
  3. **Agent Core Runtime**：基础设施配置和编排
  4. **Anthropic API（Claude Opus 4.5）**：使用 Claude Agent SDK
- **工作流程**：
  - Issue Puller 定期检查 GitHub Issues
  - 使用 React 表情符号（thumbs up）进行投票
  - 团队成员批准后代理开始工作
  - 使用 Claude Opus 4.5（具有更好的视觉能力）
  - 新版本部署到 S3 存储桶，通过 CloudFront 分发
- **架构决策**：
  - 最初考虑使用 ECS 和 EFS 卷来维护状态
  - Agent Core Runtime 不支持 EFS 卷挂载
  - 改用 Git 仓库作为真实来源（source of truth）

### 实时演示（42:00-52:00）
- **功能请求展示**：
  - 展示了在 re:Invent 期间收到的大量功能请求
  - 标签系统：批准后变为"agent building"，完成后变为"agent complete"
- **日语翻译功能示例**（Issue #36）：
  - 从 Issue #14（MVP）到 Issue #36，展示了构建的功能数量
  - 完整的审计日志记录代理的所有操作
  - 显示会话 ID、工作流启动信息
  - 大量截图（约 150 张）记录工作过程
  - 使用 Playwright MCP 进行浏览器自动化
  - 内置上下文压缩和管理功能
  - 最终成功实现日语翻译功能
- **项目规范文件展示**：
  - 使用 XML 标签结构（模型比纯 Markdown 更容易理解）
  - 定义应用整体理念（Canopy - Jira 克隆）
  - 技术栈定义（前端、数据层）
  - 核心数据实体
  - 测试场景说明
- **CloudWatch 日志分析**：
  - 展示代理的推理过程
  - "让我理解测试结构"
  - "让我读取 test.json 查看最新测试"
  - "让我理解当前应用结构和文件"
  - 根据截图做出判断和更新决策
  - 提供开发过程的完整洞察

### 总结要点
- **核心价值**：建立人机协作的新模式，而非替代开发者
- **关键成功因素**：详细的规范、清晰的标准、结构化的环境管理
- **实际应用**：适合规范明确、重复性高的开发任务
- **持续改进**：通过实践不断优化代理工作流程和人机交互模式