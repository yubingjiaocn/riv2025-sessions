# AWS re:Invent 2025 - CMP356 会话总结

## 会话概述

本次会话由AWS解决方案架构师Chad Schmutzer主讲,主题为"你对EC2了解多少?"(How well do you know EC2?)。这是一场20分钟的闪电演讲,重点探讨了客户在使用Amazon EC2时存在的"优化差距"问题。

Chad指出,虽然AWS EC2平台提供了超过1000种实例类型、6大类别、多种处理器架构以及50-90%的折扣购买选项,但大多数客户实际上只反复使用5-10种实例类型,坚持使用默认配置,并且不会定期重新评估优化机会。这导致他们错失了大量的成本和性能优化机会。

本次会话旨在帮助客户理解EC2的广度和优化机会,学习工作负载与实例匹配的方法论,以及实施购买模型优化策略。通过采用现代化实例类型、合理调整规模、使用灵活的实例选择策略以及结合多种购买选项,客户可以实现20-30%甚至更高的性价比提升。

## 详细时间线与关键要点

### 开场介绍 (0:00-2:00)
- **会话信息**: CMP356 - "你对EC2了解多少?"
- **演讲者**: Chad Schmutzer,AWS解决方案架构师,专注于帮助客户在计算平台(主要是EC2)上大规模运行
- **会话时长**: 20分钟闪电演讲格式

### 优化差距问题 (2:00-4:30)
- **EC2平台广度**:
  - 超过1000种通用可用的EC2实例类型
  - 6大实例类别
  - 多种处理器架构,具有可衡量的不同性价比特征
  - 提供50-90%折扣的购买选项
- **客户实际使用情况**:
  - 通常只关注5-10种实例类型
  - 坚持使用默认配置
  - 不定期重新评估优化机会
  - 导致错失大量成本和性能优化机会

### 会话目标 (4:30-5:00)
- 理解EC2的广度和优化机会
- 学习工作负载与实例匹配的方法论
- 实施购买模型组织策略

### EC2实例命名规则 (5:00-6:00)
- **实例族**: 如C、M、R等
- **代数**: 实例类型的世代版本
- **属性**: 如G代表Graviton处理器,N代表高级网络能力
- **规格**: 如xlarge,表示特定的vCPU和内存配置

### 评估当前环境 (6:00-7:00)
- 建议运行CLI命令检查环境中的实例类型多样性
- 使用describe-instances命令获取唯一实例类型集合
- 以此为基准,然后将工作负载需求与后续幻灯片进行比较

### EC2实例类别 (7:00-8:30)
- **通用型**: M和T系列
- **计算优化型**: C系列
- **内存优化型**: R系列
- **存储优化型**: I、D和H系列
- **加速计算型**: P、G系列,以及Trainium和Inferentia系列
- **高性能计算(HPC)**: 专门的HPC系列

### 工作负载分类与监控 (8:30-10:00)
- 使用CloudWatch等工具对工作负载进行分类
- 跟踪利用率指标:
  - CPU和内存使用率
  - 磁盘IOPS计数
  - 网络吞吐量
  - **重要**: 跟踪自定义工作负载指标
- 基于监控数据做出决策:
  - CPU波动大 → 考虑可突增实例类型(T系列)或Flex实例
  - 持续高CPU → 考虑C系列
  - 内存压力 → 考虑R系列
  - 高IOPS → 考虑I系列
  - ML/AI工作负载 → 考虑P、G和Trainium系列

### AWS Nitro系统 (10:00-12:00)
- **Nitro平台重要性**: AWS最重要的基础设施创新
- **建议**: 从第五代之前的实例(M4、C4、R4等)迁移到Nitro支持的实例(第五代及以上)
- **架构优势**:
  - Nitro卡为VPC、EBS、实例存储操作提供专用硬件
  - Nitro安全芯片提供硬件信任根和固件保护
  - Nitro虚拟机管理程序实现接近裸机的性能
- **客户收益**:
  - **性能**: 减少虚拟化开销
  - **安全**: 基于硬件的隔离和加密内存
  - **创新**: 加速实例类型开发和部署
  - **效率**: 通过架构优化提升性价比

### 识别非Nitro实例 (12:00-13:00)
- 提供CLI命令识别环境中的旧代实例
- 建议将这些实例发送到AWS Systems Manager进行自动化清单管理
- 使用SSM跟踪现代化进度

### 实例现代化路径 (13:00-14:00)
- **通用型**: M4 → M7/M8系列(多种架构)
- **计算优化型**: C4 → C7i、C8G、C8A
- **内存优化型**: R4 → R7i、R7、R8G
- **可突增型**: 旧版本 → T3或T4G(Graviton支持)
- **预期收益**: 通过实例类型现代化、合理调整规模和使用Flex实例,可实现20-30%的性价比提升

### 处理器架构选择 (14:00-15:00)
- **Intel Xeon**可扩展处理器
- **AMD EPYC**处理器
- **AWS Graviton**处理器
- **Apple Silicon**
- 建议尽可能多地测试和使用不同架构以获得最佳性价比

### 代际改进 (15:00-15:30)
- 每一代都比前一代有所改进
- 例如:第七代(M7i、C7i、R7i)实现高达15%的性价比提升
- 强调关注"性价比"而非仅关注最低价格
- 现代实例可能允许使用更小规格或更少数量来满足相同工作负载

### AWS Compute Optimizer (15:30-17:30)
- **服务特点**:
  - 免费服务
  - 为所有支持的资源提供建议
  - 提供持续监控
- **启用方法**: 一次性设置,运行命令aws compute-optimizer update-enrollment-status --status Active
- **工作原理**:
  - 自动收集过去14天的CloudWatch指标
  - 分析CPU、内存、网络和磁盘模式
  - 推荐最优实例类型(包括第七代和第八代)
  - 自动识别Graviton迁移机会
- **增强功能**: 安装CloudWatch代理发送内存指标以获得更精确的建议
- **输出**: 可导出CSV格式的优化建议报告

### 合理调整规模策略 (17:30-18:30)
- **三种优化方式**:
  1. 减少整体实例数量
  2. 减小实例规格
  3. 更改实例类型
- **目标利用率范围**: 40-70%为最佳
- **过度配置**: 空闲资源超过20%时考虑缩小规模
- **配置不足**: 余量少于30%时考虑扩大规模
- **收益**: 使用更少资源意味着更低成本和更小碳足迹

### EC2 Auto Scaling (18:30-20:00)
- 使用动态扩展根据实时需求自动调整容量
- 可跨多种实例类型扩展
- 考虑在Auto Scaling组中使用Spot实例
- **混合实例组**: 针对价格和容量进行优化
- **基于属性的实例选择(ABIS)**:
  - 指定工作负载需求(内存、vCPU等)
  - 让Auto Scaling自动选择匹配的实例类型
  - 减少对特定实例类型的依赖

### 跨代启动和动态扩展 (20:00-21:00)
- 建议跨多个代际启动实例以增加灵活性
- 启用目标跟踪和预测性扩展
- 同时优化成本和性能

### 购买选项 (21:00-23:00)
- **按需实例**: 标准定价
- **按需容量预留**: 确保容量可用性
- **容量块**: 特定时间段的容量预留
- **EC2 Spot实例**:
  - 利用未使用容量
  - 最高可节省90%成本
  - 适用于可中断工作负载
  - 适合场景:异步可中断工作负载、加速扩展操作、时间可转移工作负载
  - 支持中断通知和状态管理

### Savings Plans (23:00-24:30)
- 重要的成本优化机会,常被忽视
- 可与容量预留结合使用,同时确保容量和节省成本
- **类型**:
  - **Compute Savings Plan**: 适合使用多种实例类型的灵活场景
  - **Instance Savings Plan**: 适合锁定特定实例类型的场景,提供最佳定价
- **期限选项**: 1年期和3年期

### 分层策略 (24:30-25:30)
- **底层(稳态工作负载)**: 容量预留 + Savings Plans
- **中层(峰值工作负载)**: 按需实例
- **顶层(灵活容错工作负载)**: Spot实例
- 能够利用所有三个层级的客户将实现最高效的EC2大规模利用

### 总结 (25:30-27:00)
- **缩小优化差距的关键步骤**:
  1. 理解EC2的广度和优化机会
  2. 利用Compute Optimizer、Auto Scaling、Systems Manager和CloudWatch进行工作负载与实例匹配
  3. 实施正确的购买模型优化策略
- 合理使用Savings Plans、容量预留,最小化按需使用,并为灵活工作负载利用Spot实例

### 结束语 (27:00-结束)
- 鼓励在移动应用中提供反馈
- 提供LinkedIn联系方式,欢迎会后继续交流
- 演讲者愿意在re:Invent之外继续提供支持和信息